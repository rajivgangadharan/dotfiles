"use strict";(globalThis.webpackChunkmomentum=globalThis.webpackChunkmomentum||[]).push([[6781,4145],{84722:(e,t,s)=>{s.d(t,{V:()=>i});const i=(0,s(95756).vM)("notes",{views:{list:{defaultView:!0,order:1},deleted:{order:2}}})},34145:(e,t,s)=>{s.d(t,{U:()=>o});var i=s(42935),a=s(24960),r=s(67652),n=s(35597);class o{constructor(e,{queryParams:t={},getResponseProperty:s,path:i="",mode:n=r.Z.Sync}={}){this.type=e,this.queryParams=t,this.getResponseProperty=s,this.path=i,this.mode=n,this.dataSync=a.Z}get({id:e,path:t=this.path||this.type,mode:s=this.mode,success:i,failure:a,queryParams:o={},retry:h,responseProperty:d=this.getResponseProperty,appendIdToPath:p,timestampKey:c=this.type}){(async()=>{var u;s===r.Z.Timestamp&&(s=await n.Z.requiresSync(c)?r.Z.Sync:r.Z.Cache,n.Z.addUpdateListener(c,this.refresh.bind(this,{id:e,path:t,queryParams:o,retry:h,responseProperty:d,appendIdToPath:p,timestampKey:c}))),t+=this.buildQueryString((null===(u=this.queryParams)||void 0===u?void 0:u.get)||{},o);const l=[this.type,{id:e,path:t,env:this.getEnv(),mode:s,retry:h,responseProperty:d,appendIdToPath:p,timestampKey:c}];s===r.Z.Server?this.dataSync.sendMessage({handler:"get",args:l}).then(i).catch(a):this.dataSync.sendRecurringCrossTabMessage({msgId:`${this.type}${e?`:${e}`:""}:refreshed`,handler:"get",args:l,success:i,failure:a})})()}refresh({id:e,path:t=this.path||this.type,queryParams:s={},retry:i,responseProperty:a=this.getResponseProperty,appendIdToPath:n,timestampKey:o=this.type}={}){return new Promise(((h,d)=>this.get({id:e,mode:r.Z.Server,path:t,queryParams:s,retry:i,success:h,failure:d,responseProperty:a,appendIdToPath:n,timestampKey:o})))}async create(e,t,{path:s=this.path||this.type,mode:i=this.mode}={}){const a=[this.type,e,t];a.push({path:s,mode:i,env:this.getEnv()}),await this.dataSync.sendMessage({handler:"create",args:a})}async update(e,t,{path:s=this.path||this.type,mode:i=this.mode,queryParams:a={},appendIdToPath:r}={}){var n;const o=this.buildQueryString((null===(n=this.queryParams)||void 0===n?void 0:n.update)||{},a),h=[this.type,e,t];h.push({path:s,mode:i,env:this.getEnv(),queryString:o,appendIdToPath:r}),await this.dataSync.sendMessage({handler:"update",args:h})}async delete(e,{path:t=this.path||this.type,mode:s=this.mode}={}){const i=[this.type,e];i.push({path:t,mode:s,env:this.getEnv()}),await this.dataSync.sendMessage({handler:"delete",args:i})}getEnv(){return{token:localStorage.getItem("token"),clientUuid:localStorage.getItem("client_uuid"),apiUrl:m.globals.urlRootApi,version:m.globals.version,tabId:i.Z}}buildQueryString(...e){const t=e.reduce(((e,t)=>({...t,...e})),{}),s=new URLSearchParams(t).toString();return s?"?"+s:""}}},95756:(e,t,s)=>{s.d(t,{t7:()=>c,vM:()=>p});var i=s(63420),a=s(20144),r=s(96046),n=s(63139),o=s(7838),h=s(70237);const d=e=>Object.keys(e).find((t=>{var s;return null===(s=e[t])||void 0===s?void 0:s.defaultView})),p=(e,{views:t}={})=>{const s=(0,i.Q_)(e+"ViewState",{state:()=>{var s;return{activeViewId:null!==(s=t&&d(t))&&void 0!==s?s:"",beforeViewChange:()=>Promise.resolve(!0),confirmationProps:null,popupActive:!1,name:e}},getters:{activeView(e){if(!t)return null;const s=t[e.activeViewId];if(s)return s;throw new Error("No view found with id: "+e.activeViewId)},focused:()=>n.Z.isOnTop(e)},actions:{focus(){n.Z.add(e)},async setActiveView(e){var s,i;if(!t||!await this.beforeViewChange())return;let a=e;if("default"===e){const e=d(t);if(!e)throw new Error("No view found with defaultView: true");a=e}await(null===(i=null===(s=this.activeView)||void 0===s?void 0:s.beforeLeave)||void 0===i?void 0:i.call(s,a)),this.activeViewId=a},async togglePopup(e,{resetActiveView:t=!0}={}){await this.beforeViewChange()&&(await a.ZP.nextTick(),this.popupActive=null!=e?e:!this.popupActive,!this.popupActive&&t&&(this.resetBeforeViewChange(),this.confirmationProps=null,await this.setActiveView("default")))},resetBeforeViewChange(){this.beforeViewChange=()=>Promise.resolve(!0)},async setConfirmation(e){return new Promise((t=>{this.confirmationProps=e,this.confirmationProps.confirm=()=>t(!0),this.confirmationProps.cancel=()=>t(!1)})).finally((()=>{this.confirmationProps=null}))}}}),h=(0,i.Jk)(s());return o.Z.$on(e+":close",(()=>s().togglePopup(!1))),(0,a.YP)(h.popupActive,(t=>{t?n.Z.add(e):n.Z.remove(e)})),(0,a.YP)(h.confirmationProps,(t=>{(null==t?void 0:t.dashboardOverlay)&&n.Z.add(e,!0),r.Z.dashboardOverlayActive=!!(null==t?void 0:t.dashboardOverlay)})),s},c=(e,{views:t,extend:s})=>{const i=p(`base${h.Z.capitalizeFirstLetter(e)}`,{views:t}),a=s(i(),`extended${h.Z.capitalizeFirstLetter(e)}ViewState`);return u(`${e}ViewState`,i,a)},u=(e,t,s)=>{const r=t(),n=s();return(0,i.Q_)(e,(()=>({...(0,a.BK)(r),...(0,a.BK)(n)})))}},67652:(e,t,s)=>{var i;s.d(t,{Z:()=>a}),function(e){e.Sync="sync",e.Cache="cache",e.Server="server",e.Timestamp="timestamp"}(i||(i={}));const a=i}}]);