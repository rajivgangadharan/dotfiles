"use strict";(globalThis.webpackChunkmomentum=globalThis.webpackChunkmomentum||[]).push([[6783,4145],{66783:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p,makePomodoroCompletedStore:()=>n,usePomodoroCompletedStore:()=>h});var s=a(63420);class r{constructor(e){this.dataService=e}get(e){this.dataService.get(e)}create(e){return this.dataService.create(e.id,e)}}var o=a(34145),i=a(67652),d=a(70237);const n=(e=(()=>({pomodoroCompletedService:new r(new o.U("pomodoro",{path:"pomodoro/completed",mode:i.Z.Timestamp,getResponseProperty:"completed",queryParams:{get:{cutoffDays:"7"}}}))}))().pomodoroCompletedService)=>(0,s.Q_)("pomodoroCompleted",{state:()=>({data:[],loading:!1,loaded:!1}),getters:{completedStats(e){const t=d.Z.getDateString(m.models.date.get("date")),a=[t],[s,r,o]=t.split("-").map(Number),i=new Date(s,r-1,o);for(;0!==i.getDay();)i.setTime(i.getTime()-864e5),a.push(d.Z.getDateOnly(i));const n=e=>e.reduce(((e,t)=>e+t.aggregatedEntries),0),h=e=>e.reduce(((e,t)=>e+t.focusMinutes),0),p=(e,t)=>e&&e.completed&&t.includes(d.Z.getDateString(e.completed)),c=e.data.filter((e=>p(e,[t]))),u=e.data.filter((e=>p(e,a)));return{counts:{today:n(c),week:n(u),allTime:n(e.data)},focusedMinutes:{today:h(c),week:h(u),allTime:h(e.data)}}}},actions:{refresh(){this.loaded||this.loading||(this.loading=!0,e.get({success:e=>{this.data=e||[],this.loaded=!0,this.loading=!1}}))},async create(t){this.data.push(t),t.id=d.Z.uuidv4(),await e.create(t)}}}),h=n(),p=h},34145:(e,t,a)=>{a.d(t,{U:()=>d});var s=a(42935),r=a(24960),o=a(67652),i=a(35597);class d{constructor(e,{queryParams:t={},getResponseProperty:a,path:s="",mode:i=o.Z.Sync}={}){this.type=e,this.queryParams=t,this.getResponseProperty=a,this.path=s,this.mode=i,this.dataSync=r.Z}get({id:e,path:t=this.path||this.type,mode:a=this.mode,success:s,failure:r,queryParams:d={},retry:n,responseProperty:h=this.getResponseProperty,appendIdToPath:p,timestampKey:m=this.type}){(async()=>{var c;a===o.Z.Timestamp&&(a=await i.Z.requiresSync(m)?o.Z.Sync:o.Z.Cache,i.Z.addUpdateListener(m,this.refresh.bind(this,{id:e,path:t,queryParams:d,retry:n,responseProperty:h,appendIdToPath:p,timestampKey:m}))),t+=this.buildQueryString((null===(c=this.queryParams)||void 0===c?void 0:c.get)||{},d);const u=[this.type,{id:e,path:t,env:this.getEnv(),mode:a,retry:n,responseProperty:h,appendIdToPath:p,timestampKey:m}];a===o.Z.Server?this.dataSync.sendMessage({handler:"get",args:u}).then(s).catch(r):this.dataSync.sendRecurringCrossTabMessage({msgId:`${this.type}${e?`:${e}`:""}:refreshed`,handler:"get",args:u,success:s,failure:r})})()}refresh({id:e,path:t=this.path||this.type,queryParams:a={},retry:s,responseProperty:r=this.getResponseProperty,appendIdToPath:i,timestampKey:d=this.type}={}){return new Promise(((n,h)=>this.get({id:e,mode:o.Z.Server,path:t,queryParams:a,retry:s,success:n,failure:h,responseProperty:r,appendIdToPath:i,timestampKey:d})))}async create(e,t,{path:a=this.path||this.type,mode:s=this.mode}={}){const r=[this.type,e,t];r.push({path:a,mode:s,env:this.getEnv()}),await this.dataSync.sendMessage({handler:"create",args:r})}async update(e,t,{path:a=this.path||this.type,mode:s=this.mode,queryParams:r={},appendIdToPath:o}={}){var i;const d=this.buildQueryString((null===(i=this.queryParams)||void 0===i?void 0:i.update)||{},r),n=[this.type,e,t];n.push({path:a,mode:s,env:this.getEnv(),queryString:d,appendIdToPath:o}),await this.dataSync.sendMessage({handler:"update",args:n})}async delete(e,{path:t=this.path||this.type,mode:a=this.mode}={}){const s=[this.type,e];s.push({path:t,mode:a,env:this.getEnv()}),await this.dataSync.sendMessage({handler:"delete",args:s})}getEnv(){return{token:localStorage.getItem("token"),clientUuid:localStorage.getItem("client_uuid"),apiUrl:m.globals.urlRootApi,version:m.globals.version,tabId:s.Z}}buildQueryString(...e){const t=e.reduce(((e,t)=>({...t,...e})),{}),a=new URLSearchParams(t).toString();return a?"?"+a:""}}},67652:(e,t,a)=>{var s;a.d(t,{Z:()=>r}),function(e){e.Sync="sync",e.Cache="cache",e.Server="server",e.Timestamp="timestamp"}(s||(s={}));const r=s}}]);