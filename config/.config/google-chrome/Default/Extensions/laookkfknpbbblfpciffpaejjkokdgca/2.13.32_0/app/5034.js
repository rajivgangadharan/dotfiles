(globalThis.webpackChunkmomentum=globalThis.webpackChunkmomentum||[]).push([[5034,6783,4145],{63568:(t,e,o)=>{"use strict";o.d(e,{Z:()=>i});const i={clock:{name:"Clock",feature:"default clock",icon:o(45671)},pomodoro:{name:"Pomodoro",icon:o(95648),upsell:"UPSELL_POMODORO"}}},37385:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>n});var i=o(8081),s=o.n(i),a=o(23645),r=o.n(a)()(s());r.push([t.id,"\n/* stylelint-disable */\n.has-pomodoro .center-above { display: block;\n}\n/* stylelint-enable */\n",""]);const n=r},23207:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>l});var i=o(8081),s=o.n(i),a=o(23645),r=o.n(a),n=o(61667),d=o.n(n),m=new URL(o(55179),o.b),c=r()(s()),u=d()(m);c.push([t.id,`\n/* stylelint-disable */\n.pomodoro[data-v-724ca76b] { display: flex; flex-direction: column; align-items: center; --font-size-greeting: 3rem;\n}\n.above[data-v-724ca76b], .below[data-v-724ca76b] { text-align: center;\n}\n.above[data-v-724ca76b] { margin-bottom: 0.6rem; display: flex; flex-direction: column; align-items: center;\n}\n.modes[data-v-724ca76b] { display: flex; font-size: 1rem; font-weight: 700; text-align: center; text-transform: uppercase;\n}\n.mode[data-v-724ca76b] { padding: 5px 12px; display: inline-block; opacity: var(--opacity-stop-3); cursor: pointer;\n}\n.mode[data-v-724ca76b]:hover, .mode.active[data-v-724ca76b] { opacity: 1;\n}\n.mode-focus[data-v-724ca76b] { margin-right: 4px;\n}\n.time[data-v-724ca76b] { font-size: 8.5rem; text-shadow: 0 0 20px rgba(0 0 0 / var(--opacity-stop-3));\n}\n.three-col-layout--center[data-v-724ca76b] {\n}\n.greeting-wrapper[data-v-724ca76b] { position: relative;\n}\n.greeting-inner-wrapper[data-v-724ca76b] { font-size: var(--font-size-greeting); font-weight: 500; text-align: center;\n}\n\n\t\t/* Focus Overrides */\n.center-focus[data-v-724ca76b] { display: block; font-size: 100% !important;\n}\n.center-focus[data-v-724ca76b] .focus-content { position: relative;\n}\n.center-focus[data-v-724ca76b] .checkbox { margin: 6px 1rem 0;\n}\n.center-focus[data-v-724ca76b] .prompt { padding-bottom: 0;\n}\n.center-focus[data-v-724ca76b] .focus-input, .prompt .hidden-data[data-v-724ca76b] { padding: 0; border: none; border-bottom: none; font-size: var(--font-size-greeting) !important; line-height: normal;\n}\n\n\t\t\t/* ••• hover effects -> Prevent focus ••• from showing when general center pomodoro is hovered  */\n.center-focus[data-v-724ca76b] .dash-icon { opacity: 0;\n}\n.center-focus[data-v-724ca76b]:hover .dash-icon { opacity: 0.8;\n}\n.right[data-v-724ca76b] {\n}\n.below[data-v-724ca76b] { margin-top: 35px; display: flex; align-items: center; gap: 12px;\n}\n.button[data-v-724ca76b] { --v-padding: 9px; --background-color: rgba(0,0,0,0.25); padding: var(--v-padding) 32px; display: flex; background: var(--background-color); border: 2px solid #fff; border-radius: 50px; box-shadow: 0 0 12px var(--background-color); color: #fff; cursor: pointer; font-size: 0.9375rem; font-weight: 600; outline: none; text-transform: uppercase;\n}\n.button[data-v-724ca76b]:hover { background: rgba(0,0,0,0.175);\n}\n.button[data-v-724ca76b]:hover:active { background: rgba(0,0,0,0.1); transition-duration: 0s;\n}\n.button.disabled[data-v-724ca76b] { transition: opacity 500ms var(--a-curve); visibility: hidden;\n}\n.circle[data-v-724ca76b] { --size: 650px; position: absolute; top: 0; left: 0; bottom: 0; right: 0; z-index: -1; display: flex; align-items: center; justify-content: center;\n}\n.circle-inner[data-v-724ca76b] { height: var(--size); width: var(--size); max-height: min(90vh, 95vw); max-width: min(90vh, 95vw); position: relative; flex-shrink: 0; transform: translateY(-10px) rotate(-45deg);\n}\n.circle-background[data-v-724ca76b] { -webkit-backdrop-filter: blur(5px); backdrop-filter: blur(5px); transition: opacity 1s ease; -webkit-mask-image: url(${u}); mask-image: url(${u});\n}\n.circle-foreground[data-v-724ca76b] { background: rgba(255 255 255 / var(--opacity-stop-2)); -webkit-mask-image: url(${u}); mask-image: url(${u});\n}\n.circle-svg[data-v-724ca76b], .circle-background[data-v-724ca76b], .circle-foreground[data-v-724ca76b] { position: absolute; inset: 0;\n}\n.circle-svg[data-v-724ca76b] path { opacity: var(--opacity-stop-4); transition: 0.2s ease; stroke-dashoffset: var(--eca39bfe); stroke: white !important;\n}\n@media screen and (max-width: 450px) {\n.circle[data-v-724ca76b] { --size: 400px;\n}\n.modes[data-v-724ca76b] { font-size: 1rem;\n}\n.mode[data-v-724ca76b] {\n}\n.time[data-v-724ca76b] { font-size: 5rem; font-weight: 500; letter-spacing: -1px;\n}\n.pomodoro .greeting-inner-wrapper[data-v-724ca76b] { --font-size-greeting: clamp(10px, 8vw, 32px); margin-top: 2px;\n}\n.center-focus[data-v-724ca76b] .focus-input, .prompt .hidden-data[data-v-724ca76b] { margin: 0;\n}\n.below[data-v-724ca76b] { margin-top: 24px;\n}\n.below button[data-v-724ca76b] { padding: 5px 24px; font-size: 0.875rem;\n}\n\n\t/* Dropdown */\n[data-v-724ca76b] .stats { padding-right: var(--toast-padding) !important; padding-left: var(--toast-padding) !important; background: none !important;\n}\n}\n.fade-leave-to[data-v-724ca76b], .fade-enter[data-v-724ca76b] {\n\topacity: 0 !important;\n}\n\n/* Instead of worrying about fade-deep, just fade the blur on it's own after pomodoro appears */\n.fade-enter-active .circle-background[data-v-724ca76b], .fade-leave-active .circle-background[data-v-724ca76b] { opacity: 0!important;\n}\n`,""]);const l=c},61667:t=>{"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},66783:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>u,makePomodoroCompletedStore:()=>d,usePomodoroCompletedStore:()=>c});var i=o(63420);class s{constructor(t){this.dataService=t}get(t){this.dataService.get(t)}create(t){return this.dataService.create(t.id,t)}}var a=o(34145),r=o(67652),n=o(70237);const d=(t=(()=>({pomodoroCompletedService:new s(new a.U("pomodoro",{path:"pomodoro/completed",mode:r.Z.Timestamp,getResponseProperty:"completed",queryParams:{get:{cutoffDays:"7"}}}))}))().pomodoroCompletedService)=>(0,i.Q_)("pomodoroCompleted",{state:()=>({data:[],loading:!1,loaded:!1}),getters:{completedStats(t){const e=n.Z.getDateString(m.models.date.get("date")),o=[e],[i,s,a]=e.split("-").map(Number),r=new Date(i,s-1,a);for(;0!==r.getDay();)r.setTime(r.getTime()-864e5),o.push(n.Z.getDateOnly(r));const d=t=>t.reduce(((t,e)=>t+e.aggregatedEntries),0),c=t=>t.reduce(((t,e)=>t+e.focusMinutes),0),u=(t,e)=>t&&t.completed&&e.includes(n.Z.getDateString(t.completed)),l=t.data.filter((t=>u(t,[e]))),h=t.data.filter((t=>u(t,o)));return{counts:{today:d(l),week:d(h),allTime:d(t.data)},focusedMinutes:{today:c(l),week:c(h),allTime:c(t.data)}}}},actions:{refresh(){this.loaded||this.loading||(this.loading=!0,t.get({success:t=>{this.data=t||[],this.loaded=!0,this.loading=!1}}))},async create(e){this.data.push(e),e.id=n.Z.uuidv4(),await t.create(e)}}}),c=d(),u=c},34145:(t,e,o)=>{"use strict";o.d(e,{U:()=>n});var i=o(42935),s=o(24960),a=o(67652),r=o(35597);class n{constructor(t,{queryParams:e={},getResponseProperty:o,path:i="",mode:r=a.Z.Sync}={}){this.type=t,this.queryParams=e,this.getResponseProperty=o,this.path=i,this.mode=r,this.dataSync=s.Z}get({id:t,path:e=this.path||this.type,mode:o=this.mode,success:i,failure:s,queryParams:n={},retry:d,responseProperty:m=this.getResponseProperty,appendIdToPath:c,timestampKey:u=this.type}){(async()=>{var l;o===a.Z.Timestamp&&(o=await r.Z.requiresSync(u)?a.Z.Sync:a.Z.Cache,r.Z.addUpdateListener(u,this.refresh.bind(this,{id:t,path:e,queryParams:n,retry:d,responseProperty:m,appendIdToPath:c,timestampKey:u}))),e+=this.buildQueryString((null===(l=this.queryParams)||void 0===l?void 0:l.get)||{},n);const h=[this.type,{id:t,path:e,env:this.getEnv(),mode:o,retry:d,responseProperty:m,appendIdToPath:c,timestampKey:u}];o===a.Z.Server?this.dataSync.sendMessage({handler:"get",args:h}).then(i).catch(s):this.dataSync.sendRecurringCrossTabMessage({msgId:`${this.type}${t?`:${t}`:""}:refreshed`,handler:"get",args:h,success:i,failure:s})})()}refresh({id:t,path:e=this.path||this.type,queryParams:o={},retry:i,responseProperty:s=this.getResponseProperty,appendIdToPath:r,timestampKey:n=this.type}={}){return new Promise(((d,m)=>this.get({id:t,mode:a.Z.Server,path:e,queryParams:o,retry:i,success:d,failure:m,responseProperty:s,appendIdToPath:r,timestampKey:n})))}async create(t,e,{path:o=this.path||this.type,mode:i=this.mode}={}){const s=[this.type,t,e];s.push({path:o,mode:i,env:this.getEnv()}),await this.dataSync.sendMessage({handler:"create",args:s})}async update(t,e,{path:o=this.path||this.type,mode:i=this.mode,queryParams:s={},appendIdToPath:a}={}){var r;const n=this.buildQueryString((null===(r=this.queryParams)||void 0===r?void 0:r.update)||{},s),d=[this.type,t,e];d.push({path:o,mode:i,env:this.getEnv(),queryString:n,appendIdToPath:a}),await this.dataSync.sendMessage({handler:"update",args:d})}async delete(t,{path:e=this.path||this.type,mode:o=this.mode}={}){const i=[this.type,t];i.push({path:e,mode:o,env:this.getEnv()}),await this.dataSync.sendMessage({handler:"delete",args:i})}getEnv(){return{token:localStorage.getItem("token"),clientUuid:localStorage.getItem("client_uuid"),apiUrl:m.globals.urlRootApi,version:m.globals.version,tabId:i.Z}}buildQueryString(...t){const e=t.reduce(((t,e)=>({...e,...t})),{}),o=new URLSearchParams(e).toString();return o?"?"+o:""}}},67652:(t,e,o)=>{"use strict";var i;o.d(e,{Z:()=>s}),function(t){t.Sync="sync",t.Cache="cache",t.Server="server",t.Timestamp="timestamp"}(i||(i={}));const s=i},55034:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>w});var i=function(){var t=this,e=t._self._c;return t.optionsOnly?e("pomodoro-dropdown",{attrs:{"always-open":!0,timers:t.timers,sounds:t.sounds,autoplay:t.autoplay,"hide-seconds":t.hideSeconds,"completed-stats":t.completedStats,options:t.centerOptions},on:{"update:sounds":function(e){t.sounds=e},"update:autoplay":function(e){t.autoplay=e},"update:hideSeconds":function(e){t.hideSeconds=e},"update:hide-seconds":function(e){t.hideSeconds=e},"update:timer":t.setTimerDuration,"complete-timer":t.completeTimer,"restart-timer":t.restartTimer,"add-ten-minutes":t.addTenMinutes,"switch-clock":t.switchClock}}):e("section",{staticClass:"clock pomodoro app-container has-dash-icon",class:{running:t.started,"show-anyway":t.showAnyway.includes("pomodoro")},attrs:{"data-show-anyway":"pomodoro","data-test":"pomodoro"}},[e("div",{staticClass:"circle"},[e("div",{staticClass:"circle-inner"},[e("div",{staticClass:"circle-background"}),t._v(" "),e("div",{staticClass:"circle-foreground"}),t._v(" "),e("inline-svg",{staticClass:"circle-svg",attrs:{src:o(55179)}})],1)]),t._v(" "),e("div",{staticClass:"above"},[e("nav",{staticClass:"modes"},[e("div",{staticClass:"mode mode-focus",class:{active:t.activeTimerId===t.TimerIds.Focus},attrs:{"data-test":"focus-btn"},on:{click:function(e){return t.clickTimer(t.TimerIds.Focus)}}},[t._v("Focus")]),t._v(" "),e("div",{staticClass:"mode mode-break",class:{active:t.activeTimerId===t.TimerIds.Break},attrs:{"data-test":"rest-btn"},on:{click:function(e){return t.clickTimer(t.TimerIds.Break)}}},[t._v("Break")])])]),t._v(" "),e("transition",{attrs:{name:"fade",mode:"out-in"}},[e("three-col-layout",{key:t.activeTimerId,staticClass:"time-wrapper",scopedSlots:t._u([t.quickNavVisible?{key:"left",fn:function(){return[t.$touch?t._e():e("quick-nav",{attrs:{options:t.centerOptions,region:"center",active:"pomodoro"},on:{"switch-to":t.switchClock}})]},proxy:!0}:null,{key:"center",fn:function(){return[e("pomodoro-time",{directives:[{name:"mobile-click",rawName:"v-mobile-click",value:t.showToastMenu,expression:"showToastMenu"}],attrs:{"hide-seconds":t.hideSeconds,hours:t.hours,minutes:t.minutes,seconds:t.seconds}})]},proxy:!0},{key:"right",fn:function(){return[e("pomodoro-dropdown",{attrs:{timers:t.timers,sounds:t.sounds,autoplay:t.autoplay,"hide-seconds":t.hideSeconds,"completed-stats":t.completedStats,options:t.centerOptions},on:{"update:sounds":function(e){t.sounds=e},"update:autoplay":function(e){t.autoplay=e},"update:hideSeconds":function(e){t.hideSeconds=e},"update:hide-seconds":function(e){t.hideSeconds=e},"update:timer":t.setTimerDuration,"complete-timer":t.completeTimer,"restart-timer":t.restartTimer,"add-ten-minutes":t.addTenMinutes,"switch-clock":t.switchClock}})]},proxy:!0}],null,!0)})],1),t._v(" "),e("div",{staticClass:"greeting-wrapper"},[e("transition",{attrs:{name:t.messageFade,mode:"out-in"}},[t.showFocusComponent?e("div",{staticClass:"greeting-inner-wrapper"},[e("focus",{staticClass:"center-focus",attrs:{"input-placeholder":"+ Add a focus","in-pomodoro":!0,"pomodoro-message":t.message}})],1):e("div",{key:t.message,staticClass:"greeting-inner-wrapper message",attrs:{"data-test":"message"}},[t._v(t._s(t.message))])])],1),t._v(" "),e("transition",{attrs:{name:"fade",mode:"out-in"}},[e("div",{key:t.activeTimerId,staticClass:"below"},[t.focusPlus10Visible?e("button",{staticClass:"button u--mobile-hide",attrs:{"data-test":"extend-focus-button"},on:{click:t.extendFocusAfterEnd}},[t._v("Focus +10 min")]):t._e(),t._v(" "),e("button",{staticClass:"button",class:{disabled:0===t.timeRemaining},attrs:{"data-test":"start-stop-button"},on:{click:t.toggleMasterPlayPause}},[t._v(t._s(t.started?"Pause":"Start"))])])])],1)};i._withStripped=!0;const s={focus:["Time to focus.","Focus time."],rest:["Time for a break.","Break time."]};var a=o(42223),r=o(30827),n=o(63568),d=o(3728),c=o(28610),u=o(81405),l=o(70237),h=o(66783);class p{constructor(t,e){this.lockName=t,this.isLeader=!1;const o=function(t,e){let o;const i=new Promise((t=>{o=t}));return navigator.locks.request(t,(()=>(e(),i))),()=>o()}(t,(()=>{this.isLeader=!0,null==e||e()}));this.stepDown=()=>{this.isLeader=!1,o()}}}var g=o(20144);const v=new u.ZP({feature:"pomodoro",is_paid_event:!0}),f={Focus:"focus",Break:"rest"},b={name:"Pomodoro",components:{ThreeColLayout:d.Z,QuickNav:()=>o.e(1025).then(o.bind(o,1025)),PomodoroTime:()=>o.e(3268).then(o.bind(o,93268)),PomodoroDropdown:()=>Promise.all([o.e(6283),o.e(1013),o.e(5940),o.e(3375),o.e(1794),o.e(4820),o.e(5217)]).then(o.bind(o,44961)),Focus:()=>Promise.all([o.e(618),o.e(553)]).then(o.bind(o,30618))},mixins:[a.Z],props:{optionsOnly:{type:Boolean,default:!1},quickNavVisible:{type:Boolean,default:!0}},setup:()=>({pomodoroCompletedStore:(0,h.default)(),showAnyway:r.Z,centerOptions:n.Z,tabElection:null,TimerIds:f}),data:()=>({timers:{focus:{name:"Focus",minutes:25},rest:{name:"Break",minutes:5}},activeTimerId:f.Focus,started:!1,timeRemaining:0,expectedTimerEnd:0,timer:null,sounds:!0,autoplay:!1,hideSeconds:!1}),computed:{activeTimer(){return this.timers[this.activeTimerId]},startMessage(){return m.utils.getRandomItem(s[this.activeTimerId])},dashProgress(){const t=60*this.activeTimer.minutes;return Math.min(this.timeRemaining,t)/t*212+"%"},message(){return this.started||0!==this.timeRemaining?this.started?this.activeTimer.name:this.startMessage:"Done!"},showFocusComponent(){return this.activeTimerId===f.Focus&&0!==this.timeRemaining},messageFade(){return this.started?"fade-fast":"fade"},completedStats(){return this.pomodoroCompletedStore.completedStats},hours(){return this.hideSeconds?Math.trunc(this.timeRemaining/3600).toString():m.utils.twoDigit(Math.trunc(this.timeRemaining/3600))},minutes(){return this.hideSeconds?Math.trunc(this.timeRemaining/60%60).toString():m.utils.twoDigit(Math.trunc(this.timeRemaining/60%60))},seconds(){return m.utils.twoDigit(this.timeRemaining%60)},timeString(){return this.hideSeconds?this.hours>0?`${this.hours}h ${this.minutes}m`:`${this.minutes}m`:this.hours>0?`${this.hours}:${this.minutes}:${this.seconds}`:`${this.minutes}:${this.seconds}`},documentTitle(){var t;const e=null===(t=c.default.activeFocus)||void 0===t?void 0:t.focus;return`${this.timeString} · ${e&&!e.completed&&this.activeTimerId===f.Focus?e:this.activeTimer.name}`},isSafari:m.utils.isSafari,focusPlus10Visible(){return this.activeTimerId===f.Break&&!this.started&&0!==this.timeRemaining&&this.$plus}},watch:{sounds(){this.saveSettingsToCustomization("sounds",this.sounds)},autoplay(){this.saveSettingsToCustomization("autoplay",this.autoplay)},hideSeconds(){this.saveSettingsToCustomization("hideSeconds",this.hideSeconds)},documentTitle(t){document.title=t}},mounted(){this.optionsOnly||(this.autoStartFocusTimer&&(this.sounds&&!this.optionsOnly&&window.pomodoroSounds.start.play(),this.start()),this.$body=$("body"),this.$body.addClass("has-pomodoro"))},created(){m.models.customization.on("change:pomodoroSettingsStr",this.handleSettingsChange),this.settingsMigrationFromLocalToCustomization(),this.setSettingsFromCustomization(),this.optionsOnly||(this.tabElection=new p("pomodoro"),window.addEventListener("storage",this.handleStorageChangeForStartedPomodoro),m.on("newDay",this.resetToFocus),m.on("pomodoro:reset",this.resetToFocus),m.on("pomodoro:restart",this.restartTimer),m.on("pomodoro:complete",this.completeTimer),m.on("pomodoro:togglePlay",this.togglePlay),this.pomodoroCompletedStore.refresh(),window.pomodoroSounds={start:new Audio("sounds/pomo-start.mp3"),stop:new Audio("sounds/pomo-stop.mp3"),done:new Audio("sounds/pomo-done.mp3")},(()=>{if("true"===localStorage.getItem("pomodoro-running")||localStorage.getItem("pomodoro-showing")||localStorage.getItem("pomodoro-time-remaining")){if(this.started="true"===localStorage.getItem("pomodoro-running"),this.autoStartFocusTimer="true"===localStorage.getItem("pomodoro-focus-timer"),this.autoStartFocusTimer)return this.setTimer(f.Focus),void localStorage.removeItem("pomodoro-focus-timer");this.activeTimerId=localStorage.getItem("pomodoro-started")||this.activeTimerId,localStorage.getItem("pomodoro-time-remaining")?this.timeRemaining=Number(localStorage.getItem("pomodoro-time-remaining")):localStorage.getItem("pomodoro-started-expected-timer-end")&&(this.expectedTimerEnd=Number(localStorage.getItem("pomodoro-started-expected-timer-end")),isNaN(this.expectedTimerEnd)||(this.timeRemaining=Math.floor((this.expectedTimerEnd-Date.now())/1e3))),this.timeRemaining/60>Number(this.activeTimer.minutes)?(this.stop(),this.reset()):this.timeRemaining>0&&this.started?this.timeOutForCountdown():this.timeRemaining<0?(localStorage.setItem("pomodoro-running",!1),this.setTimer(this.activeTimerId===f.Focus?f.Break:f.Focus),this.clearStartedTimeout()):this.timeRemaining||this.setTimer(this.activeTimerId)}else this.setTimer(this.activeTimerId),this.removeAllPomodoroLocalStorageKeys()})(),m.trigger("pomodoro:created"))},destroyed(){m.models.customization.off("change:pomodoroSettingsStr",this.handleSettingsChange),this.optionsOnly||(this.tabElection.stepDown(),this.$body.removeClass("has-pomodoro"),m.off("newDay",this.resetToFocus),m.off("pomodoro:reset",this.resetToFocus),m.off("pomodoro:togglePlay",this.togglePlay),m.off("pomodoro:restart",this.restartTimer),m.off("pomodoro:complete",this.completeTimer),window.removeEventListener("storage",this.handleStorageChangeForStartedPomodoro),clearTimeout(this.timer),document.title="New Tab",this.stop(),localStorage.setItem("pomodoro-closed",!0),this.removeAllPomodoroLocalStorageKeys())},methods:{countdown(){this.calculateTimeRemaining(),this.timeRemaining<=0||this.timeOutForCountdown()},timeOutForCountdown(){const t=1e3-(new Date).getMilliseconds()+10;clearTimeout(this.timer),this.timer=setTimeout(this.countdown,t)},calculateTimeRemaining(){const t=Number(localStorage.getItem("pomodoro-started-expected-timer-end"));if(isNaN(t)||(this.expectedTimerEnd=t),this.timeRemaining>0&&(this.timeRemaining=Math.floor((this.expectedTimerEnd-Date.now())/1e3)),this.timeRemaining<=0)return this.isSafari?this.complete():this.completeDebounced()},togglePlay(){!0===this.started?(this.sounds&&!this.optionsOnly&&window.pomodoroSounds.stop.play(),this.stop()):(this.sounds&&!this.optionsOnly&&window.pomodoroSounds.start.play(),this.start())},toggleMasterPlayPause(){this.togglePlay()},completeDebounced(){clearTimeout(this.completeTimeout),this.completeTimeout=setTimeout(this.complete,100)},complete(){const t=()=>{this.clearStartedTimeout(),this.timeRemaining=0};if(this.tabElection.isLeader){if(this.activeTimerId===f.Focus&&(this.started||this.timeRemaining>0)){const t=60*Number(this.timers.focus.minutes),e=this.started?this.expectedTimerEnd-Date.now():1e3*this.timeRemaining,o=Math.max(Math.min(e/1e3,t),0),i={focusMinutes:Math.round((t-o)/60),dateCreated:(new Date).toISOString(),completed:(new Date).toISOString(),aggregatedEntries:1};this.pomodoroCompletedStore.create(i)}t(),this.sounds&&!this.optionsOnly&&window.pomodoroSounds.done.play(),this.stop(),this.switchTimers(),v.capture("pomodoro complete",{period:this.activeTimerId})}else t()},switchTimers(){const t=this.autoplay;setTimeout((()=>{this.setTimer(this.activeTimerId===f.Focus?f.Break:f.Focus),t&&this.start()}),1500)},reset(){this.setCountdownTimer(),localStorage.removeItem("pomodoro-started-expected-timer-end"),localStorage.removeItem("pomodoro-time-remaining"),this.stop(),localStorage.setItem("pomodoro-reset",!0)},resetToFocus(){this.reset(),this.setTimer(f.Focus),this.setCountdownTimer()},start(){this.clearStartedTimeout(),this.started=!0,this.expectedTimerEnd=Date.now()+1e3*this.timeRemaining,localStorage.removeItem("pomodoro-time-remaining"),localStorage.setItem("pomodoro-running",!0),localStorage.setItem("pomodoro-started-expected-timer-end",this.expectedTimerEnd),this.timeOutForCountdown(),v.capture("pomodoro start",{period:this.activeTimerId})},stop(){this.clearStartedTimeout(),localStorage.setItem("pomodoro-running",!1),localStorage.setItem("pomodoro-time-remaining",this.timeRemaining),v.capture("pomodoro stop",{period:this.activeTimerId})},setTimer(t){this.started&&this.stop(),this.activeTimerId=t,localStorage.setItem("pomodoro-started",this.activeTimerId),this.setCountdownTimer()},clickTimer(t){this.setTimer(t),v.capture("period change",{new_value:t})},setCountdownTimer(){this.timeRemaining=60*this.activeTimer.minutes},setTimerDuration(t,e){this.saveSettingsToCustomization(`${t}Duration`,e),v.capture("duration change",{period:t,new_value:e})},setTimeRemainingAfterUpdate(t,e,o){if(this.activeTimerId!==t)return;const i=60*(o-e),s=this.timeRemaining;i<0&&s<0-i?this.complete():(this.timeRemaining+=i,this.expectedTimerEnd+=1e3*i,localStorage.setItem("pomodoro-started-expected-timer-end",this.expectedTimerEnd))},setTimerWhenNotStarted(t){this.started||this.activeTimerId!==t||(this.timeRemaining=60*this.timers[t].minutes)},closePomodoro(){this.$emit("pomodoro-show",!1)},handleStorageChangeForStartedPomodoro(t){switch(t.key){case"pomodoro-running":if(null===t.newValue)return;"true"===t.newValue?(this.clearStartedTimeout(),this.started=!0,this.expectedTimerEnd=Date.now()+1e3*this.timeRemaining,this.timeOutForCountdown()):this.clearStartedTimeout();break;case"pomodoro-reset":if(null===t.newValue)return;this.setCountdownTimer(),this.clearStartedTimeout(),localStorage.removeItem("pomodoro-reset");break;case"pomodoro-closed":if(null===t.newValue)return;document.title="New Tab",this.removeAllPomodoroLocalStorageKeys(),this.$emit("pomodoro-show",!1);break;case"pomodoro-complete":if(null===t.newValue)return;this.timeRemaining=0,this.stop(),this.switchTimers(),localStorage.removeItem("pomodoro-complete");break;case"pomodoro-started":if(null===t.newValue)return;this.setTimer(t.newValue)}},handleSettingsChange(){let t=this.getPomodoroSettingsFromCustomization();if(!t)return;const e=void 0===t.sounds||t.sounds;if(e!==this.sounds&&(this.sounds=e),t.autoplay!==this.autoplay&&(this.autoplay=t.autoplay),t.hideSeconds!==this.hideSeconds&&(this.hideSeconds=t.hideSeconds),Number(t.focusDuration)!==Number(this.timers.focus.minutes)){const e=this.timers.focus.minutes;this.timers.focus.minutes=Number(t.focusDuration),this.setTimeRemainingAfterUpdate(f.Focus,e,Number(t.focusDuration))}if(Number(t.restDuration)!==Number(this.timers.rest.minutes)){const e=this.timers.rest.minutes;this.timers.rest.minutes=Number(t.restDuration),this.setTimeRemainingAfterUpdate(f.Break,e,Number(t.restDuration))}},clearStartedTimeout(){this.started=!1,clearTimeout(this.timer)},removeAllPomodoroLocalStorageKeys(){["pomodoro-reset","pomodoro-running","pomodoro-closed","pomodoro-started-expected-timer-end","pomodoro-current-focus","pomodoro-complete","pomodoro-focus-timer"].forEach((t=>{localStorage.removeItem(t)}))},switchClock(t){"clock"===t&&this.closePomodoro()},getPomodoroSettingsFromCustomization(){const t=m.models.customization.get("pomodoroSettingsStr");return t&&JSON.parse(t)},setSettingsFromCustomization(){let t=this.getPomodoroSettingsFromCustomization();t&&(this.timers.focus.minutes=Number(t.focusDuration),this.timers.rest.minutes=Number(t.restDuration),this.sounds=void 0===t.sounds||t.sounds,this.autoplay=t.autoplay,this.hideSeconds=t.hideSeconds)},saveSettingsToCustomization(t,e){let o=this.getPomodoroSettingsFromCustomization();o&&(o[t]=e,m.models.customization.save("pomodoroSettingsStr",JSON.stringify(o)))},settingsMigrationFromLocalToCustomization(){let t={"pomodoro-focus-duration":"focusDuration","pomodoro-rest-duration":"restDuration","pomodoro-autoplay":"autoplay"};Object.keys(t).forEach((e=>{localStorage.getItem(e)&&(this.saveSettingsToCustomization(t[e],localStorage.getItem(e)),localStorage.removeItem(e))}))},completeTimer(){this.optionsOnly?m.trigger("pomodoro:complete"):(this.complete(),localStorage.setItem("pomodoro-complete",!0))},restartTimer(){this.optionsOnly?m.trigger("pomodoro:restart"):this.reset()},addTenMinutes(){this.setTimerDuration(f.Focus,Number(this.timers.focus.minutes)+10)},showToastMenu(){this.$e.$emit("pomodoro:toggleDropdown",!0)},async extendFocusAfterEnd(){this.setTimer(f.Focus),await l.Z.delay(1e3),Number(this.timers.focus.minutes)<10&&this.addTenMinutes(),this.timeRemaining=600,this.expectedTimerEnd=Date.now()+6e5,localStorage.setItem("pomodoro-started-expected-timer-end",this.expectedTimerEnd),await l.Z.delay(500),this.toggleMasterPlayPause()}}},y=()=>{(0,g.sj)(((t,e)=>({eca39bfe:t.dashProgress})))},S=b.setup;b.setup=S?(t,e)=>(y(),S(t,e)):y;const T=b;o(53259),o(97721);const w=(0,o(51900).Z)(T,i,[],!1,null,"724ca76b",null).exports},53259:(t,e,o)=>{var i=o(37385);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals),(0,o(45346).Z)("65195a04",i,!1,{ssrId:!0})},97721:(t,e,o)=>{var i=o(23207);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals),(0,o(45346).Z)("1e1867e0",i,!1,{ssrId:!0})}}]);