"use strict";(globalThis.webpackChunkmomentum=globalThis.webpackChunkmomentum||[]).push([[4145],{34145:(e,t,s)=>{s.d(t,{U:()=>n});var a=s(42935),r=s(24960),i=s(67652),h=s(35597);class n{constructor(e,{queryParams:t={},getResponseProperty:s,path:a="",mode:h=i.Z.Sync}={}){this.type=e,this.queryParams=t,this.getResponseProperty=s,this.path=a,this.mode=h,this.dataSync=r.Z}get({id:e,path:t=this.path||this.type,mode:s=this.mode,success:a,failure:r,queryParams:n={},retry:p,responseProperty:d=this.getResponseProperty,appendIdToPath:o,timestampKey:y=this.type}){(async()=>{var m;s===i.Z.Timestamp&&(s=await h.Z.requiresSync(y)?i.Z.Sync:i.Z.Cache,h.Z.addUpdateListener(y,this.refresh.bind(this,{id:e,path:t,queryParams:n,retry:p,responseProperty:d,appendIdToPath:o,timestampKey:y}))),t+=this.buildQueryString((null===(m=this.queryParams)||void 0===m?void 0:m.get)||{},n);const c=[this.type,{id:e,path:t,env:this.getEnv(),mode:s,retry:p,responseProperty:d,appendIdToPath:o,timestampKey:y}];s===i.Z.Server?this.dataSync.sendMessage({handler:"get",args:c}).then(a).catch(r):this.dataSync.sendRecurringCrossTabMessage({msgId:`${this.type}${e?`:${e}`:""}:refreshed`,handler:"get",args:c,success:a,failure:r})})()}refresh({id:e,path:t=this.path||this.type,queryParams:s={},retry:a,responseProperty:r=this.getResponseProperty,appendIdToPath:h,timestampKey:n=this.type}={}){return new Promise(((p,d)=>this.get({id:e,mode:i.Z.Server,path:t,queryParams:s,retry:a,success:p,failure:d,responseProperty:r,appendIdToPath:h,timestampKey:n})))}async create(e,t,{path:s=this.path||this.type,mode:a=this.mode}={}){const r=[this.type,e,t];r.push({path:s,mode:a,env:this.getEnv()}),await this.dataSync.sendMessage({handler:"create",args:r})}async update(e,t,{path:s=this.path||this.type,mode:a=this.mode,queryParams:r={},appendIdToPath:i}={}){var h;const n=this.buildQueryString((null===(h=this.queryParams)||void 0===h?void 0:h.update)||{},r),p=[this.type,e,t];p.push({path:s,mode:a,env:this.getEnv(),queryString:n,appendIdToPath:i}),await this.dataSync.sendMessage({handler:"update",args:p})}async delete(e,{path:t=this.path||this.type,mode:s=this.mode}={}){const a=[this.type,e];a.push({path:t,mode:s,env:this.getEnv()}),await this.dataSync.sendMessage({handler:"delete",args:a})}getEnv(){return{token:localStorage.getItem("token"),clientUuid:localStorage.getItem("client_uuid"),apiUrl:m.globals.urlRootApi,version:m.globals.version,tabId:a.Z}}buildQueryString(...e){const t=e.reduce(((e,t)=>({...t,...e})),{}),s=new URLSearchParams(t).toString();return s?"?"+s:""}}},67652:(e,t,s)=>{var a;s.d(t,{Z:()=>r}),function(e){e.Sync="sync",e.Cache="cache",e.Server="server",e.Timestamp="timestamp"}(a||(a={}));const r=a}}]);