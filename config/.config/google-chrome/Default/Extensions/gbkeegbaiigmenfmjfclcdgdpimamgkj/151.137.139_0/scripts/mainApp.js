/*
 RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/domReady for details

 lodash 4.5.1 (Custom Build) lodash.com/license | Underscore.js 1.8.3 underscorejs.org/LICENSE
 Build: `lodash -o ./dist/lodash.js`
 MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors  MIT License (c) copyright 2010-2014 original author or authors */
define("third_party/domready/domReady",[],function(){function e(){if(!q){q=!0;k&&clearInterval(k);var a=l;if(q&&a.length){l=[];var c;for(c=0;c<a.length;c+=1)a[c](t)}}}function c(a){q?a(t):l.push(a);return c}var g,a,k,n="undefined"!==typeof window&&window.document,q=!n,t=n?document:null,l=[];if(n){if(document.addEventListener)document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1);else if(window.attachEvent){window.attachEvent("onload",e);a=document.createElement("div");
try{g=null===window.frameElement}catch(u){}a.doScroll&&g&&window.external&&(k=setInterval(function(){try{a.doScroll(),e()}catch(c){}},30))}"complete"===document.readyState&&e()}c.version="2.0.1";c.load=function(a,e,l,g){g.isBuild?l(null):c(l)};return c});
(function(){function e(c){var e=null;if(this.id===c)return this;if(this.hasChildNodes())for(var a=0,k=this.childNodes.length;a<k&&(this.childNodes[a].nodeType!==Node.ELEMENT_NODE||!(e=this.childNodes[a].getElementById(c))||e.id!==c);a++);return e}Element.prototype.clear=function(){if(this.hasChildNodes())for(;1<=this.childNodes.length;)this.removeChild(this.firstChild);return this};Element.prototype.removeElm=function(){return this.parentNode?(this.parentNode.removeChild(this),this):null};Function.prototype.bake=
function(c){var e=this,a=[].slice.call(arguments,1);return function(){return e.apply(c,a.concat([].slice.call(arguments,0)))}};Element.prototype.getElementById=e;DocumentFragment.prototype.getElementById=e})();define("qowtRoot/lib/framework/framework",function(){});
(function(){function e(a,f){return a.set(f[0],f[1]),a}function c(a,f){return a.add(f),a}function g(a,f,c){switch(c.length){case 0:return a.call(f);case 1:return a.call(f,c[0]);case 2:return a.call(f,c[0],c[1]);case 3:return a.call(f,c[0],c[1],c[2])}return a.apply(f,c)}function a(a,f,c,e){for(var m=-1,l=a.length;++m<l;){var g=a[m];f(e,g,c(g),a)}return e}function k(a,f){for(var c=-1,e=a.length;++c<e&&!1!==f(a[c],c,a););return a}function n(a,f){for(var c=-1,e=a.length;++c<e;)if(!f(a[c],c,a))return!1;
return!0}function q(a,f){for(var c=-1,e=a.length,m=-1,l=[];++c<e;){var g=a[c];f(g,c,a)&&(l[++m]=g)}return l}function t(a,f){return!!a.length&&-1<B(a,f,0)}function l(a,f,c){for(var e=-1,m=a.length;++e<m;)if(c(f,a[e]))return!0;return!1}function u(a,f){for(var c=-1,e=a.length,m=Array(e);++c<e;)m[c]=f(a[c],c,a);return m}function r(a,f){for(var c=-1,e=f.length,m=a.length;++c<e;)a[m+c]=f[c];return a}function w(a,f,c,e){var m=-1,l=a.length;for(e&&l&&(c=a[++m]);++m<l;)c=f(c,a[m],m,a);return c}function M(a,
f,c,e){var m=a.length;for(e&&m&&(c=a[--m]);m--;)c=f(c,a[m],m,a);return c}function H(a,f){for(var c=-1,e=a.length;++c<e;)if(f(a[c],c,a))return!0;return!1}function E(a,f,c){for(var e=-1,m=a.length;++e<m;){var l=a[e],g=f(l);if(null!=g&&(k===p?g===g:c(g,k)))var k=g,n=l}return n}function x(a,f,c,e){var m;return c(a,function(a,c,l){return f(a,c,l)?(m=e?c:a,!1):void 0}),m}function y(a,f,c){for(var e=a.length,m=c?e:-1;c?m--:++m<e;)if(f(a[m],m,a))return m;return-1}function B(a,f,c){if(f!==f)return la(a,c);
--c;for(var e=a.length;++c<e;)if(a[c]===f)return c;return-1}function N(a,f,c,e,m){return m(a,function(a,m,l){c=e?(e=!1,a):f(c,a,m,l)}),c}function da(a,f){var c=a.length;for(a.sort(f);c--;)a[c]=a[c].c;return a}function Z(a,f){for(var c,e=-1,m=a.length;++e<m;){var l=f(a[e]);l!==p&&(c=c===p?l:c+l)}return c}function O(a,f){for(var c=-1,e=Array(a);++c<a;)e[c]=f(c);return e}function I(a,f){return u(f,function(f){return[f,a[f]]})}function ea(a){return function(f){return a(f)}}function T(a,f){return u(f,
function(f){return a[f]})}function S(a,f){for(var c=-1,e=a.length;++c<e&&-1<B(f,a[c],0););return c}function C(a,f){for(var c=a.length;c--&&-1<B(f,a[c],0););return c}function X(a){return a&&a.Object===Object?a:null}function ma(a,f){if(a!==f){var c=null===a,e=a===p,m=a===a,l=null===f,g=f===p,k=f===f;if(a>f&&!l||!m||c&&!g&&k||e&&k)return 1;if(f>a&&!c||!k||l&&!e&&m||g&&m)return-1}return 0}function jb(a){return Va[a]}function Cb(a){return aa[a]}function m(a){return"\\"+Ga[a]}function la(a,f,c){var e=a.length;
for(f+=c?0:-1;c?f--:++f<e;){var m=a[f];if(m!==m)return f}return-1}function za(a){var f=!1;if(null!=a&&"function"!=typeof a.toString)try{f=!!(a+"")}catch(c){}return f}function Aa(a,f){return a="number"==typeof a||Na.test(a)?+a:-1,-1<a&&0==a%1&&(null==f?9007199254740991:f)>a}function kb(a){for(var f,c=[];!(f=a.next()).done;)c.push(f.value);return c}function Wa(a){var f=-1,c=Array(a.size);return a.forEach(function(a,e){c[++f]=[e,a]}),c}function Ha(a,f){for(var c=-1,e=a.length,m=-1,l=[];++c<e;){var g=
a[c];(g===f||"__lodash_placeholder__"===g)&&(a[c]="__lodash_placeholder__",l[++m]=c)}return l}function lb(a){var f=-1,c=Array(a.size);return a.forEach(function(a){c[++f]=a}),c}function Za(a){if(!a||!mb.test(a))return a.length;for(var f=ia.lastIndex=0;ia.test(a);)f++;return f}function nc(a){return Xa[a]}function Db(R){function f(b){if(ba(b)&&!D(b)&&!(b instanceof F)){if(b instanceof sa)return b;if(Y.call(b,"__wrapped__"))return wd(b)}return new sa(b)}function X(){}function sa(b,d){this.__wrapped__=
b;this.__actions__=[];this.__chain__=!!d;this.__index__=0;this.__values__=p}function F(b){this.__wrapped__=b;this.__actions__=[];this.__dir__=1;this.__filtered__=!1;this.__iteratees__=[];this.__takeCount__=4294967295;this.__views__=[]}function mc(){}function W(b){var d=-1,h=b?b.length:0;for(this.clear();++d<h;){var J=b[d];this.set(J[0],J[1])}}function ka(b){var d=-1,h=b?b.length:0;for(this.__data__=new W;++d<h;)this.push(b[d])}function qa(b,d){var h=b.__data__;return nb(d)?(h=h.__data__,"__lodash_hash_undefined__"===
("string"==typeof d?h.string:h.hash)[d]):h.has(d)}function aa(b){var d=-1,h=b?b.length:0;for(this.clear();++d<h;){var J=b[d];this.set(J[0],J[1])}}function ya(b,d){var h=ra(b,d);return 0>h?!1:(h==b.length-1?b.pop():Qb.call(b,h,1),!0)}function Ga(b,d){var h=ra(b,d);return 0>h?p:b[h][1]}function ra(b,d){for(var h=b.length;h--;)if(Oa(b[h][0],d))return h;return-1}function Va(b,d,h){var J=ra(b,d);0>J?b.push([d,h]):b[J][1]=h}function Na(b,d,h,J){return b===p||Oa(b,ob[h])&&!Y.call(J,h)?d:b}function Xa(b,
d,h){(h===p||Oa(b[d],h))&&("number"!=typeof d||h!==p||d in b)||(b[d]=h)}function Ua(b,d,h){var J=b[d];Y.call(b,d)&&Oa(J,h)&&(h!==p||d in b)||(b[d]=h)}function We(b,d,h,J){return Pa(b,function(b,a,f){d(J,b,h(b),f)}),J}function xd(b,d){return b&&Eb(d,ja(d),b)}function oc(b,d){for(var h=-1,J=null==b,a=d.length,f=Array(a);++h<a;)f[h]=J?p:Fb(b,d[h]);return f}function pc(b){return ca(b)?b:[]}function $a(b){return"function"==typeof b?b:Ba}function ab(b){return D(b)?b:yd(b)}function pb(b,d,h){return b===
b&&(h!==p&&(b=b>h?h:b),d!==p&&(b=d>b?d:b)),b}function Ca(b,d,h,J,a,f){var c;if(h&&(c=a?h(b,J,a,f):h(b)),c!==p)return c;if(!V(b))return b;if(J=D(b)){if(c=Xe(b),!d)return na(b,c)}else{var e=Da(b),m="[object Function]"==e||"[object GeneratorFunction]"==e;if(zd(b))return Ye(b,d);if("[object Object]"==e||"[object Arguments]"==e||m&&!a){if(za(b))return a?b:{};if(c=Ze(m?{}:b),!d)return Ad(b,xd(c,b))}else{if(!L[e])return a?b:{};c=$e(b,e,d)}}return f||(f=new aa),(a=f.get(b))?a:(f.set(b,c),(J?k:Ea)(b,function(a,
J){Ua(c,J,Ca(a,d,h,J,b,f))}),J?c:Ad(b,c))}function af(b){var d=ja(b),h=d.length;return function(J){if(null==J)return!h;for(var a=h;a--;){var f=d[a],c=b[f],e=J[f];if(e===p&&!(f in Object(J))||!c(e))return!1}return!0}}function qb(b){return V(b)?bf(b):{}}function Bd(b,d,h){if("function"!=typeof b)throw new ta("Expected a function");return Rb(function(){b.apply(p,h)},d)}function bb(b,d,h,a){var f=-1,c=t,e=!0,m=b.length,g=[],k=d.length;if(!m)return g;h&&(d=u(d,ea(h)));a?(c=l,e=!1):200<=d.length&&(c=qa,
e=!1,d=new ka(d));a:for(;++f<m;){var n=b[f],v=h?h(n):n;if(e&&v===v){for(var q=k;q--;)if(d[q]===v)continue a;g.push(n)}else c(d,v,a)||g.push(n)}return g}function cf(b,d){var h=!0;return Pa(b,function(b,a,f){return h=!!d(b,a,f)}),h}function Cd(b,d){var h=[];return Pa(b,function(b,a,f){d(b,a,f)&&h.push(b)}),h}function U(b,d,h,a){a||(a=[]);for(var f=-1,c=b.length;++f<c;){var e=b[f];0<d&&ca(e)&&(h||D(e)||cb(e))?1<d?U(e,d-1,h,a):r(a,e):h||(a[a.length]=e)}return a}function df(b,d){return null==b?b:qc(b,
d,ua)}function Ea(b,d){return b&&qc(b,d,ja)}function rc(b,d){return b&&Dd(b,d,ja)}function Sb(b,d){return q(d,function(d){return va(b[d])})}function sc(b,d){d=Qa(d,b)?[d+""]:ab(d);for(var h=0,a=d.length;null!=b&&a>h;)b=b[d[h++]];return h&&h==a?b:p}function tc(b,d){return Y.call(b,d)||"object"==typeof b&&d in b&&null===Tb(b)}function ef(b,d){return d in Object(b)}function uc(b,d,h){for(var a=h?l:t,f=b.length,c=f,e=Array(f),m=[];c--;){var g=b[c];c&&d&&(g=u(g,ea(d)));e[c]=h||!d&&120>g.length?p:new ka(c&&
g)}var g=b[0],k=-1,n=g.length,v=e[0];a:for(;++k<n;){var q=g[k],r=d?d(q):q;if(v?!qa(v,r):!a(m,r,h)){for(c=f;--c;){var w=e[c];if(w?!qa(w,r):!a(b[c],r,h))continue a}v&&v.push(r);m.push(q)}}return m}function ff(b,d,h,a){return Ea(b,function(b,f,c){d(a,h(b),f,c)}),a}function Gb(b,d,h){return Qa(d,b)||(d=ab(d),b=Hb(b,d),d=oa(d)),d=null==b?b:b[d],null==d?p:g(d,b,h)}function db(b,d,h,a,f){if(b===d)return!0;if(null==b||null==d||!V(b)&&!ba(d))return b!==b&&d!==d;var c=D(b),e=D(d),m="[object Array]",l="[object Array]";
c||(m=Da(b),"[object Arguments]"==m?m="[object Object]":"[object Object]"!=m&&(c=rb(b)));e||(l=Da(d),"[object Arguments]"==l?l="[object Object]":"[object Object]"!=l&&rb(d));var g="[object Object]"==m&&!za(b),e="[object Object]"==l&&!za(d),l=m==l;!l||c||g?2&a||(m=g&&Y.call(b,"__wrapped__"),e=e&&Y.call(d,"__wrapped__"),!m&&!e)?l?(f||(f=new aa),b=(c?gf:hf)(b,d,db,h,a,f)):b=!1:b=db(m?b.value():b,e?d.value():d,h,a,f):b=jf(b,d,m,db,h,a);return b}function vc(b,d,h,a){var f=h.length,c=f,e=!a;if(null==b)return!c;
for(b=Object(b);f--;){var m=h[f];if(e&&m[2]?m[1]!==b[m[0]]:!(m[0]in b))return!1}for(;++f<c;){var m=h[f],l=m[0],g=b[l],k=m[1];if(e&&m[2]){if(g===p&&!(l in b))return!1}else if(m=new aa,l=a?a(g,k,l,b,d,m):p,l===p?!db(k,g,a,3,m):!l)return!1}return!0}function Ed(b){var d=typeof b;return"function"==d?b:null==b?Ba:"object"==d?D(b)?Fd(b[0],b[1]):Gd(b):Hd(b)}function Id(b){b=null==b?b:Object(b);var d,h=[];for(d in b)h.push(d);return h}function Jd(b,d){var h=-1,a=wa(b)?Array(b.length):[];return Pa(b,function(b,
f,c){a[++h]=d(b,f,c)}),a}function Gd(b){var d=wc(b);if(1==d.length&&d[0][2]){var h=d[0][0],a=d[0][1];return function(b){return null==b?!1:b[h]===a&&(a!==p||h in Object(b))}}return function(h){return h===b||vc(h,b,d)}}function Fd(b,d){return function(h){var a=Fb(h,b);return a===p&&a===d?Kd(h,b):db(d,a,p,3)}}function Ub(b,d,h,a,f){if(b!==d){var c=D(d)||rb(d)?p:ua(d);k(c||d,function(e,m){if(c&&(m=e,e=d[m]),V(e)){f||(f=new aa);var l=m,g=f,k=b[l],n=d[l],v=g.get(n);if(!v){var v=a?a(k,n,l+"",b,d,g):p,q=
v===p;q&&(v=n,D(n)||rb(n)?D(k)?v=k:ca(k)?v=na(k):(q=!1,v=Ca(n,!0)):xc(n)||cb(n)?cb(k)?v=Ld(k):!V(k)||h&&va(k)?(q=!1,v=Ca(n,!0)):v=k:q=!1);g.set(n,v);q&&Ub(v,n,h,a,g)}Xa(b,l,v)}else l=a?a(b[m],e,m+"",b,d,f):p,l===p&&(l=e),Xa(b,m,l)})}}function Md(b,d,h){var a=-1,f=A();return d=u(d.length?d:Array(1),function(b){return f(b)}),b=Jd(b,function(b,h,f){return{a:u(d,function(d){return d(b)}),b:++a,c:b}}),da(b,function(b,d){var a;a:{a=-1;for(var f=b.a,c=d.a,J=f.length,e=h.length;++a<J;){var m=ma(f[a],c[a]);
if(m){if(a>=e){a=m;break a}a=m*("desc"==h[a]?-1:1);break a}}a=b.b-d.b}return a})}function Nd(b,d){return b=Object(b),w(d,function(d,a){return a in b&&(d[a]=b[a]),d},{})}function Od(b,d){var h={};return df(b,function(b,a){d(b,a)&&(h[a]=b)}),h}function yc(b){return function(d){return null==d?p:d[b]}}function kf(b){return function(d){return sc(d,b)}}function Pd(b,d,h){var a=-1,f=d.length,c=b;for(h&&(c=u(b,function(b){return h(b)}));++a<f;)for(var e=0,m=d[a],m=h?h(m):m;-1<(e=B(c,m,e));)c!==b&&Qb.call(c,
e,1),Qb.call(b,e,1);return b}function Qd(b,d){for(var h=b?d.length:0,a=h-1;h--;){var f=d[h];if(a==h||f!=c){var c=f;if(Aa(f))Qb.call(b,f,1);else if(Qa(f,b))delete b[f];else{var f=ab(f),e=Hb(b,f);null!=e&&delete e[oa(f)]}}}return b}function zc(b,d){return b+Vb(Rd()*(d-b+1))}function Ac(b,d,h,a){d=Qa(d,b)?[d+""]:ab(d);for(var f=-1,c=d.length,e=c-1,m=b;null!=m&&++f<c;){var l=d[f];if(V(m)){var g=h;if(f!=e){var k=m[l],g=a?a(k,l,m):p;g===p&&(g=null==k?Aa(d[f+1])?[]:{}:k)}Ua(m,l,g)}m=m[l]}return b}function Ra(b,
d,h){var a=-1,f=b.length;0>d&&(d=-d>f?0:f+d);h=h>f?f:h;0>h&&(h+=f);f=d>h?0:h-d>>>0;d>>>=0;for(h=Array(f);++a<f;)h[a]=b[a+d];return h}function lf(b,d){var h;return Pa(b,function(b,a,f){return h=d(b,a,f),!h}),!!h}function Wb(b,d,h){var a=0,f=b?b.length:a;if("number"==typeof d&&d===d&&2147483647>=f){for(;f>a;){var c=a+f>>>1,e=b[c];(h?d>=e:d>e)&&null!==e?a=c+1:f=c}return f}return Bc(b,d,Ba,h)}function Bc(b,d,h,a){d=h(d);for(var f=0,c=b?b.length:0,e=d!==d,m=null===d,l=d===p;c>f;){var g=Vb((f+c)/2),k=h(b[g]),
n=k!==p,v=k===k;(e?v||a:m?v&&n&&(a||null!=k):l?v&&(a||n):null==k?0:a?d>=k:d>k)?f=g+1:c=g}return xa(c,4294967294)}function Sd(b,d){for(var h=0,a=b.length,f=b[0],c=d?d(f):f,e=c,m=0,l=[f];++h<a;)f=b[h],c=d?d(f):f,Oa(c,e)||(e=c,l[++m]=f);return l}function eb(b,d,h){var a=-1,f=t,c=b.length,e=!0,m=[],g=m;if(h)e=!1,f=l;else if(200>c)g=d?[]:m;else{if(f=d?null:mf(b))return lb(f);e=!1;f=qa;g=new ka}a:for(;++a<c;){var k=b[a],n=d?d(k):k;if(e&&n===n){for(var v=g.length;v--;)if(g[v]===n)continue a;d&&g.push(n);
m.push(k)}else f(g,n,h)||(g!==m&&g.push(n),m.push(k))}return m}function Xb(b,d,h,a){for(var f=b.length,c=a?f:-1;(a?c--:++c<f)&&d(b[c],c,b););return h?Ra(b,a?0:c,a?c+1:f):Ra(b,a?c+1:0,a?f:c)}function Td(b,d){var h=b;return h instanceof F&&(h=h.value()),w(d,function(b,d){return d.func.apply(d.thisArg,r([b],d.args))},h)}function Cc(b,d,h){for(var a=-1,f=b.length;++a<f;)var c=c?r(bb(c,b[a],d,h),bb(b[a],c,d,h)):b[a];return c&&c.length?eb(c,d,h):[]}function Ud(b,d,h){for(var a=-1,f=b.length,c=d.length,
e={};++a<f;)h(e,b[a],c>a?d[a]:p);return e}function Ye(b,d){if(d)return b.slice();var h=new b.constructor(b.length);return b.copy(h),h}function Vd(b){var d=new b.constructor(b.byteLength);return(new Yb(d)).set(new Yb(b)),d}function Wd(b,d,h,a){var f=-1,c=b.length,e=h.length,m=-1,l=d.length,g=fa(c-e,0),k=Array(l+g);for(a=!a;++m<l;)k[m]=d[m];for(;++f<e;)(a||c>f)&&(k[h[f]]=b[f]);for(;g--;)k[m++]=b[f++];return k}function Xd(b,d,h,a){var f=-1,c=b.length,e=-1,m=h.length,l=-1,g=d.length,k=fa(c-m,0),n=Array(k+
g);for(a=!a;++f<k;)n[f]=b[f];for(k=f;++l<g;)n[k+l]=d[l];for(;++e<m;)(a||c>f)&&(n[k+h[e]]=b[f++]);return n}function na(b,d){var h=-1,a=b.length;for(d||(d=Array(a));++h<a;)d[h]=b[h];return d}function Eb(b,d,h){return Dc(b,d,h)}function Dc(b,d,h,a){h||(h={});for(var f=-1,c=d.length;++f<c;){var e=d[f],m=a?a(h[e],b[e],e,h,b):b[e];Ua(h,e,m)}return h}function Ad(b,d){return Eb(b,nf(b),d)}function Zb(b,d){return function(h,f){var c=D(h)?a:We,e=d?d():{};return c(h,b,A(f),e)}}function sb(b){return z(function(d,
h){var a=-1,f=h.length,c=1<f?h[f-1]:p,e=2<f?h[2]:p,c="function"==typeof c?(f--,c):p;e&&Ia(h[0],h[1],e)&&(c=3>f?p:c,f=1);for(d=Object(d);++a<f;)(e=h[a])&&b(d,e,a,c);return d})}function Yd(b,d){return function(h,a){if(null==h)return h;if(!wa(h))return b(h,a);for(var f=h.length,c=d?f:-1,e=Object(h);(d?c--:++c<f)&&!1!==a(e[c],c,e););return h}}function Zd(b){return function(d,h,a){var f=-1,c=Object(d);a=a(d);for(var e=a.length;e--;){var m=a[b?e:++f];if(!1===h(c[m],m,c))break}return d}}function of(b,d,
h){function a(){return(this&&this!==v&&this instanceof a?c:b).apply(f?h:this,arguments)}var f=1&d,c=Ib(b);return a}function $d(b){return function(d){d=K(d);var h=mb.test(d)?d.match(ia):p,a=h?h[0]:d.charAt(0);return d=h?h.slice(1).join(""):d.slice(1),a[b]()+d}}function tb(b){return function(d){return w(ae(be(d)),b,"")}}function Ib(b){return function(){var d=arguments;switch(d.length){case 0:return new b;case 1:return new b(d[0]);case 2:return new b(d[0],d[1]);case 3:return new b(d[0],d[1],d[2]);case 4:return new b(d[0],
d[1],d[2],d[3]);case 5:return new b(d[0],d[1],d[2],d[3],d[4]);case 6:return new b(d[0],d[1],d[2],d[3],d[4],d[5]);case 7:return new b(d[0],d[1],d[2],d[3],d[4],d[5],d[6])}var h=qb(b.prototype),d=b.apply(h,d);return V(d)?d:h}}function pf(b,d,h){function a(){for(var c=arguments.length,e=Array(c),m=c,l=ub(a);m--;)e[m]=arguments[m];return m=3>c&&e[0]!==l&&e[c-1]!==l?[]:Ha(e,l),c-=m.length,h>c?ce(b,d,$b,a.placeholder,p,e,m,p,p,h-c):g(this&&this!==v&&this instanceof a?f:b,this,e)}var f=Ib(b);return a}function de(b){return z(function(d){d=
U(d,1);var h=d.length,a=h,f=sa.prototype.thru;for(b&&d.reverse();a--;){var c=d[a];if("function"!=typeof c)throw new ta("Expected a function");if(f&&!e&&"wrapper"==ac(c))var e=new sa([],!0)}for(a=e?a:h;++a<h;)var c=d[a],f=ac(c),m="wrapper"==f?Ec(c):p,e=m&&Fc(m[0])&&424==m[1]&&!m[4].length&&1==m[9]?e[ac(m[0])].apply(e,m[3]):1==c.length&&Fc(c)?e[f]():e.thru(c);return function(){var b=arguments,a=b[0];if(e&&1==b.length&&D(a)&&200<=a.length)return e.plant(a).value();for(var f=0,b=h?d[f].apply(this,b):
a;++f<h;)b=d[f].call(this,b);return b}})}function $b(b,d,h,a,f,c,e,m,l,g){function k(){for(var C=arguments.length,la=C,Q=Array(C);la--;)Q[la]=arguments[la];if(u){var N,ma=ub(k),la=Q.length;for(N=0;la--;)Q[la]===ma&&N++}if(a&&(Q=Wd(Q,a,f,u)),c&&(Q=Xd(Q,c,e,u)),C-=N,u&&g>C)return ma=Ha(Q,ma),ce(b,d,$b,k.placeholder,h,Q,ma,m,l,g-C);if(ma=q?h:this,la=r?ma[b]:b,C=Q.length,m){N=Q.length;for(var B=xa(m.length,N),I=na(Q);B--;){var O=m[B];Q[B]=Aa(O,N)?I[O]:p}}else t&&1<C&&Q.reverse();return n&&C>l&&(Q.length=
l),this&&this!==v&&this instanceof k&&(la=w||Ib(la)),la.apply(ma,Q)}var n=128&d,q=1&d,r=2&d,u=24&d,t=512&d,w=r?p:Ib(b);return k}function ee(b,d){return function(h,a){return ff(h,b,d(a),{})}}function Gc(b){return z(function(d){return d=u(U(d,1),A()),z(function(h){var a=this;return b(d,function(b){return g(b,a,h)})})})}function bc(b,d,h){return d=G(d),b=Za(b),d&&d>b?(d-=b,h=h===p?" ":h+"",b=fe(h,cc(d/Za(h))),mb.test(h)?b.match(ia).slice(0,d).join(""):b.slice(0,d)):""}function qf(b,d,h,a){function f(){for(var d=
-1,m=arguments.length,l=-1,k=a.length,n=Array(k+m),q=this&&this!==v&&this instanceof f?e:b;++l<k;)n[l]=a[l];for(;m--;)n[l++]=arguments[++d];return g(q,c?h:this,n)}var c=1&d,e=Ib(b);return f}function ge(b){return function(d,h,a){a&&"number"!=typeof a&&Ia(d,h,a)&&(h=a=p);d=ga(d);d=d===d?d:0;h===p?(h=d,d=0):h=ga(h)||0;a=a===p?h>d?1:-1:ga(a)||0;var f=-1;h=fa(cc((h-d)/(a||1)),0);for(var c=Array(h);h--;)c[b?h:++f]=d,d+=a;return c}}function ce(b,d,h,a,f,c,e,m,l,g){var k=8&d;m=m?na(m):p;var n=k?e:p;e=k?p:
e;var v=k?c:p;return c=k?p:c,d=(d|(k?32:64))&~(k?64:32),4&d||(d&=-4),d=[b,d,f,v,n,c,e,m,l,g],h=h.apply(p,d),Fc(b)&&he(h,d),h.placeholder=a,h}function Hc(b){var d=vb[b];return function(b,a){if(b=ga(b),a=G(a)){var f=(K(b)+"e").split("e"),f=d(f[0]+"e"+(+f[1]+a)),f=(K(f)+"e").split("e");return+(f[0]+"e"+(+f[1]-a))}return d(b)}}function Sa(b,d,h,a,f,c,e,m){var l=2&d;if(!l&&"function"!=typeof b)throw new ta("Expected a function");var g=a?a.length:0;if(g||(d&=-97,a=f=p),e=e===p?e:fa(G(e),0),m=m===p?m:G(m),
g-=f?f.length:0,64&d){var k=a,n=f;a=f=p}var v=l?p:Ec(b);return c=[b,d,h,a,f,k,n,c,e,m],v&&(h=c[1],b=v[1],d=h|b,a=128==b&&8==h||128==b&&256==h&&v[8]>=c[7].length||384==b&&v[8]>=v[7].length&&8==h,131>d||a)&&(1&b&&(c[2]=v[2],d|=1&h?0:4),(h=v[3])&&(a=c[3],c[3]=a?Wd(a,h,v[4]):na(h),c[4]=a?Ha(c[3],"__lodash_placeholder__"):na(v[4])),(h=v[5])&&(a=c[5],c[5]=a?Xd(a,h,v[6]):na(h),c[6]=a?Ha(c[5],"__lodash_placeholder__"):na(v[6])),(h=v[7])&&(c[7]=na(h)),128&b&&(c[8]=null==c[8]?v[8]:xa(c[8],v[8])),null==c[9]&&
(c[9]=v[9]),c[0]=v[0],c[1]=d),b=c[0],d=c[1],h=c[2],a=c[3],f=c[4],m=c[9]=null==c[9]?l?0:b.length:fa(c[9]-g,0),!m&&24&d&&(d&=-25),l=d&&1!=d?8==d||16==d?pf(b,d,m):32!=d&&33!=d||f.length?$b.apply(p,c):qf(b,d,h,a):of(b,d,h),(v?ie:he)(l,c)}function gf(b,d,h,a,f,c){var e=-1,m=2&f,l=1&f,g=b.length,k=d.length;if(!(g==k||m&&k>g))return!1;if(k=c.get(b))return k==d;k=!0;for(c.set(b,d);++e<g;){var n=b[e],v=d[e];if(a)var q=m?a(v,n,e,d,b,c):a(n,v,e,b,d,c);if(q!==p){if(q)continue;k=!1;break}if(l){if(!H(d,function(b){return n===
b||h(n,b,a,f,c)})){k=!1;break}}else if(n!==v&&!h(n,v,a,f,c)){k=!1;break}}return c["delete"](b),k}function jf(b,d,h,a,f,c){switch(h){case "[object ArrayBuffer]":if(b.byteLength!=d.byteLength||!a(new Yb(b),new Yb(d)))break;return!0;case "[object Boolean]":case "[object Date]":return+b==+d;case "[object Error]":return b.name==d.name&&b.message==d.message;case "[object Number]":return b!=+b?d!=+d:b==+d;case "[object RegExp]":case "[object String]":return b==d+"";case "[object Map]":var e=Wa;case "[object Set]":return e||
(e=lb),(2&c||b.size==d.size)&&a(e(b),e(d),f,1|c);case "[object Symbol]":return!!Ta&&Ic.call(b)==Ic.call(d)}return!1}function hf(b,d,h,a,f,c){var e=2&f,m=ja(b),l=m.length,g=ja(d).length;if(l!=g&&!e)return!1;for(var k=l;k--;){var n=m[k];if(!(e?n in d:tc(d,n)))return!1}if(g=c.get(b))return g==d;g=!0;c.set(b,d);for(var v=e;++k<l;){var n=m[k],q=b[n],r=d[n];if(a)var u=e?a(r,q,n,d,b,c):a(q,r,n,b,d,c);if(u===p?q!==r&&!h(q,r,a,f,c):!u){g=!1;break}v||(v="constructor"==n)}return g&&!v&&(h=b.constructor,a=d.constructor,
h!=a&&"constructor"in b&&"constructor"in d&&!("function"==typeof h&&h instanceof h&&"function"==typeof a&&a instanceof a)&&(g=!1)),c["delete"](b),g}function ac(b){for(var d=b.name+"",h=Jb[d],a=Y.call(Jb,d)?h.length:0;a--;){var f=h[a],c=f.func;if(null==c||c==b)return f.name}return d}function A(){var b=f.iteratee||Jc,b=b===Jc?Ed:b;return arguments.length?b(arguments[0],arguments[1]):b}function wc(b){b=je(b);for(var d=b.length;d--;){var h,a=b[d];h=b[d][1];h=h===h&&!V(h);a[2]=h}return b}function dc(b,
d){var h=null==b?p:b[d];return ke(h)?h:p}function ub(b){return(Y.call(f,"placeholder")?f:b).placeholder}function Da(b){return pa.call(b)}function le(b,d,h){if(null==b)return!1;var a=h(b,d);return a||Qa(d)||(d=ab(d),b=Hb(b,d),null!=b&&(d=oa(d),a=h(b,d))),h=b?b.length:p,a||!!h&&Kb(h)&&Aa(d,h)&&(D(b)||fb(b)||cb(b))}function Xe(b){var d=b.length,h=b.constructor(d);return d&&"string"==typeof b[0]&&Y.call(b,"index")&&(h.index=b.index,h.input=b.input),h}function Ze(b){return va(b.constructor)&&!Kc(b)?qb(Tb(b)):
{}}function $e(b,d,h){var a=b.constructor;switch(d){case "[object ArrayBuffer]":return Vd(b);case "[object Boolean]":case "[object Date]":return new a(+b);case "[object Float32Array]":case "[object Float64Array]":case "[object Int8Array]":case "[object Int16Array]":case "[object Int32Array]":case "[object Uint8Array]":case "[object Uint8ClampedArray]":case "[object Uint16Array]":case "[object Uint32Array]":return d=b.buffer,h=h?Vd(d):d,new b.constructor(h,b.byteOffset,b.length);case "[object Map]":return h=
b.constructor,w(Wa(b),e,new h);case "[object Number]":case "[object String]":return new a(b);case "[object RegExp]":return h=new b.constructor(b.source,ec.exec(b)),h.lastIndex=b.lastIndex,h;case "[object Set]":return h=b.constructor,w(lb(b),c,new h);case "[object Symbol]":return Ta?Object(Ic.call(b)):{}}}function me(b){var d=b?b.length:p;return Kb(d)&&(D(b)||fb(b)||cb(b))?O(d,String):null}function Ia(b,d,h){if(!V(h))return!1;var a=typeof d;return("number"==a?wa(h)&&Aa(d,h.length):"string"==a&&d in
h)?Oa(h[d],b):!1}function Qa(b,d){return"number"==typeof b?!0:!D(b)&&(fc.test(b)||!Lc.test(b)||null!=d&&b in Object(d))}function nb(b){var d=typeof b;return"number"==d||"boolean"==d||"string"==d&&"__proto__"!=b||null==b}function Fc(b){var d=ac(b),h=f[d];return"function"==typeof h&&d in F.prototype?b===h?!0:(d=Ec(h),!!d&&b===d[0]):!1}function Kc(b){var d=b&&b.constructor,d=va(d)&&d.prototype||ob;return b===d}function ne(b,d,h,a,f,c){return V(b)&&V(d)&&(c.set(d,b),Ub(b,d,p,ne,c)),b}function Hb(b,d){return 1==
d.length?b:Fb(b,Ra(d,0,-1))}function yd(b){var d=[];return K(b).replace(Mc,function(b,a,f,c){d.push(f?c.replace(Nc,"$1"):a||b)}),d}function wd(b){if(b instanceof F)return b.clone();var d=new sa(b.__wrapped__,b.__chain__);return d.__actions__=na(b.__actions__),d.__index__=b.__index__,d.__values__=b.__values__,d}function oe(b,d,h){var a=b?b.length:0;return a?(d=h||d===p?1:G(d),Ra(b,0>d?0:d,a)):[]}function pe(b,d,h){var a=b?b.length:0;return a?(d=h||d===p?1:G(d),d=a-d,Ra(b,0,0>d?0:d)):[]}function qe(b){return b?
b[0]:p}function oa(b){var d=b?b.length:0;return d?b[d-1]:p}function re(b,d){return b&&b.length&&d&&d.length?Pd(b,d):b}function Oc(b){return b?rf.call(b):b}function Pc(b){if(!b||!b.length)return[];var d=0;return b=q(b,function(b){return ca(b)?(d=fa(b.length,d),!0):void 0}),O(d,function(d){return u(b,yc(d))})}function se(b,d){if(!b||!b.length)return[];var h=Pc(b);return null==d?h:u(h,function(b){return g(d,p,b)})}function te(b){return b=f(b),b.__chain__=!0,b}function gc(b,d){return d(b)}function sf(){return this}
function ue(b,d){return"function"==typeof d&&D(b)?k(b,d):Pa(b,$a(d))}function ve(b,d){var h;if("function"==typeof d&&D(b)){for(h=b.length;h--&&!1!==d(b[h],h,b););h=b}else h=Qc(b,$a(d));return h}function we(b,d){return(D(b)?u:Jd)(b,A(d,3))}function xe(b,d){var h=-1,a=Rc(b),f=a.length,c=f-1;for(d=pb(G(d),0,f);++h<d;){var f=zc(h,c),e=a[f];a[f]=a[h];a[h]=e}return a.length=d,a}function ye(b,d,h){return d=h?p:d,d=b&&null==d?b.length:d,Sa(b,128,p,p,p,p,d)}function ze(b,d){var h;if("function"!=typeof d)throw new ta("Expected a function");
return b=G(b),function(){return 0<--b&&(h=d.apply(this,arguments)),1>=b&&(d=p),h}}function Ae(b,d,h){return d=h?p:d,b=Sa(b,8,p,p,p,p,p,d),b.placeholder=Ae.placeholder,b}function Be(b,d,h){return d=h?p:d,b=Sa(b,16,p,p,p,p,p,d),b.placeholder=Be.placeholder,b}function Ce(b,d,h){function a(){q&&Lb(q);g&&Lb(g);u=0;l=g=v=q=r=p}function f(d,h){h&&Lb(h);g=q=r=p;d&&(u=Mb(),k=b.apply(v,l),q||g||(l=v=p))}function c(){var b=d-(Mb()-n);0>=b||b>d?f(r,g):q=Rb(c,b)}function e(){f(C,q)}function m(){if(l=arguments,
n=Mb(),v=this,r=C&&(q||!t),!1===w)var h=t&&!q;else{u||g||t||(u=n);var a=w-(n-u),f=(0>=a||a>w)&&(t||g);f?(g&&(g=Lb(g)),u=n,k=b.apply(v,l)):g||(g=Rb(e,a))}return f&&q?q=Lb(q):q||d===w||(q=Rb(c,d)),h&&(f=!0,k=b.apply(v,l)),!f||q||g||(l=v=p),k}var l,g,k,n,v,q,r,u=0,t=!1,w=!1,C=!0;if("function"!=typeof b)throw new ta("Expected a function");return d=ga(d)||0,V(h)&&(t=!!h.leading,w="maxWait"in h&&fa(ga(h.maxWait)||0,d),C="trailing"in h?!!h.trailing:C),m.cancel=a,m.flush=function(){return(q&&r||g&&C)&&(k=
b.apply(v,l)),a(),k},m}function Sc(b,d){if("function"!=typeof b||d&&"function"!=typeof d)throw new ta("Expected a function");var h=function(){var a=arguments,f=d?d.apply(this,a):a[0],c=h.cache;return c.has(f)?c.get(f):(a=b.apply(this,a),h.cache=c.set(f,a),a)};return h.cache=new Sc.Cache,h}function z(b,d){if("function"!=typeof b)throw new ta("Expected a function");return d=fa(d===p?b.length-1:G(d),0),function(){for(var h=arguments,a=-1,f=fa(h.length-d,0),c=Array(f);++a<f;)c[a]=h[d+a];switch(d){case 0:return b.call(this,
c);case 1:return b.call(this,h[0],c);case 2:return b.call(this,h[0],h[1],c)}f=Array(d+1);for(a=-1;++a<d;)f[a]=h[a];return f[d]=c,g(b,this,f)}}function Oa(b,d){return b===d||b!==b&&d!==d}function Tc(b,d){return b>d}function cb(b){return ca(b)&&Y.call(b,"callee")&&(!De.call(b,"callee")||"[object Arguments]"==pa.call(b))}function wa(b){return null!=b&&!("function"==typeof b&&va(b))&&Kb(tf(b))}function ca(b){return ba(b)&&wa(b)}function Uc(b){return ba(b)?"[object Error]"==pa.call(b)||"string"==typeof b.message&&
"string"==typeof b.name:!1}function va(b){return b=V(b)?pa.call(b):"","[object Function]"==b||"[object GeneratorFunction]"==b}function Ee(b){return"number"==typeof b&&b==G(b)}function Kb(b){return"number"==typeof b&&-1<b&&0==b%1&&9007199254740991>=b}function V(b){var d=typeof b;return!!b&&("object"==d||"function"==d)}function ba(b){return!!b&&"object"==typeof b}function ke(b){return null==b?!1:va(b)?Fe.test(Ya.call(b)):ba(b)&&(za(b)?Fe:Fa).test(b)}function Ge(b){return"number"==typeof b||ba(b)&&"[object Number]"==
pa.call(b)}function xc(b){return!ba(b)||"[object Object]"!=pa.call(b)||za(b)?!1:(b=Tb(b),null===b?!0:(b=b.constructor,"function"==typeof b&&b instanceof b&&Ya.call(b)==uf))}function He(b){return V(b)&&"[object RegExp]"==pa.call(b)}function fb(b){return"string"==typeof b||!D(b)&&ba(b)&&"[object String]"==pa.call(b)}function Ie(b){return"symbol"==typeof b||ba(b)&&"[object Symbol]"==pa.call(b)}function rb(b){return ba(b)&&Kb(b.length)&&!!P[pa.call(b)]}function Vc(b,d){return d>b}function Rc(b){if(!b)return[];
if(wa(b))return fb(b)?b.match(ia):na(b);if(gb&&b[gb])return kb(b[gb]());var d=Da(b);return("[object Map]"==d?Wa:"[object Set]"==d?lb:hc)(b)}function G(b){if(!b)return 0===b?b:0;if(b=ga(b),b===wb||b===-wb)return 1.7976931348623157E308*(0>b?-1:1);var d=b%1;return b===b?d?b-d:b:0}function Je(b){return b?pb(G(b),0,4294967295):0}function ga(b){if(V(b)&&(b=va(b.valueOf)?b.valueOf():b,b=V(b)?b+"":b),"string"!=typeof b)return 0===b?b:+b;b=b.replace(Nb,"");var d=Wc.test(b);return d||Xc.test(b)?Ja(b.slice(2),
d?2:8):Ka.test(b)?Yc:+b}function Ld(b){return Eb(b,ua(b))}function K(b){if("string"==typeof b)return b;if(null==b)return"";if(Ie(b))return Ta?vf.call(b):"";var d=b+"";return"0"==d&&1/b==-wb?"-0":d}function Fb(b,d,h){return b=null==b?p:sc(b,d),b===p?h:b}function Ke(b,d){return le(b,d,tc)}function Kd(b,d){return le(b,d,ef)}function ja(b){var d=Kc(b);if(!d&&!wa(b))return wf(Object(b));var h,a=me(b),f=!!a,a=a||[],c=a.length;for(h in b)!tc(b,h)||f&&("length"==h||Aa(h,c))||d&&"constructor"==h||a.push(h);
return a}function ua(b){for(var d=-1,h=Kc(b),a=Id(b),f=a.length,c=me(b),e=!!c,c=c||[],m=c.length;++d<f;){var l=a[d];e&&("length"==l||Aa(l,m))||"constructor"==l&&(h||!Y.call(b,l))||c.push(l)}return c}function je(b){return I(b,ja(b))}function hc(b){return b?T(b,ja(b)):[]}function Zc(b){return Le(K(b).toLowerCase())}function be(b){return(b=K(b))&&b.replace($c,jb).replace(ad,"")}function fe(b,d){b=K(b);d=G(d);var h="";if(!b||1>d||9007199254740991<d)return h;do d%2&&(h+=b),d=Vb(d/2),b+=b;while(d);return h}
function ae(b,d,h){return b=K(b),d=h?p:d,d===p&&(d=bd.test(b)?cd:dd),b.match(d)||[]}function ed(b){return function(){return b}}function Ba(b){return b}function Jc(b){return Ed("function"==typeof b?b:Ca(b,!0))}function fd(b,d,h){var a=ja(d),f=Sb(d,a);null!=h||V(d)&&(f.length||!a.length)||(h=d,d=b,b=this,f=Sb(d,ja(d)));var c=V(h)&&"chain"in h?h.chain:!0,e=va(b);return k(f,function(h){var a=d[h];b[h]=a;e&&(b.prototype[h]=function(){var d=this.__chain__;if(c||d){var h=b(this.__wrapped__);return(h.__actions__=
na(this.__actions__)).push({func:a,args:arguments,thisArg:b}),h.__chain__=d,h}return a.apply(b,r([this.value()],arguments))})}),b}function gd(){}function Hd(b){return Qa(b)?yc(b):kf(b)}function Me(b){return b&&b.length?Z(b,Ba):0}R=R?Q.defaults({},R,Q.pick(v,ha)):v;var xf=R.Date,yf=R.Error,vb=R.Math,hd=R.RegExp,ta=R.TypeError,ic=R.Array.prototype,ob=R.Object.prototype,Ya=R.Function.prototype.toString,Y=ob.hasOwnProperty,zf=0,uf=Ya.call(Object),pa=ob.toString,Af=v._,Fe=hd("^"+Ya.call(Y).replace(xb,
"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ne=yb?R.Buffer:p,Oe=R.Reflect,Ta=R.Symbol,Yb=R.Uint8Array,Lb=R.clearTimeout,Pe=Oe?Oe.enumerate:p,Tb=Object.getPrototypeOf,Bf=Object.getOwnPropertySymbols,gb="symbol"==typeof(gb=Ta&&Ta.iterator)?gb:p,bf=Object.create,De=ob.propertyIsEnumerable,Rb=R.setTimeout,Qb=ic.splice,cc=vb.ceil,Vb=vb.floor,Cf=R.isFinite,Df=ic.join,wf=Object.keys,fa=vb.max,xa=vb.min,Ef=R.parseInt,Rd=vb.random,rf=ic.reverse,La=dc(R,"Map"),hb=
dc(R,"Set"),zb=dc(R,"WeakMap"),Ab=dc(Object,"create"),jc=zb&&new zb,Ff=La?Ya.call(La):"",Gf=hb?Ya.call(hb):"",Hf=zb?Ya.call(zb):"",Qe=Ta?Ta.prototype:p,Ic=Ta?Qe.valueOf:p,vf=Ta?Qe.toString:p,Jb={};f.templateSettings={escape:id,evaluate:jd,interpolate:ib,variable:"",imports:{_:f}};var Pa=Yd(Ea),Qc=Yd(rc,!0),qc=Zd(),Dd=Zd(!0);Pe&&!De.call({valueOf:1},"valueOf")&&(Id=function(b){return kb(Pe(b))});var ie=jc?function(b,d){return jc.set(b,d),b}:Ba,mf=hb&&2===(new hb([1,2])).size?function(b){return new hb(b)}:
gd,Ec=jc?function(b){return jc.get(b)}:gd,tf=yc("length"),nf=Bf||function(){return[]};(La&&"[object Map]"!=Da(new La)||hb&&"[object Set]"!=Da(new hb)||zb&&"[object WeakMap]"!=Da(new zb))&&(Da=function(b){var d=pa.call(b);if(b="[object Object]"==d?b.constructor:null,b="function"==typeof b?Ya.call(b):"")switch(b){case Ff:return"[object Map]";case Gf:return"[object Set]";case Hf:return"[object WeakMap]"}return d});var he=function(){var b=0,d=0;return function(h,a){var f=Mb(),c=16-(f-d);if(d=f,0<c){if(150<=
++b)return h}else b=0;return ie(h,a)}}(),If=z(function(b,d){D(b)||(b=null==b?[]:[Object(b)]);d=U(d,1);for(var h=b,a=d,f=-1,c=h.length,e=-1,m=a.length,l=Array(c+m);++f<c;)l[f]=h[f];for(;++e<m;)l[f++]=a[e];return l}),Jf=z(function(b,d){return ca(b)?bb(b,U(d,1,!0)):[]}),Kf=z(function(b,d){var h=oa(d);return ca(h)&&(h=p),ca(b)?bb(b,U(d,1,!0),A(h)):[]}),Lf=z(function(b,d){var h=oa(d);return ca(h)&&(h=p),ca(b)?bb(b,U(d,1,!0),p,h):[]}),Mf=z(function(b){var d=u(b,pc);return d.length&&d[0]===b[0]?uc(d):[]}),
Nf=z(function(b){var d=oa(b),h=u(b,pc);return d===oa(h)?d=p:h.pop(),h.length&&h[0]===b[0]?uc(h,A(d)):[]}),Of=z(function(b){var d=oa(b),h=u(b,pc);return d===oa(h)?d=p:h.pop(),h.length&&h[0]===b[0]?uc(h,p,d):[]}),Pf=z(re),Qf=z(function(b,d){d=u(U(d,1),String);var h=oc(b,d);return Qd(b,d.sort(ma)),h}),Rf=z(function(b){return eb(U(b,1,!0))}),Sf=z(function(b){var d=oa(b);return ca(d)&&(d=p),eb(U(b,1,!0),A(d))}),Tf=z(function(b){var d=oa(b);return ca(d)&&(d=p),eb(U(b,1,!0),p,d)}),Uf=z(function(b,d){return ca(b)?
bb(b,d):[]}),Vf=z(function(b){return Cc(q(b,ca))}),Wf=z(function(b){var d=oa(b);return ca(d)&&(d=p),Cc(q(b,ca),A(d))}),Xf=z(function(b){var d=oa(b);return ca(d)&&(d=p),Cc(q(b,ca),p,d)}),Yf=z(Pc),Zf=z(function(b){var d=b.length,d=1<d?b[d-1]:p,d="function"==typeof d?(b.pop(),d):p;return se(b,d)}),$f=z(function(b){b=U(b,1);var d=b.length,h=d?b[0]:0,a=this.__wrapped__,f=function(d){return oc(d,b)};return 1>=d&&!this.__actions__.length&&a instanceof F&&Aa(h)?(a=a.slice(h,+h+(d?1:0)),a.__actions__.push({func:gc,
args:[f],thisArg:p}),(new sa(a,this.__chain__)).thru(function(b){return d&&!b.length&&b.push(p),b})):this.thru(f)}),ag=Zb(function(b,d,h){Y.call(b,h)?++b[h]:b[h]=1}),bg=Zb(function(b,d,h){Y.call(b,h)?b[h].push(d):b[h]=[d]}),cg=z(function(b,d,h){var a=-1,f="function"==typeof d,c=Qa(d),e=wa(b)?Array(b.length):[];return Pa(b,function(b){var m=f?d:c&&null!=b?b[d]:p;e[++a]=m?g(m,b,h):Gb(b,d,h)}),e}),dg=Zb(function(b,d,h){b[h]=d}),eg=Zb(function(b,d,h){b[h?0:1].push(d)},function(){return[[],[]]}),fg=z(function(b,
d){if(null==b)return[];var h=d.length;return 1<h&&Ia(b,d[0],d[1])?d=[]:2<h&&Ia(d[0],d[1],d[2])&&(d.length=1),Md(b,U(d,1),[])}),Mb=xf.now,kd=z(function(b,d,h){var a=1;if(h.length)var f=Ha(h,ub(kd)),a=32|a;return Sa(b,a,d,h,f)}),Re=z(function(b,d,h){var a=3;if(h.length)var f=Ha(h,ub(Re)),a=32|a;return Sa(d,a,b,h,f)}),gg=z(function(b,d){return Bd(b,1,d)}),hg=z(function(b,d,h){return Bd(b,ga(d)||0,h)}),ig=z(function(b,d){d=u(U(d,1),A());var h=d.length;return z(function(a){for(var f=-1,c=xa(a.length,h);++f<
c;)a[f]=d[f].call(this,a[f]);return g(b,this,a)})}),ld=z(function(b,d){var h=Ha(d,ub(ld));return Sa(b,32,p,d,h)}),Se=z(function(b,d){var h=Ha(d,ub(Se));return Sa(b,64,p,d,h)}),jg=z(function(b,d){return Sa(b,256,p,p,p,U(d,1))}),D=Array.isArray,zd=Ne?function(b){return b instanceof Ne}:ed(!1),kg=sb(function(b,d){Eb(d,ja(d),b)}),Te=sb(function(b,d){Eb(d,ua(d),b)}),Ob=sb(function(b,d,h,a){Dc(d,ua(d),b,a)}),lg=sb(function(b,d,h,a){Dc(d,ja(d),b,a)}),mg=z(function(b,d){return oc(b,U(d,1))}),ng=z(function(b){return b.push(p,
Na),g(Ob,p,b)}),og=z(function(b){return b.push(p,ne),g(Ue,p,b)}),pg=ee(function(b,d,h){b[d]=h},ed(Ba)),qg=ee(function(b,d,h){Y.call(b,d)?b[d].push(h):b[d]=[h]},A),rg=z(Gb),sg=sb(function(b,d,h){Ub(b,d,h)}),Ue=sb(function(b,d,h,a){Ub(b,d,h,a)}),tg=z(function(b,d){return null==b?{}:(d=u(U(d,1),String),Nd(b,bb(ua(b),d)))}),ug=z(function(b,d){return null==b?{}:Nd(b,U(d,1))}),vg=tb(function(b,d,h){return d=d.toLowerCase(),b+(h?Zc(d):d)}),wg=tb(function(b,d,h){return b+(h?"-":"")+d.toLowerCase()}),xg=tb(function(b,
d,h){return b+(h?" ":"")+d.toLowerCase()}),yg=$d("toLowerCase"),Le=$d("toUpperCase"),zg=tb(function(b,d,h){return b+(h?"_":"")+d.toLowerCase()}),Ag=tb(function(b,d,h){return b+(h?" ":"")+Zc(d)}),Bg=tb(function(b,d,h){return b+(h?" ":"")+d.toUpperCase()}),Ve=z(function(b,d){try{return g(b,p,d)}catch(h){return Uc(h)?h:new yf(h)}}),Cg=z(function(b,d){return k(U(d,1),function(d){b[d]=kd(b[d],b)}),b}),Dg=de(),Eg=de(!0),Fg=z(function(b,d){return function(a){return Gb(a,b,d)}}),Gg=z(function(b,d){return function(a){return Gb(b,
a,d)}}),Hg=Gc(u),Ig=Gc(n),Jg=Gc(H),Kg=ge(),Lg=ge(!0),Mg=Hc("ceil"),Ng=Hc("floor"),Og=Hc("round");return f.prototype=X.prototype,sa.prototype=qb(X.prototype),sa.prototype.constructor=sa,F.prototype=qb(X.prototype),F.prototype.constructor=F,mc.prototype=Ab?Ab(null):ob,W.prototype.clear=function(){this.__data__={hash:new mc,map:La?new La:[],string:new mc}},W.prototype["delete"]=function(b){var d=this.__data__;return nb(b)?(d="string"==typeof b?d.string:d.hash,(Ab?d[b]!==p:Y.call(d,b))&&delete d[b]):
La?d.map["delete"](b):ya(d.map,b)},W.prototype.get=function(b){var d=this.__data__;return nb(b)?(d="string"==typeof b?d.string:d.hash,Ab?(b=d[b],b="__lodash_hash_undefined__"===b?p:b):b=Y.call(d,b)?d[b]:p,b):La?d.map.get(b):Ga(d.map,b)},W.prototype.has=function(b){var d=this.__data__;return nb(b)?(d="string"==typeof b?d.string:d.hash,b=Ab?d[b]!==p:Y.call(d,b)):b=La?d.map.has(b):-1<ra(d.map,b),b},W.prototype.set=function(b,d){var a=this.__data__;return nb(b)?("string"==typeof b?a.string:a.hash)[b]=
Ab&&d===p?"__lodash_hash_undefined__":d:La?a.map.set(b,d):Va(a.map,b,d),this},ka.prototype.push=function(b){var d=this.__data__;nb(b)?(d=d.__data__,("string"==typeof b?d.string:d.hash)[b]="__lodash_hash_undefined__"):d.set(b,"__lodash_hash_undefined__")},aa.prototype.clear=function(){this.__data__={array:[],map:null}},aa.prototype["delete"]=function(b){var d=this.__data__,a=d.array;return a?ya(a,b):d.map["delete"](b)},aa.prototype.get=function(b){var d=this.__data__,a=d.array;return a?Ga(a,b):d.map.get(b)},
aa.prototype.has=function(b){var d=this.__data__,a=d.array;return a?-1<ra(a,b):d.map.has(b)},aa.prototype.set=function(b,d){var a=this.__data__,f=a.array;return f&&(199>f.length?Va(f,b,d):(a.array=null,a.map=new W(f))),(a=a.map)&&a.set(b,d),this},Sc.Cache=W,f.after=function(b,d){if("function"!=typeof d)throw new ta("Expected a function");return b=G(b),function(){return 1>--b?d.apply(this,arguments):void 0}},f.ary=ye,f.assign=kg,f.assignIn=Te,f.assignInWith=Ob,f.assignWith=lg,f.at=mg,f.before=ze,f.bind=
kd,f.bindAll=Cg,f.bindKey=Re,f.castArray=function(){if(!arguments.length)return[];var b=arguments[0];return D(b)?b:[b]},f.chain=te,f.chunk=function(b,d){d=fa(G(d),0);var a=b?b.length:0;if(!a||1>d)return[];for(var f=0,c=-1,e=Array(cc(a/d));a>f;)e[++c]=Ra(b,f,f+=d);return e},f.compact=function(b){for(var d=-1,a=b?b.length:0,f=-1,c=[];++d<a;){var e=b[d];e&&(c[++f]=e)}return c},f.concat=If,f.cond=function(b){var d=b?b.length:0,a=A();return b=d?u(b,function(b){if("function"!=typeof b[1])throw new ta("Expected a function");
return[a(b[0]),b[1]]}):[],z(function(a){for(var h=-1;++h<d;){var f=b[h];if(g(f[0],this,a))return g(f[1],this,a)}})},f.conforms=function(b){return af(Ca(b,!0))},f.constant=ed,f.countBy=ag,f.create=function(b,d){var a=qb(b);return d?xd(a,d):a},f.curry=Ae,f.curryRight=Be,f.debounce=Ce,f.defaults=ng,f.defaultsDeep=og,f.defer=gg,f.delay=hg,f.difference=Jf,f.differenceBy=Kf,f.differenceWith=Lf,f.drop=oe,f.dropRight=pe,f.dropRightWhile=function(b,d){return b&&b.length?Xb(b,A(d,3),!0,!0):[]},f.dropWhile=
function(b,d){return b&&b.length?Xb(b,A(d,3),!0):[]},f.fill=function(b,d,a,f){var c=b?b.length:0;if(!c)return[];a&&"number"!=typeof a&&Ia(b,d,a)&&(a=0,f=c);c=b.length;a=G(a);0>a&&(a=-a>c?0:c+a);f=f===p||f>c?c:G(f);0>f&&(f+=c);for(f=a>f?0:Je(f);f>a;)b[a++]=d;return b},f.filter=function(b,d){return(D(b)?q:Cd)(b,A(d,3))},f.flatMap=function(b,d){return U(we(b,d),1)},f.flatten=function(b){return b&&b.length?U(b,1):[]},f.flattenDeep=function(b){return b&&b.length?U(b,wb):[]},f.flattenDepth=function(b,d){return b&&
b.length?(d=d===p?1:G(d),U(b,d)):[]},f.flip=function(b){return Sa(b,512)},f.flow=Dg,f.flowRight=Eg,f.fromPairs=function(b){for(var d=-1,a=b?b.length:0,f={};++d<a;){var c=b[d];f[c[0]]=c[1]}return f},f.functions=function(b){return null==b?[]:Sb(b,ja(b))},f.functionsIn=function(b){return null==b?[]:Sb(b,ua(b))},f.groupBy=bg,f.initial=function(b){return pe(b,1)},f.intersection=Mf,f.intersectionBy=Nf,f.intersectionWith=Of,f.invert=pg,f.invertBy=qg,f.invokeMap=cg,f.iteratee=Jc,f.keyBy=dg,f.keys=ja,f.keysIn=
ua,f.map=we,f.mapKeys=function(b,d){var a={};return d=A(d,3),Ea(b,function(b,f,c){a[d(b,f,c)]=b}),a},f.mapValues=function(b,d){var a={};return d=A(d,3),Ea(b,function(b,f,c){a[f]=d(b,f,c)}),a},f.matches=function(b){return Gd(Ca(b,!0))},f.matchesProperty=function(b,d){return Fd(b,Ca(d,!0))},f.memoize=Sc,f.merge=sg,f.mergeWith=Ue,f.method=Fg,f.methodOf=Gg,f.mixin=fd,f.negate=function(b){if("function"!=typeof b)throw new ta("Expected a function");return function(){return!b.apply(this,arguments)}},f.nthArg=
function(b){return b=G(b),function(){return arguments[b]}},f.omit=tg,f.omitBy=function(b,d){return d=A(d),Od(b,function(b,a){return!d(b,a)})},f.once=function(b){return ze(2,b)},f.orderBy=function(b,d,a,f){return null==b?[]:(D(d)||(d=null==d?[]:[d]),a=f?p:a,D(a)||(a=null==a?[]:[a]),Md(b,d,a))},f.over=Hg,f.overArgs=ig,f.overEvery=Ig,f.overSome=Jg,f.partial=ld,f.partialRight=Se,f.partition=eg,f.pick=ug,f.pickBy=function(b,d){return null==b?{}:Od(b,A(d))},f.property=Hd,f.propertyOf=function(b){return function(d){return null==
b?p:sc(b,d)}},f.pull=Pf,f.pullAll=re,f.pullAllBy=function(b,d,a){return b&&b.length&&d&&d.length?Pd(b,d,A(a)):b},f.pullAt=Qf,f.range=Kg,f.rangeRight=Lg,f.rearg=jg,f.reject=function(b,d){var a=D(b)?q:Cd;return d=A(d,3),a(b,function(b,a,h){return!d(b,a,h)})},f.remove=function(b,d){var a=[];if(!b||!b.length)return a;var f=-1,c=[],e=b.length;for(d=A(d,3);++f<e;){var m=b[f];d(m,f,b)&&(a.push(m),c.push(f))}return Qd(b,c),a},f.rest=z,f.reverse=Oc,f.sampleSize=xe,f.set=function(b,d,a){return null==b?b:Ac(b,
d,a)},f.setWith=function(b,d,a,f){return f="function"==typeof f?f:p,null==b?b:Ac(b,d,a,f)},f.shuffle=function(b){return xe(b,4294967295)},f.slice=function(b,d,a){var f=b?b.length:0;return f?(a&&"number"!=typeof a&&Ia(b,d,a)?(d=0,a=f):(d=null==d?0:G(d),a=a===p?f:G(a)),Ra(b,d,a)):[]},f.sortBy=fg,f.sortedUniq=function(b){return b&&b.length?Sd(b):[]},f.sortedUniqBy=function(b,d){return b&&b.length?Sd(b,A(d)):[]},f.split=function(b,d,a){return K(b).split(d,a)},f.spread=function(b,d){if("function"!=typeof b)throw new ta("Expected a function");
return d=d===p?0:fa(G(d),0),z(function(a){var f=a[d];return a=a.slice(0,d),f&&r(a,f),g(b,this,a)})},f.tail=function(b){return oe(b,1)},f.take=function(b,d,a){return b&&b.length?(d=a||d===p?1:G(d),Ra(b,0,0>d?0:d)):[]},f.takeRight=function(b,d,a){var f=b?b.length:0;return f?(d=a||d===p?1:G(d),d=f-d,Ra(b,0>d?0:d,f)):[]},f.takeRightWhile=function(b,d){return b&&b.length?Xb(b,A(d,3),!1,!0):[]},f.takeWhile=function(b,d){return b&&b.length?Xb(b,A(d,3)):[]},f.tap=function(b,d){return d(b),b},f.throttle=function(b,
d,a){var f=!0,c=!0;if("function"!=typeof b)throw new ta("Expected a function");return V(a)&&(f="leading"in a?!!a.leading:f,c="trailing"in a?!!a.trailing:c),Ce(b,d,{leading:f,maxWait:d,trailing:c})},f.thru=gc,f.toArray=Rc,f.toPairs=je,f.toPairsIn=function(b){return I(b,ua(b))},f.toPath=function(b){return D(b)?u(b,String):yd(b)},f.toPlainObject=Ld,f.transform=function(b,d,a){var f=D(b)||rb(b);if(d=A(d,4),null==a)if(f||V(b)){var c=b.constructor;a=f?D(b)?new c:[]:va(c)?qb(Tb(b)):{}}else a={};return(f?
k:Ea)(b,function(b,f,c){return d(a,b,f,c)}),a},f.unary=function(b){return ye(b,1)},f.union=Rf,f.unionBy=Sf,f.unionWith=Tf,f.uniq=function(b){return b&&b.length?eb(b):[]},f.uniqBy=function(b,d){return b&&b.length?eb(b,A(d)):[]},f.uniqWith=function(b,d){return b&&b.length?eb(b,p,d):[]},f.unset=function(b,d){var a;if(null==b)a=!0;else{a=b;var f=d,f=Qa(f,a)?[f+""]:ab(f);a=Hb(a,f);f=oa(f);a=null!=a&&Ke(a,f)?delete a[f]:!0}return a},f.unzip=Pc,f.unzipWith=se,f.values=hc,f.valuesIn=function(b){return null==
b?[]:T(b,ua(b))},f.without=Uf,f.words=ae,f.wrap=function(b,d){return d=null==d?Ba:d,ld(d,b)},f.xor=Vf,f.xorBy=Wf,f.xorWith=Xf,f.zip=Yf,f.zipObject=function(b,d){return Ud(b||[],d||[],Ua)},f.zipObjectDeep=function(b,d){return Ud(b||[],d||[],Ac)},f.zipWith=Zf,f.extend=Te,f.extendWith=Ob,fd(f,f),f.add=function(b,d){var a;return b===p&&d===p?0:(b!==p&&(a=b),d!==p&&(a=a===p?d:a+d),a)},f.attempt=Ve,f.camelCase=vg,f.capitalize=Zc,f.ceil=Mg,f.clamp=function(b,d,a){return a===p&&(a=d,d=p),a!==p&&(a=ga(a),
a=a===a?a:0),d!==p&&(d=ga(d),d=d===d?d:0),pb(ga(b),d,a)},f.clone=function(b){return Ca(b)},f.cloneDeep=function(b){return Ca(b,!0)},f.cloneDeepWith=function(b,d){return Ca(b,!0,d)},f.cloneWith=function(b,d){return Ca(b,!1,d)},f.deburr=be,f.endsWith=function(b,d,a){b=K(b);d="string"==typeof d?d:d+"";var f=b.length;return a=a===p?f:pb(G(a),0,f),a-=d.length,0<=a&&b.indexOf(d,a)==a},f.eq=Oa,f.escape=function(b){return(b=K(b))&&md.test(b)?b.replace(kc,Cb):b},f.escapeRegExp=function(b){return(b=K(b))&&
lc.test(b)?b.replace(xb,"\\$&"):b},f.every=function(b,d,a){var f=D(b)?n:cf;return a&&Ia(b,d,a)&&(d=p),f(b,A(d,3))},f.find=function(b,d){if(d=A(d,3),D(b)){var a=y(b,d);return-1<a?b[a]:p}return x(b,d,Pa)},f.findIndex=function(b,d){return b&&b.length?y(b,A(d,3)):-1},f.findKey=function(b,d){return x(b,A(d,3),Ea,!0)},f.findLast=function(b,d){if(d=A(d,3),D(b)){var a=y(b,d,!0);return-1<a?b[a]:p}return x(b,d,Qc)},f.findLastIndex=function(b,d){return b&&b.length?y(b,A(d,3),!0):-1},f.findLastKey=function(b,
d){return x(b,A(d,3),rc,!0)},f.floor=Ng,f.forEach=ue,f.forEachRight=ve,f.forIn=function(b,d){return null==b?b:qc(b,$a(d),ua)},f.forInRight=function(b,d){return null==b?b:Dd(b,$a(d),ua)},f.forOwn=function(b,d){return b&&Ea(b,$a(d))},f.forOwnRight=function(b,d){return b&&rc(b,$a(d))},f.get=Fb,f.gt=Tc,f.gte=function(b,d){return b>=d},f.has=Ke,f.hasIn=Kd,f.head=qe,f.identity=Ba,f.includes=function(b,d,a,f){return b=wa(b)?b:hc(b),a=a&&!f?G(a):0,f=b.length,0>a&&(a=fa(f+a,0)),fb(b)?f>=a&&-1<b.indexOf(d,
a):!!f&&-1<B(b,d,a)},f.indexOf=function(b,d,a){var f=b?b.length:0;return f?(a=G(a),0>a&&(a=fa(f+a,0)),B(b,d,a)):-1},f.inRange=function(b,d,a){return d=ga(d)||0,a===p?(a=d,d=0):a=ga(a)||0,b=ga(b),b>=xa(d,a)&&b<fa(d,a)},f.invoke=rg,f.isArguments=cb,f.isArray=D,f.isArrayBuffer=function(b){return ba(b)&&"[object ArrayBuffer]"==pa.call(b)},f.isArrayLike=wa,f.isArrayLikeObject=ca,f.isBoolean=function(b){return!0===b||!1===b||ba(b)&&"[object Boolean]"==pa.call(b)},f.isBuffer=zd,f.isDate=function(b){return ba(b)&&
"[object Date]"==pa.call(b)},f.isElement=function(b){return!!b&&1===b.nodeType&&ba(b)&&!xc(b)},f.isEmpty=function(b){if(wa(b)&&(D(b)||fb(b)||va(b.splice)||cb(b)))return!b.length;for(var d in b)if(Y.call(b,d))return!1;return!0},f.isEqual=function(b,d){return db(b,d)},f.isEqualWith=function(b,d,a){var f=(a="function"==typeof a?a:p)?a(b,d):p;return f===p?db(b,d,a):!!f},f.isError=Uc,f.isFinite=function(b){return"number"==typeof b&&Cf(b)},f.isFunction=va,f.isInteger=Ee,f.isLength=Kb,f.isMap=function(b){return ba(b)&&
"[object Map]"==Da(b)},f.isMatch=function(b,d){return b===d||vc(b,d,wc(d))},f.isMatchWith=function(b,d,a){return a="function"==typeof a?a:p,vc(b,d,wc(d),a)},f.isNaN=function(b){return Ge(b)&&b!=+b},f.isNative=ke,f.isNil=function(b){return null==b},f.isNull=function(b){return null===b},f.isNumber=Ge,f.isObject=V,f.isObjectLike=ba,f.isPlainObject=xc,f.isRegExp=He,f.isSafeInteger=function(b){return Ee(b)&&-9007199254740991<=b&&9007199254740991>=b},f.isSet=function(b){return ba(b)&&"[object Set]"==Da(b)},
f.isString=fb,f.isSymbol=Ie,f.isTypedArray=rb,f.isUndefined=function(b){return b===p},f.isWeakMap=function(b){return ba(b)&&"[object WeakMap]"==Da(b)},f.isWeakSet=function(b){return ba(b)&&"[object WeakSet]"==pa.call(b)},f.join=function(b,d){return b?Df.call(b,d):""},f.kebabCase=wg,f.last=oa,f.lastIndexOf=function(b,d,a){var f=b?b.length:0;if(!f)return-1;var c=f;if(a!==p&&(c=G(a),c=(0>c?fa(f+c,0):xa(c,f-1))+1),d!==d)return la(b,c,!0);for(;c--;)if(b[c]===d)return c;return-1},f.lowerCase=xg,f.lowerFirst=
yg,f.lt=Vc,f.lte=function(b,d){return d>=b},f.max=function(b){return b&&b.length?E(b,Ba,Tc):p},f.maxBy=function(b,d){return b&&b.length?E(b,A(d),Tc):p},f.mean=function(b){return Me(b)/(b?b.length:0)},f.min=function(b){return b&&b.length?E(b,Ba,Vc):p},f.minBy=function(b,d){return b&&b.length?E(b,A(d),Vc):p},f.noConflict=function(){return v._===this&&(v._=Af),this},f.noop=gd,f.now=Mb,f.pad=function(b,d,a){b=K(b);d=G(d);var f=Za(b);return d&&d>f?(f=(d-f)/2,d=Vb(f),f=cc(f),bc("",d,a)+b+bc("",f,a)):b},
f.padEnd=function(b,d,a){return b=K(b),b+bc(b,d,a)},f.padStart=function(b,d,a){return b=K(b),bc(b,d,a)+b},f.parseInt=function(b,d,a){return a||null==d?d=0:d&&(d=+d),b=K(b).replace(Nb,""),Ef(b,d||(nd.test(b)?16:10))},f.random=function(b,d,a){if(a&&"boolean"!=typeof a&&Ia(b,d,a)&&(d=a=p),a===p&&("boolean"==typeof d?(a=d,d=p):"boolean"==typeof b&&(a=b,b=p)),b===p&&d===p?(b=0,d=1):(b=ga(b)||0,d===p?(d=b,b=0):d=ga(d)||0),b>d){var f=b;b=d;d=f}return a||b%1||d%1?(a=Rd(),xa(b+a*(d-b+Ma("1e-"+((a+"").length-
1))),d)):zc(b,d)},f.reduce=function(b,d,a){var f=D(b)?w:N,c=3>arguments.length;return f(b,A(d,4),a,c,Pa)},f.reduceRight=function(b,d,a){var f=D(b)?M:N,c=3>arguments.length;return f(b,A(d,4),a,c,Qc)},f.repeat=fe,f.replace=function(){var b=arguments,d=K(b[0]);return 3>b.length?d:d.replace(b[1],b[2])},f.result=function(b,d,a){if(Qa(d,b))f=null==b?p:b[d];else{d=ab(d);var f=Fb(b,d);b=Hb(b,d)}return f===p&&(f=a),va(f)?f.call(b):f},f.round=Og,f.runInContext=Db,f.sample=function(b){b=wa(b)?b:hc(b);var d=
b.length;return 0<d?b[zc(0,d-1)]:p},f.size=function(b){if(null==b)return 0;if(wa(b)){var d=b.length;return d&&fb(b)?Za(b):d}return ja(b).length},f.snakeCase=zg,f.some=function(b,d,a){var f=D(b)?H:lf;return a&&Ia(b,d,a)&&(d=p),f(b,A(d,3))},f.sortedIndex=function(b,d){return Wb(b,d)},f.sortedIndexBy=function(b,d,a){return Bc(b,d,A(a))},f.sortedIndexOf=function(b,d){var a=b?b.length:0;if(a){var f=Wb(b,d);if(a>f&&Oa(b[f],d))return f}return-1},f.sortedLastIndex=function(b,d){return Wb(b,d,!0)},f.sortedLastIndexBy=
function(b,d,a){return Bc(b,d,A(a),!0)},f.sortedLastIndexOf=function(b,d){if(b&&b.length){var a=Wb(b,d,!0)-1;if(Oa(b[a],d))return a}return-1},f.startCase=Ag,f.startsWith=function(b,d,a){return b=K(b),a=pb(G(a),0,b.length),b.lastIndexOf(d,a)==a},f.subtract=function(b,d){var a;return b===p&&d===p?0:(b!==p&&(a=b),d!==p&&(a=a===p?d:a-d),a)},f.sum=Me,f.sumBy=function(b,d){return b&&b.length?Z(b,A(d)):0},f.template=function(b,d,a){var c=f.templateSettings;a&&Ia(b,d,a)&&(d=p);b=K(b);d=Ob({},d,c,Na);a=Ob({},
d.imports,c.imports,Na);var e,l,g=ja(a),k=T(a,g),n=0;a=d.interpolate||Bb;var v="__p+='";a=hd((d.escape||Bb).source+"|"+a.source+"|"+(a===ib?od:Bb).source+"|"+(d.evaluate||Bb).source+"|$","g");var q="sourceURL"in d?"//# sourceURL="+d.sourceURL+"\n":"";if(b.replace(a,function(d,a,f,c,h,g){return f||(f=c),v+=b.slice(n,g).replace(pd,m),a&&(e=!0,v+="'+__e("+a+")+'"),h&&(l=!0,v+="';"+h+";\n__p+='"),f&&(v+="'+((__t=("+f+"))==null?'':__t)+'"),n=g+d.length,d}),v+="';",(d=d.variable)||(v="with(obj){"+v+"}"),
v=(l?v.replace(qd,""):v).replace(rd,"$1").replace(sd,"$1;"),v="function("+(d||"obj")+"){"+(d?"":"obj||(obj={});")+"var __t,__p=''"+(e?",__e=_.escape":"")+(l?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+v+"return __p}",d=Ve(function(){return Function(g,q+"return "+v).apply(p,k)}),d.source=v,Uc(d))throw d;return d},f.times=function(b,d){if(b=G(b),1>b||9007199254740991<b)return[];var a=4294967295,f=xa(b,4294967295);d=$a(d);b-=4294967295;for(f=O(f,d);++a<b;)d(a);return f},
f.toInteger=G,f.toLength=Je,f.toLower=function(b){return K(b).toLowerCase()},f.toNumber=ga,f.toSafeInteger=function(b){return pb(G(b),-9007199254740991,9007199254740991)},f.toString=K,f.toUpper=function(b){return K(b).toUpperCase()},f.trim=function(b,d,a){return(b=K(b))?a||d===p?b.replace(Nb,""):(d+="")?(b=b.match(ia),d=d.match(ia),b.slice(S(b,d),C(b,d)+1).join("")):b:b},f.trimEnd=function(b,d,a){return(b=K(b))?a||d===p?b.replace(td,""):(d+="")?(b=b.match(ia),b.slice(0,C(b,d.match(ia))+1).join("")):
b:b},f.trimStart=function(b,d,a){return(b=K(b))?a||d===p?b.replace(ud,""):(d+="")?(b=b.match(ia),b.slice(S(b,d.match(ia))).join("")):b:b},f.truncate=function(b,d){var a=30,f="...";if(V(d))var c="separator"in d?d.separator:c,a="length"in d?G(d.length):a,f="omission"in d?K(d.omission):f;b=K(b);var e=b.length;if(mb.test(b))var m=b.match(ia),e=m.length;if(a>=e)return b;if(e=a-Za(f),1>e)return f;if(a=m?m.slice(0,e).join(""):b.slice(0,e),c===p)return a+f;if(m&&(e+=a.length-e),He(c)){if(b.slice(e).search(c)){var l=
a;c.global||(c=hd(c.source,K(ec.exec(c))+"g"));for(c.lastIndex=0;m=c.exec(l);)var g=m.index;a=a.slice(0,g===p?e:g)}}else b.indexOf(c,e)!=e&&(c=a.lastIndexOf(c),-1<c&&(a=a.slice(0,c)));return a+f},f.unescape=function(b){return(b=K(b))&&vd.test(b)?b.replace(Pb,nc):b},f.uniqueId=function(b){var d=++zf;return K(b)+d},f.upperCase=Bg,f.upperFirst=Le,f.each=ue,f.eachRight=ve,f.first=qe,fd(f,function(){var b={};return Ea(f,function(d,a){Y.call(f.prototype,a)||(b[a]=d)}),b}(),{chain:!1}),f.VERSION="4.5.1",
k("bind bindKey curry curryRight partial partialRight".split(" "),function(b){f[b].placeholder=f}),k(["drop","take"],function(b,d){F.prototype[b]=function(a){var f=this.__filtered__;if(f&&!d)return new F(this);a=a===p?1:fa(G(a),0);var c=this.clone();return f?c.__takeCount__=xa(a,c.__takeCount__):c.__views__.push({size:xa(a,4294967295),type:b+(0>c.__dir__?"Right":"")}),c};F.prototype[b+"Right"]=function(d){return this.reverse()[b](d).reverse()}}),k(["filter","map","takeWhile"],function(b,d){var a=
d+1,f=1==a||3==a;F.prototype[b]=function(b){var d=this.clone();return d.__iteratees__.push({iteratee:A(b,3),type:a}),d.__filtered__=d.__filtered__||f,d}}),k(["head","last"],function(b,d){var a="take"+(d?"Right":"");F.prototype[b]=function(){return this[a](1).value()[0]}}),k(["initial","tail"],function(b,d){var a="drop"+(d?"":"Right");F.prototype[b]=function(){return this.__filtered__?new F(this):this[a](1)}}),F.prototype.compact=function(){return this.filter(Ba)},F.prototype.find=function(b){return this.filter(b).head()},
F.prototype.findLast=function(b){return this.reverse().find(b)},F.prototype.invokeMap=z(function(b,d){return"function"==typeof b?new F(this):this.map(function(a){return Gb(a,b,d)})}),F.prototype.reject=function(b){return b=A(b,3),this.filter(function(d){return!b(d)})},F.prototype.slice=function(b,d){b=G(b);var a=this;return a.__filtered__&&(0<b||0>d)?new F(a):(0>b?a=a.takeRight(-b):b&&(a=a.drop(b)),d!==p&&(d=G(d),a=0>d?a.dropRight(-d):a.take(d-b)),a)},F.prototype.takeRightWhile=function(b){return this.reverse().takeWhile(b).reverse()},
F.prototype.toArray=function(){return this.take(4294967295)},Ea(F.prototype,function(b,d){var a=/^(?:filter|find|map|reject)|While$/.test(d),c=/^(?:head|last)$/.test(d),e=f[c?"take"+("last"==d?"Right":""):d],m=c||/^find/.test(d);e&&(f.prototype[d]=function(){var d=this.__wrapped__,l=c?[1]:arguments,g=d instanceof F,k=l[0],v=g||D(d),n=function(b){return b=e.apply(f,r([b],l)),c&&q?b[0]:b};v&&a&&"function"==typeof k&&1!=k.length&&(g=v=!1);var q=this.__chain__,u=!!this.__actions__.length,k=m&&!q,g=g&&
!u;return!m&&v?(d=g?d:new F(this),d=b.apply(d,l),d.__actions__.push({func:gc,args:[n],thisArg:p}),new sa(d,q)):k&&g?b.apply(this,l):(d=this.thru(n),k?c?d.value()[0]:d.value():d)})}),k("pop push shift sort splice unshift".split(" "),function(b){var d=ic[b],a=/^(?:push|sort|unshift)$/.test(b)?"tap":"thru",c=/^(?:pop|shift)$/.test(b);f.prototype[b]=function(){var b=arguments;return c&&!this.__chain__?d.apply(this.value(),b):this[a](function(a){return d.apply(a,b)})}}),Ea(F.prototype,function(b,d){var a=
f[d];if(a){var c=a.name+"";(Jb[c]||(Jb[c]=[])).push({name:d,func:a})}}),Jb[$b(p,2).name]=[{name:"wrapper",func:p}],F.prototype.clone=function(){var b=new F(this.__wrapped__);return b.__actions__=na(this.__actions__),b.__dir__=this.__dir__,b.__filtered__=this.__filtered__,b.__iteratees__=na(this.__iteratees__),b.__takeCount__=this.__takeCount__,b.__views__=na(this.__views__),b},F.prototype.reverse=function(){if(this.__filtered__){var b=new F(this);b.__dir__=-1;b.__filtered__=!0}else b=this.clone(),
b.__dir__*=-1;return b},F.prototype.value=function(){var b,d=this.__wrapped__.value(),a=this.__dir__,f=D(d),c=0>a,e=f?d.length:0;b=0;for(var m=e,l=this.__views__,g=-1,k=l.length;++g<k;){var v=l[g],n=v.size;switch(v.type){case "drop":b+=n;break;case "dropRight":m-=n;break;case "take":m=xa(m,b+n);break;case "takeRight":b=fa(b,m-n)}}if(b={start:b,end:m},m=b.start,l=b.end,b=l-m,c=c?l:m-1,m=this.__iteratees__,l=m.length,g=0,k=xa(b,this.__takeCount__),!f||200>e||e==b&&k==b)return Td(d,this.__actions__);
f=[];a:for(;b--&&k>g;){c+=a;e=-1;for(v=d[c];++e<l;){var q=m[e],n=q.type,q=(0,q.iteratee)(v);if(2==n)v=q;else if(!q){if(1==n)continue a;break a}}f[g++]=v}return f},f.prototype.at=$f,f.prototype.chain=function(){return te(this)},f.prototype.commit=function(){return new sa(this.value(),this.__chain__)},f.prototype.flatMap=function(b){return this.map(b).flatten()},f.prototype.next=function(){this.__values__===p&&(this.__values__=Rc(this.value()));var b=this.__index__>=this.__values__.length,d=b?p:this.__values__[this.__index__++];
return{done:b,value:d}},f.prototype.plant=function(b){for(var d,a=this;a instanceof X;){var f=wd(a);f.__index__=0;f.__values__=p;d?c.__wrapped__=f:d=f;var c=f,a=a.__wrapped__}return c.__wrapped__=b,d},f.prototype.reverse=function(){var b=this.__wrapped__;return b instanceof F?(this.__actions__.length&&(b=new F(this)),b=b.reverse(),b.__actions__.push({func:gc,args:[Oc],thisArg:p}),new sa(b,this.__chain__)):this.thru(Oc)},f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=function(){return Td(this.__wrapped__,
this.__actions__)},gb&&(f.prototype[gb]=sf),f}var p,wb=1/0,Yc=NaN,qd=/\b__p\+='';/g,rd=/\b(__p\+=)''\+/g,sd=/(__e\(.*?\)|\b__t\))\+'';/g,Pb=/&(?:amp|lt|gt|quot|#39|#96);/g,kc=/[&<>"'`]/g,vd=RegExp(Pb.source),md=RegExp(kc.source),id=/<%-([\s\S]+?)%>/g,jd=/<%([\s\S]+?)%>/g,ib=/<%=([\s\S]+?)%>/g,Lc=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,fc=/^\w*$/,Mc=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,xb=/[\\^$.*+?()[\]{}|]/g,lc=RegExp(xb.source),Nb=/^\s+|\s+$/g,ud=/^\s+/,
td=/\s+$/,Nc=/\\(\\)?/g,od=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ec=/\w*$/,nd=/^0x/i,Ka=/^[-+]0x[0-9a-f]+$/i,Wc=/^0b[01]+$/i,Fa=/^\[object .+?Constructor\]$/,Xc=/^0o[0-7]+$/i,Na=/^(?:0|[1-9]\d*)$/,$c=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Bb=/($^)/,pd=/['\n\r\u2028\u2029\\]/g,ad=/[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]/g,ia=/\ud83c[\udffb-\udfff](?=\ud83c[\udffb-\udfff])|(?:[^\ud800-\udfff][\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]?|[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?)*/g,
mb=/[\u200d\ud800-\udfff\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ufe0e\ufe0f]/,dd=/[a-zA-Z0-9]+/g,cd=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2018\u2019\u201c\u201d \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2018\u2019\u201c\u201d \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2018\u2019\u201c\u201d \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2018\u2019\u201c\u201d \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2018\u2019\u201c\u201d \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+|[A-Z\xc0-\xd6\xd8-\xde]+|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0]|\ud83c[\udffb-\udfff])?)*/g,
bd=/[a-z][A-Z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ha="Array Buffer Date Error Float32Array Float64Array Function Int8Array Int16Array Int32Array Map Math Object Reflect RegExp Set String Symbol TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array WeakMap _ clearTimeout isFinite parseInt setTimeout".split(" "),P={};P["[object Float32Array]"]=P["[object Float64Array]"]=P["[object Int8Array]"]=P["[object Int16Array]"]=P["[object Int32Array]"]=P["[object Uint8Array]"]=P["[object Uint8ClampedArray]"]=
P["[object Uint16Array]"]=P["[object Uint32Array]"]=!0;P["[object Arguments]"]=P["[object Array]"]=P["[object ArrayBuffer]"]=P["[object Boolean]"]=P["[object Date]"]=P["[object Error]"]=P["[object Function]"]=P["[object Map]"]=P["[object Number]"]=P["[object Object]"]=P["[object RegExp]"]=P["[object Set]"]=P["[object String]"]=P["[object WeakMap]"]=!1;var L={};L["[object Arguments]"]=L["[object Array]"]=L["[object ArrayBuffer]"]=L["[object Boolean]"]=L["[object Date]"]=L["[object Float32Array]"]=
L["[object Float64Array]"]=L["[object Int8Array]"]=L["[object Int16Array]"]=L["[object Int32Array]"]=L["[object Map]"]=L["[object Number]"]=L["[object Object]"]=L["[object RegExp]"]=L["[object Set]"]=L["[object String]"]=L["[object Symbol]"]=L["[object Uint8Array]"]=L["[object Uint8ClampedArray]"]=L["[object Uint16Array]"]=L["[object Uint32Array]"]=!0;L["[object Error]"]=L["[object Function]"]=L["[object WeakMap]"]=!1;var Va={"\u00c0":"A","\u00c1":"A","\u00c2":"A","\u00c3":"A","\u00c4":"A","\u00c5":"A",
"\u00e0":"a","\u00e1":"a","\u00e2":"a","\u00e3":"a","\u00e4":"a","\u00e5":"a","\u00c7":"C","\u00e7":"c","\u00d0":"D","\u00f0":"d","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u00cb":"E","\u00e8":"e","\u00e9":"e","\u00ea":"e","\u00eb":"e","\u00cc":"I","\u00cd":"I","\u00ce":"I","\u00cf":"I","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u00ef":"i","\u00d1":"N","\u00f1":"n","\u00d2":"O","\u00d3":"O","\u00d4":"O","\u00d5":"O","\u00d6":"O","\u00d8":"O","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u00f5":"o","\u00f6":"o",
"\u00f8":"o","\u00d9":"U","\u00da":"U","\u00db":"U","\u00dc":"U","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u00fc":"u","\u00dd":"Y","\u00fd":"y","\u00ff":"y","\u00c6":"Ae","\u00e6":"ae","\u00de":"Th","\u00fe":"th","\u00df":"ss"},aa={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Xa={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},W={"function":!0,object:!0},Ga={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ma=parseFloat,Ja=parseInt,
ya=W[typeof exports]&&exports&&!exports.nodeType?exports:p,ka=W[typeof module]&&module&&!module.nodeType?module:p,yb=ka&&ka.exports===ya?ya:p,Ua=X(ya&&ka&&"object"==typeof global&&global),qa=X(W[typeof self]&&self),ra=X(W[typeof window]&&window),W=X(W[typeof this]&&this),v=Ua||ra!==(W&&W.window)&&ra||qa||W||Function("return this")(),Q=Db();(ra||qa||{})._=Q;"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("third_party/lo-dash/lo-dash.min",[],function(){return Q}):ya&&ka?(yb&&
((ka.exports=Q)._=Q),ya._=Q):v._=Q}).call(this);
define("qowtRoot/utils/typeUtils",[],function(){function e(a,c,e){if(e.types.every(function(a){var c=g[a];if(!c)throw Error("Bad config to checkArgTypes: unknown type: "+a);return!c(e.value)})){var q=1===e.types.length?e.types[0]:"["+e.types.join(",")+"]";throw Error("Argument "+c+" passed to function "+a+" was supposed to be of type "+q+" but had value "+e.value);}}var c={checkArgTypes:function(a,c){for(var g in c){var q={value:c[g][0],types:c[g].slice(1)};e(a,g,q)}},isObject:function(a){return"object"===
typeof a&&null!==a},isPromise:function(a){return a instanceof Promise},isPromiseLike:function(a){return!(!a||!c.isFunction(a.then))},isList:function(a){return"[object Array]"===Object.prototype.toString.call(a)},isNumber:function(a){return"number"===typeof a&&!isNaN(a)},isInteger:function(a){return"number"===typeof a&&parseInt(a,10)===a},isFunction:function(a){return"function"===typeof a},isString:function(a){return"[object String]"===Object.prototype.toString.call(a)},isRegex:function(a){return"[object RegExp]"===
Object.prototype.toString.call(a)},isNode:function(a){return a instanceof Node},isNull:function(a){return null===a},isUndefined:function(a){return void 0===a},isBoolean:function(a){return"boolean"===typeof a},getType:function(a){var c;Object.keys(g).forEach(function(e){g[e](a)&&(c=e)});return c},isArgumentsObjectOrList:function(a){return a instanceof Object&&a.hasOwnProperty("length")},extend:function(a,c){for(var e in c)c.hasOwnProperty(e)&&(a[e]=c[e])},createNewType:function(a){var c=function(){},
e={isOfType:function(a){return void 0!==a&&null!==a&&a.constructor===c},markAsType:function(a){Object.defineProperty(a,"constructor",{value:c,configurable:!1,writable:!1,enumerable:!1});return a}};if(a){if(g[a])throw Error("Already registered type "+a);g[a]=e.isOfType}return e}},g={string:c.isString,object:c.isObject,promise:c.isPromise,promiseLike:c.isPromiseLike,node:c.isNode,regex:c.isRegex,"function":c.isFunction,number:c.isNumber,list:c.isList,boolean:c.isBoolean,"null":c.isNull,undefined:c.isUndefined};
return c});
define("qowtRoot/configs/common",[],function(){var e={SUPPORTED_IMAGE_FORMATS:{jpg:!0,jpeg:!0,gif:!0,png:!0,pic:!1,pict:!1,bmp:!0,tif:!0,tiff:!0},ZOOM:{current:void 0,next:void 0,levels:void 0},LAYOUT_DEFAULT_MAXZOOM:void 0,LAYOUT_DEFAULT_MINZOOM:void 0,LAYOUT_DEFAULT_ZOOM_LEVEL:void 0,DOC_VERIFY_DEBOUNCE:50,DEFAULT_COLORS:"#6B9CD4 #DE7872 #B7D37C #A48CC2 #6CC7E1 #F3AB63 #AEC8EE".split(" "),TEXT_STYLE:{defaultHighlightColor:"rgb(255, 255, 255)",defaultTxtColor:"rgb(0, 0, 0)",shadowText:{setValue:"#000000 0.07em 0.07em 0.07em",getValue:"rgb(0, 0, 0) 0.07em 0.07em 0.07em"},
outlineText:{webkitTextFillColor:"transparent",webkitTextStroke:".05em #000000",webkitTextStrokeWidth:"0.05em",webkitTextStrokeColor:"rgb(0, 0, 0)"},embossedText:{setColor:"#ffffff",getColor:"rgb(255, 255, 255)",setShadow:"#000000 1px 1px 2px",getShadow:"rgb(0, 0, 0) 1px 1px 2px"},engravedText:{setColor:"#999999",getColor:"rgb(153, 153, 153)",setShadow:"#000000 -1px -1px 2px",getShadow:"rgb(0, 0, 0) -1px -1px 2px"}},DEFAULT_BLIP_FILL_PROPERTIES:{tileProps:{Sx:100,Sy:100,Tx:0,Ty:0,align:"TL"},type:"tileFill"},
kMESSAGE_BUS_CONNECTION_RETRY:10,kMESSAGE_BUS_CONNECTION_TIMEOUT:3E4,kMESSAGE_BUS_CONNECTION_TIMEOUT_MSG:"MessageBus: Connection timeout",create:function(){return{SUPPORTED_IMAGE_FORMATS:e.SUPPORTED_IMAGE_FORMATS,DIALOGUE_CONFIG:e.DIALOGUE_CONFIG,DEFAULT_COLORS:e.DEFAULT_COLORS,ZOOM:e.ZOOM,LAYOUT_DEFAULT_MAXZOOM:e.LAYOUT_DEFAULT_MAXZOOM,LAYOUT_DEFAULT_MINZOOM:e.LAYOUT_DEFAULT_MINZOOM,LAYOUT_DEFAULT_ZOOM_LEVEL:e.LAYOUT_DEFAULT_ZOOM_LEVEL}}};return e});
(function(e){e("qowtRoot/third_party/when/lib/timer",["require"],function(c){return{set:setTimeout,clear:clearTimeout}})})("function"===typeof define&&define.amd?define:function(e){module.exports=e(require)});
(function(e){e("qowtRoot/third_party/when/lib/timed",[],function(){return function(c,e,a){a.prototype.delay=function(a){var e=this;return new this.constructor(function(g,t,l){e.then(function(e){c(function(){g(e)},a)},t,l)})};a.prototype.timeout=function(a,n){var q=this,t=1<arguments.length;return new this.constructor(function(l,u,r){var w=c(function(){u(t?n:Error("timed out after "+a+"ms"))},a);q.then(function(a){e(w);l(a)},function(a){e(w);u(a)},r)})};return a}})})("function"===typeof define&&define.amd?
define:function(e){module.exports=e()});
(function(e){e("qowtRoot/third_party/when/lib/array",[],function(){return function(c){var e=Array.prototype.map,a=Array.prototype.reduce,k=Array.prototype.reduceRight,n=Array.prototype.forEach,q=c.resolve,t=c.all;c.any=function(a){return new c(function(c,e){function g(a){t.push(a);0===--k&&e(t)}var k=0,t=[];n.call(a,function(a){++k;q(a).then(c,g)});0===k&&c()})};c.some=function(a,e){return new c(function(c,g,k){function t(a){0<x&&(--x,B.push(a),0===x&&c(B))}function E(a){0<y&&(--y,N.push(a),0===y&&
g(N))}var x=0,y,B=[],N=[];n.call(a,function(a){++x;q(a).then(t,E,k)});e=Math.max(e,0);y=x-e+1;x=Math.min(e,x);0===x&&c(B)})};c.settle=function(a){return t(e.call(a,function(a){function c(){return a.inspect()}a=q(a);return a.then(c,c)}))};c.map=function(a,c,k){return t(e.call(a,function(a){return q(a).then(c,k)}))};c.reduce=function(c,e){function g(a,c,l){return q(a).then(function(a){return q(c).then(function(c){return e(a,c,l)})})}return 2<arguments.length?a.call(c,g,arguments[2]):a.call(c,g)};c.reduceRight=
function(a,c){function e(a,l,g){return q(a).then(function(a){return q(l).then(function(e){return c(a,e,g)})})}return 2<arguments.length?k.call(a,e,arguments[2]):k.call(a,e)};c.prototype.spread=function(a){return this.then(t).then(function(c){return a.apply(void 0,c)})};return c}})})("function"===typeof define&&define.amd?define:function(e){module.exports=e()});
(function(e){e("qowtRoot/third_party/when/lib/fatal",["require","./timer"],function(c){var e=c("./timer").set;return function(a){e(function(){throw a;},0)}})})("function"===typeof define&&define.amd?define:function(e){module.exports=e(require)});
(function(e){e("qowtRoot/third_party/when/lib/flow",["require","./fatal"],function(c){function e(){throw new TypeError("catch predicate must be a function");}function a(a,c){return function(){a.call(this);return c}}function k(){}var n=c("./fatal");return function(c){function t(a,c){return function(e){return(c===Error||null!=c&&c.prototype instanceof Error?e instanceof c:c(e))?a.call(this,e):u(e)}}var l=c.resolve,u=c.reject,r=c.prototype["catch"];c.prototype.done=function(a,c){var e=this._handler;
e.when(this._maybeFatal,k,this,e.receiver,a,c)};c.prototype._maybeFatal=function(a){if(Object(a)===a)l(a)["catch"](this._fatal)};c.prototype._fatal=n;c.prototype["catch"]=c.prototype.otherwise=function(a){return 1===arguments.length?r.call(this,a):"function"!==typeof a?this.ensure(e):r.call(this,t(arguments[1],a))};c.prototype["finally"]=c.prototype.ensure=function(c){if("function"!==typeof c)return this;c=a(c,this);return this.then(c,c)};c.prototype["else"]=c.prototype.orElse=function(a){return this.then(void 0,
function(){return a})};c.prototype.yield=function(a){return this.then(function(){return a})};c.prototype.tap=function(a){return this.then(a).yield(this)};return c}})})("function"===typeof define&&define.amd?define:function(e){module.exports=e(require)});(function(e){e("qowtRoot/third_party/when/lib/inspect",[],function(){return function(c){c.prototype.inspect=function(){return this._handler.inspect()};return c}})})("function"===typeof define&&define.amd?define:function(e){module.exports=e()});
(function(e){e("qowtRoot/third_party/when/lib/iterate",[],function(){return function(c){function e(a,c,t,l){function u(l){return k(t(l)).then(function(){return e(a,c,t,a(l))})}return k(l).then(function(a){return k(c(a)).then(function(c){return c?a:u(a)})})}function a(c,e,g,l){function u(l,u){return k(g(l)).then(function(){return a(c,e,g,u)})}return k(l).then(function(a){return k(e(a)).then(function(e){return e?a:k(c(a)).spread(u)})})}var k=c.resolve;c.iterate=e;c.unfold=a;return c}})})("function"===
typeof define&&define.amd?define:function(e){module.exports=e()});(function(e){e("qowtRoot/third_party/when/lib/progress",[],function(){return function(c){c.prototype.progress=function(c){return this.then(void 0,void 0,c)};return c}})})("function"===typeof define&&define.amd?define:function(e){module.exports=e()});
(function(e){e("qowtRoot/third_party/when/lib/with",[],function(){return function(c){c.prototype["with"]=c.prototype.withThis=c.prototype._bindContext;return c}})})("function"===typeof define&&define.amd?define:function(e){module.exports=e()});
(function(e){e("qowtRoot/third_party/when/lib/makePromise",[],function(){return function(c){function e(c){var l=this;this._handler=new w;a(c,function(a){l._handler.resolve(a)},function(a){l._handler.reject(a)},function(a){l._handler.notify(a)})}function a(a,c,e,l){try{a(c,e,l)}catch(g){e(g)}}function k(a){return new n(new M(new y(a)))}function n(a){this._handler=a}function q(a,c){if(a instanceof e){var k=a._handler.join();return c===k?new y(new TypeError("Promise cycle")):k}return Z(a)?l(a):new x(a)}
function t(a){return a instanceof e?a._handler.join():l(a)}function l(a){try{var c=a.then;return"function"===typeof c?new E(c,a):new x(a)}catch(e){return new y(e)}}function u(){}function r(a){this.handler=a;if(this._isMonitored()){var c=this._env.promiseMonitor.captureStack();this.trace=a._addTrace(c)}}function w(a){this.consumers=[];this.receiver=a;this.handler=void 0;this.resolved=!1;this._isMonitored()&&(this.trace=this._env.promiseMonitor.captureStack())}function M(a){r.call(this,a)}function H(a,
c){r.call(this,a);this.receiver=c}function E(a,c){w.call(this);this.assimilated=!1;this.untrustedThen=a;this.thenable=c}function x(a){this.value=a}function y(a){this.value=a;this.observed=!1;this._isMonitored()&&(this.key=this._env.promiseMonitor.startTrace(a))}function B(){return{state:"pending"}}function N(a,c,e,l,g,m,k,n){this.a=a;this.b=c;this.c=e;this.d=l;this.e=g;this.f=m;this.g=k;this.handler=n}function da(a,c){this.q=a;this.value=c}function Z(a){return("object"===typeof a||"function"===typeof a)&&
null!==a}function O(a,c,e){try{return a.call(e,c)}catch(l){return k(l)}}function I(){}var ea,T=c.scheduler,S=Object.create||function(a){function c(){}c.prototype=a;return new c};e.resolve=function(a){return a instanceof e?a:new n(new M(q(a)))};e.reject=k;e.never=function(){return ea};e._defer=function(){return new n(new w)};e.prototype.then=function(a,c,e){var l=this._handler,g=new w(l.receiver);l.when(g.resolve,g.notify,g,l.receiver,a,c,e);return new n(g)};e.prototype["catch"]=e.prototype.otherwise=
function(a){return this.then(void 0,a)};e.prototype._bindContext=function(a){return new n(new H(this._handler,a))};e.all=function(a){function c(a,e,m,l){m.when(I,I,void 0,a,function(a){e[l]=a;0===--g&&this.resolve(e)},a.reject,a.notify)}var e=new w,l=a.length>>>0,g=l,m=[],k,q;for(k=0;k<l;++k)k in a?(q=a[k],Z(q)?c(e,m,t(q),k):(m[k]=q,--g)):--g;0===g&&e.resolve(m);return new n(e)};e.race=function(a){if(Object(a)===a&&0===a.length)return ea;for(var c=new w,e=0;e<a.length;++e)q(a[e]).when(I,I,void 0,
c,c.resolve,c.reject);return new n(c)};n.prototype=S(e.prototype);u.prototype.inspect=B;u.prototype.when=I;u.prototype.resolve=I;u.prototype.reject=I;u.prototype.notify=I;u.prototype.join=function(){return this};u.prototype._env=c.monitor||e;u.prototype._addTrace=I;u.prototype._isMonitored=function(){return"undefined"!==typeof this._env.promiseMonitor};r.prototype=S(u.prototype);r.prototype.join=function(){return this.handler.join()};r.prototype.inspect=function(){return this.handler.inspect()};r.prototype._addTrace=
function(a){return this.handler._addTrace(a)};w.prototype=S(u.prototype);w.prototype.inspect=function(){return this.resolved?this.handler.join().inspect():B()};w.prototype.resolve=function(a){this._join(q(a,this))};w.prototype.reject=function(a){this._join(new y(a))};w.prototype.join=function(){return this.resolved?this.handler.join():this};w.prototype.run=function(){var a=this.consumers,c=this.handler=this.handler.join();this.consumers=void 0;for(var e=0;e<a.length;e+=7)c.when(a[e],a[e+1],a[e+2],
a[e+3],a[e+4],a[e+5],a[e+6])};w.prototype._join=function(a){this.resolved||(this.resolved=!0,this.handler=a,T.enqueue(this),this._isMonitored()&&(this.trace=a._addTrace(this.trace)))};w.prototype.when=function(a,c,e,l,g,m,k){this.resolved?T.enqueue(new N(a,c,e,l,g,m,k,this.handler.join())):this.consumers.push(a,c,e,l,g,m,k)};w.prototype.notify=function(a){this.resolved||T.enqueue(new da(this.consumers,a))};w.prototype._addTrace=function(a){return this.resolved?this.handler._addTrace(a):a};M.prototype=
S(r.prototype);M.prototype.when=function(a,c,e,l,g,m,k){T.enqueue(new N(a,c,e,l,g,m,k,this.join()))};H.prototype=S(r.prototype);H.prototype.when=function(a,c,e,l,g,m,k){void 0!==this.receiver&&(l=this.receiver);this.join().when(a,c,e,l,g,m,k)};E.prototype=S(w.prototype);E.prototype.when=function(a,c,e,l,g,m,k){this.assimilated||(this.assimilated=!0,this._assimilate());w.prototype.when.call(this,a,c,e,l,g,m,k)};E.prototype._assimilate=function(){var a=this;this._try(this.untrustedThen,this.thenable,
function(c){a.resolve(c)},function(c){a.reject(c)},function(c){a.notify(c)})};E.prototype._try=function(a,c,e,l,g){try{a.call(c,e,l,g)}catch(m){l(m)}};x.prototype=S(u.prototype);x.prototype.inspect=function(){return{state:"fulfilled",value:this.value}};x.prototype.when=function(a,c,e,l,g){c="function"===typeof g?O(g,this.value,l):this.value;a.call(e,c)};y.prototype=S(u.prototype);y.prototype.inspect=function(){return{state:"rejected",reason:this.value}};y.prototype.when=function(a,c,e,l,g,m){this._isMonitored()&&
!this.observed&&this._env.promiseMonitor.removeTrace(this.key);this.observed=!0;c="function"===typeof m?O(m,this.value,l):k(this.value);a.call(e,c)};y.prototype._addTrace=function(a){this.observed||this._env.promiseMonitor.updateTrace(this.key,a)};ea=new n(new u);N.prototype.run=function(){this.handler.when(this.a,this.b,this.c,this.d,this.e,this.f,this.g)};da.prototype.run=function(){for(var a=this.q,c=1;c<a.length;c+=7)this._notify(a[c],a[c+1],a[c+2],a[c+5])};da.prototype._notify=function(a,c,e,
l){var g;if("function"===typeof l)try{g=l.call(e,this.value)}catch(m){g=m}else g=this.value;a.call(c,g)};return e}})})("function"===typeof define&&define.amd?define:function(e){module.exports=e()});
(function(e){e("qowtRoot/third_party/when/lib/Queue",[],function(){function c(c){this.head=this.tail=this.length=0;this.buffer=Array(1<<c)}c.prototype.push=function(c){this.length===this.buffer.length&&this._ensureCapacity(2*this.length);this.buffer[this.tail]=c;this.tail=this.tail+1&this.buffer.length-1;++this.length;return this.length};c.prototype.shift=function(){var c=this.buffer[this.head];this.buffer[this.head]=void 0;this.head=this.head+1&this.buffer.length-1;--this.length;return c};c.prototype._ensureCapacity=
function(c){var a=this.head,e=this.buffer,n=Array(c),q=0,t;if(0===a)for(t=this.length;q<t;++q)n[q]=e[q];else{c=e.length;for(t=this.tail;a<c;++q,++a)n[q]=e[a];for(a=0;a<t;++q,++a)n[q]=e[a]}this.buffer=n;this.head=0;this.tail=this.length};return c})})("function"===typeof define&&define.amd?define:function(e){module.exports=e()});
(function(e){e("qowtRoot/third_party/when/lib/scheduler",["require","./Queue"],function(c){function e(c){this._enqueue=c;this._handlerQueue=new a(15);var g=this;this.drainQueue=function(){g._drainQueue()}}var a=c("./Queue");e.prototype.enqueue=function(a){1===this._handlerQueue.push(a)&&this._enqueue(this.drainQueue)};e.prototype._drainQueue=function(){for(var a=this._handlerQueue;0<a.length;)a.shift().run()};return e})})("function"===typeof define&&define.amd?define:function(e){module.exports=e(require)});
(function(e){e("qowtRoot/third_party/when/lib/async",["require"],function(c){var e;return"undefined"!==typeof process&&null!==process&&"function"===typeof process.nextTick?function(a){process.nextTick(a)}:(e="function"===typeof MutationObserver&&MutationObserver||"function"===typeof WebKitMutationObserver&&WebKitMutationObserver)?function(a,c){var e,g=a.createElement("div");(new c(function(){var a=e;e=void 0;a()})).observe(g,{attributes:!0});return function(a){e=a;g.setAttribute("class","x")}}(document,
e):function(a){var c=setTimeout;return function(a){c(a,0)}}(c)})})("function"===typeof define&&define.amd?define:function(e){module.exports=e(require)});(function(e){e("qowtRoot/third_party/when/lib/Promise",["require","./makePromise","./scheduler","./async"],function(c){var e=c("./makePromise"),a=c("./scheduler");c=c("./async");return e({scheduler:new a(c),monitor:"undefined"!==typeof console?console:void 0})})})("function"===typeof define&&define.amd?define:function(e){module.exports=e(require)});
(function(e){e("qowtRoot/third_party/when/when","require ./lib/timer ./lib/timed ./lib/array ./lib/flow ./lib/inspect ./lib/iterate ./lib/progress ./lib/with ./lib/Promise".split(" "),function(c){function e(a,c,l,g){var k=y(a);return 2>arguments.length?k:k.then(c,l,g)}function a(a){return function(){return n(a,this,B.call(arguments))}}function k(a){return n(a,this,B.call(arguments,1))}function n(a,c,e){return x.all(e).then(function(e){return a.apply(c,e)})}function q(){function a(c){l._handler.resolve(c)}
function c(a){l._handler.reject(a)}function e(a){l._handler.notify(a)}var l=x._defer();this.promise=l;this.resolve=a;this.reject=c;this.notify=e;this.resolver={resolve:a,reject:c,notify:e}}var t=c("./lib/timer"),l=c("./lib/timed"),u=c("./lib/array"),r=c("./lib/flow"),w=c("./lib/inspect"),M=c("./lib/iterate"),H=c("./lib/progress"),E=c("./lib/with"),x=c("./lib/Promise"),x=[u,r,M,H,w,E].reduceRight(function(a,c){return c(a)},l(t.set,t.clear,x)),y=x.resolve,B=Array.prototype.slice;e.promise=function(a){return new x(a)};
e.resolve=x.resolve;e.reject=x.reject;e.lift=a;e["try"]=k;e.attempt=k;e.iterate=x.iterate;e.unfold=x.unfold;e.join=function(){return x.all(arguments)};e.all=function(a){return e(a,x.all)};e.settle=function(a){return e(a,x.settle)};e.any=a(x.any);e.some=a(x.some);e.map=function(a,c){return e(a,function(a){return x.map(a,c)})};e.reduce=function(a,c){var l=B.call(arguments,1);return e(a,function(a){l.unshift(a);return x.reduce.apply(x,l)})};e.reduceRight=function(a,c){var l=B.call(arguments,1);return e(a,
function(a){l.unshift(a);return x.reduceRight.apply(x,l)})};e.isPromiseLike=function(a){return a&&"function"===typeof a.then};e.Promise=x;e.defer=function(){return new q};return e})})("function"===typeof define&&define.amd?define:function(e){module.exports=e(require)});
define("qowtRoot/messageBus/messageBusImpl",["qowtRoot/utils/typeUtils","qowtRoot/configs/common","qowtRoot/third_party/when/when"],function(e,c,g){var a=function(a){this.myWin_=a||window;this.pendingConnections_=[];this.acceptedConnections_=[];this.completedConnections_=[];this.acknowledgements_=[];this.listeners_=[];this.msgQueue_=[];this.pendingMsgs_=[];this.myWin_.addEventListener("message",this.handleIncomingMessage_.bind(this),!1)};a.prototype=Object.create(Object.prototype);a.prototype.constructor=
a;a.prototype.connect=function(a,c){if(!a||null===a||!e.isObject(a)||!a.postMessage)throw Error("MessageBus: A valid HTML window object has not been provided to connect()");if(a===this.myWin_)throw Error("MessageBus: Trying to connect to its own window");if(c&&!e.isFunction(c))throw Error("MessageBus: The provided callback function is not of the correct type");for(var k=this.pendingConnections_.length,n=0;n<k;n++)if(this.pendingConnections_[n].win===a)throw Error("MessageBus: Trying to connect to a window that we are already trying to connect to");
k=this.acceptedConnections_.length;for(n=0;n<k;n++)if(this.acceptedConnections_[n].win===a)throw Error("MessageBus: Trying to connect to a window that we are already trying to connect to");k=this.completedConnections_.length;for(n=0;n<k;n++)if(this.completedConnections_[n].win===a)throw Error("MessageBus: Trying to connect to a window that has already been connected");k={win:a,callback:c,currentWaitTime:0,deferred:g.defer()};this.pendingConnections_.push(k);this.tryToConnect_(k);return k.deferred.promise};
a.prototype.pushMessage=function(a){if(!e.isObject(a))throw Error("MessageBus: A valid message object has not been provided to pushMessage()");var c=this.completedConnections_.length;if(0===c)this.pendingMsgs_.push(a);else{if(!e.isObject(a))throw Error("Cannot mark non-object value as quickoffice message");a.qoMessageBus=!0;this.msgQueue_.length>=k&&this.msgQueue_.shift();this.msgQueue_.push(a);for(var g=0;g<c;g++)this.completedConnections_[g].win.postMessage(a,"*")}};a.prototype.listen=function(a,
c){if(!e.isFunction(a))throw Error("MessageBus: A valid listener function has not been provided to listen()");if(c&&!e.isFunction(c))throw Error("MessageBus: The provided filter function is not of the correct type");this.listeners_.push({listener:a,filter:c})};a.prototype.stopListening=function(a){if(!e.isFunction(a))throw Error("MessageBus: A valid listener function has not been provided to stopListening()");for(var c=this.listeners_.length,g=0;g<c;g++)if(this.listeners_[g].listener===a){this.listeners_.splice(g,
1);break}};a.prototype.isConnectedTo=function(a){for(var c=!1,e=this.completedConnections_.length,g=0;g<e;g++)if(a===this.completedConnections_[g].win){c=!0;break}return c};a.prototype.tryToConnect_=function(a){a.currentWaitTime>c.kMESSAGE_BUS_CONNECTION_TIMEOUT?this.handleTimeOut_(a):(a.currentWaitTime+=c.kMESSAGE_BUS_CONNECTION_RETRY,-1!==this.pendingConnections_.indexOf(a)&&a.win.postMessage(n,"*"),a.timeoutId=setTimeout(this.tryToConnect_.bind(this,a),c.kMESSAGE_BUS_CONNECTION_RETRY))};a.prototype.handleTimeOut_=
function(a){var e=c.kMESSAGE_BUS_CONNECTION_TIMEOUT_MSG;window.connectFromAppToQowt&&(e=window.connectFromQowtToApp?Math.abs(Math.round(window.connectFromQowtToApp-window.connectFromAppToQowt)/1E3)>Math.round(c.kMESSAGE_BUS_CONNECTION_TIMEOUT/1E3*.8)?e+":qowt too late to connect":e+":qowt and app connected:handshake failed?":e+":qowt failed to connect");a.deferred.reject(Error(e))};a.prototype.handleIncomingMessage_=function(a){if(a){if(-1!==this.msgQueue_.indexOf(a.data))throw Error("MessageBus: A message that was pushed onto thisbus has arrived back on it - we have a circular dependancy!");
a.data===n?this.handleConnectionRequestMsg_(a):a.data===q?this.handleConnectionAcceptedMsg_(a):a.data===t?this.handleConnectionAckMsg_(a):a&&a.data&&!0===a.data.qoMessageBus&&("chrome-extension://gbkeegbaiigmenfmjfclcdgdpimamgkj"===a.origin||"chrome-extension://bpmcpldpdmajfigpchkicefoigmkfalc"===a.origin||"chrome-extension://ehibbfinohgbchlgdbfpikodjaojhccn"===a.origin)&&this.handleClientMsg_(a)}};a.prototype.handleConnectionRequestMsg_=function(a){if(!a.source)throw Error("MessageBus: Unknown source of qoConnectionRequest message");
a.source.postMessage(q,"*")};a.prototype.handleConnectionAcceptedMsg_=function(a){if(!a.source)throw Error("MessageBus: Unknown source of qoConnectionAccepted message");for(var c=this.pendingConnections_.length,e=0;e<c;e++)if(this.pendingConnections_[e].win===a.source){c=this.pendingConnections_.splice(e,1)[0];a=this.acknowledgements_.indexOf(a.source);-1===a?this.acceptedConnections_.push(c):(this.acknowledgements_.splice(a,1),this.connectionCompleted_(c));c.win.postMessage(t,"*");break}};a.prototype.handleConnectionAckMsg_=
function(a){if(!a.source)throw Error("MessageBus: Unknown source of qoConnectionAck message");for(var c=this.acceptedConnections_.length,e=0;e<c;e++)if(this.acceptedConnections_[e].win===a.source){a=this.acceptedConnections_.splice(e,1)[0];this.connectionCompleted_(a);return}this.acknowledgements_.push(a.source)};a.prototype.handleClientMsg_=function(a){if(a.source){for(var c=this.listeners_.slice(),e=c.length,g=0;g<e;g++){var k=c[g];!k||k.filter&&!k.filter.call(this,a)||k.listener.call(this,a)}e=
this.completedConnections_.length;for(g=0;g<e;g++)this.completedConnections_[g].win!==a.source&&this.completedConnections_[g].win.postMessage(a.data,"*")}};a.prototype.connectionCompleted_=function(a){this.completedConnections_.push(a);clearTimeout(a.timeoutId);for(a.callback&&a.callback.call(this);0<this.pendingMsgs_.length;)this.pushMessage(this.pendingMsgs_.shift());a.deferred.resolve()};var k=10,n="qoConnectionRequest",q="qoConnectionAccepted",t="qoConnectionAck";return a});
define("qowtRoot/messageBus/messageBus",["qowtRoot/messageBus/messageBusImpl"],function(e){return new e});
define("qowtRoot/pubsub/pubsub",["third_party/lo-dash/lo-dash.min"],function(){function e(a,e){var g=[],k=[],q=[],H=[];n[a]&&n[a].length&&(t++,n[a].forEach(function(a){a.config.after?k.push(a):g.push(a);a.config.once&&H.push(a)}),g.concat(k).forEach(function(c){q.push(c.callback(a,e))}),H.forEach(function(a){c(a.token)}));return Promise.all(q)}function c(a){var c;_.values(n).some(function(e){return e.some(function(g,k){return g.token===a?(c=e.splice(k,1)[0],!0):!1})});return c}function g(a){var c=
0;return c=a?n[a]?n[a].length:0:_.values(n).reduce(function(a,c){return a+c.length},0)}function a(){n={}}var k=Object.create(Object.prototype,{subscriberCount:{get:function(){return g()}},registeredSignals:{get:function(){return _.keys(n)}},publishCount:{get:function(){return t}}});k.subscribe=function(a,c,e){if(!_.isString(a)||!a)throw new TypeError("invalid signal");if(!_.isFunction(c))throw new TypeError("invalid callback");e=e||{};e.once=!!e.once;e.after=!!e.after;var g=(++q).toString();n[a]=
n[a]||[];n[a].push({token:g,callback:c,config:e});return g};k.publish=function(a,c){if(!_.isString(a)||!a)throw new TypeError("invalid signal");c=c||{};return e(a,c)};k.doAction=function(a,c){if(!_.isString(a)||!a)throw new TypeError("invalid action");c=c||{};c=_.isString(c)?{contentType:c}:c;return e("qowt:doAction",{action:a,context:c})};k.unsubscribe=function(a){if(void 0!==a){if(!_.isString(a)||!a)throw new TypeError("invalid token");return c(a)}};k.subscriberCountForSignal=function(a){if(!_.isString(a)||
!a)throw new TypeError("invalid signal");return g(a)};k.clear=a;k.reset=function(){a();t=q=0};var n={},q=0,t=0;return k});(function(){var e={},c=window.sessionStorage.getItem("featureOverrides");c&&(e=JSON.parse(c));e.isRelease=!0;e.edit=!1;window.sessionStorage.setItem("featureOverrides",JSON.stringify(e));window.localStorage.removeItem("testsToInclude");window.localStorage.removeItem("builtInTests")})();define("configs/releaseFeatures",function(){});
(function(){var e={},c=window.sessionStorage.getItem("featureOverrides");c&&(e=JSON.parse(c));e.save=!!(window.chrome&&window.chrome.fileSystem&&window.chrome.fileSystem.chooseEntry);window.sessionStorage.setItem("featureOverrides",JSON.stringify(e))})();define("configs/chromeFeatures",function(){});define("qowtRoot/features/pack",[],function(){return{edit:!0,save:!1,pointEdit:!1,hats:!0}});
define("qowtRoot/features/utils",["qowtRoot/features/pack"],function(e){var c={isEnabled:function(a){a=e[a];return void 0===a?!1:a},enable:function(a){e[a]=!0},disable:function(a){e[a]=!1},setOverrides:function(a){for(var c in a)a.hasOwnProperty(c)&&(e[c]=a[c])},isDebug:function(){return void 0!==g?g:!c.isEnabled("isRelease")},setDebugOverride:function(a){g=a},clearDebugOverride:function(){g=void 0}},g;return c});
define("qowtRoot/utils/promiseUtils",["qowtRoot/utils/typeUtils","qowtRoot/third_party/when/when"],function(e,c){var g={cast:function(a){return a instanceof Promise?a:Promise.resolve(a)},delay:function(a,c){a=a||0;return new Promise(function(e){setTimeout(e.bind(void 0,c),a)})},delayThenReject:function(a,c){a=a||0;return new Promise(function(e,g){setTimeout(g.bind(e,c),a)})},throwAndEscapeChain:function(a){a instanceof Error||(console.error("throwAndEscapeChain wrapping value in new Error: ",a),a=
Error(a));c.reject(a).done();throw a;},pipeline:function(a){function c(){for(var q=Array.prototype.slice.call(arguments,0);0<a.length;){var l=a.shift();if(e.isPromiseLike(l))return g.cast(l).then(function(e){a.unshift(e);return c.apply(n,q)});e.checkArgTypes("PromiseUtils.pipeline",{task:[l,"function"]});l=l.apply(n,q);if(e.isPromiseLike(l))return g.cast(l).then(function(a){return c(a)});q=[l]}return q[0]}var n=this,q=Array.prototype.slice.call(arguments,0);if(q.some(e.isPromiseLike))return Promise.all(q).then(function(a){return g.pipeline.apply(n,
a)});e.checkArgTypes("PromiseUtils.pipeline",{tasks:[a,"list"]});a=a.slice(0);return c.apply(n,q.slice(1))},finally:function(a,c){function e(){return g.cast(c()).then(function(){return a})}return g.cast(a).then(e,e)},waitForNextMacroTurn:function(a){return new Promise(function(c){window.setTimeout(c.bind(null,a),0)})}};return g});
define("qowtRoot/utils/platform",[],function(){var e=Object.create(Object.prototype,{name:{get:function(){return c}},locale:{get:function(){return g}},isOther:{get:function(){return"OTHER"===c}},isUnix:{get:function(){return"UNIX"===c}},isWindows:{get:function(){return"WINDOWS"===c}},isOsx:{get:function(){return"OSX"===c}},isLinux:{get:function(){return"LINUX"===c}},isCros:{get:function(){return"CROS"===c}}}),c,g;(function(){c="OTHER";var a=navigator.appVersion.toLowerCase();-1!==a.indexOf("x11")&&
(c="UNIX");-1!==a.indexOf("win")&&(c="WINDOWS");-1!==a.indexOf("mac")&&(c="OSX");-1!==a.indexOf("linux")&&(c="LINUX");-1!==a.indexOf("cros")&&(c="CROS");g=navigator.language.toUpperCase()})();return e});
define("utils/analytics/googleAnalytics",["qowtRoot/features/utils","qowtRoot/utils/promiseUtils","qowtRoot/utils/platform"],function(e,c,g){function a(a,c){var g;void 0!==I?g=I?Promise.resolve():Promise.reject(Error("ga permission cached (not permitted)")):(chrome&&chrome.metricsPrivate&&chrome.metricsPrivate.getIsCrashReportingEnabled&&(!e.isDebug()||void 0!==window.__gaMock)?g=Promise.resolve():(console.warn("GA not supported on this platform"),g=Promise.reject(Error("GA not supported on this platform"))),
g=g.then(k).catch(t));return g.then(l).then(a.bind(null,c)).catch(function(){})}function k(){var a=Error("Crash reporting setting timed out");return Promise.race([n(),c.delayThenReject(1E3,a)]).then(q)}function n(){return new Promise(function(a){chrome.metricsPrivate.getIsCrashReportingEnabled(a)})}function q(a){return new Promise(function(c,e){(I=a)?c():(console.warn("Crash reporting not allowed"),e())})}function t(){I=!1;return Promise.reject()}function l(){void 0===T&&u("QO");return Promise.resolve()}
function u(a){if(T=a)S=a,r(S);return Promise.resolve()}function r(a){O!==a&&(S=O=a,H({name:"page_view"}));return Promise.resolve()}function w(a){var c={name:"exception",parameters:{}};c.parameters.description=a.msg;c.parameters.fatal=a.fatal;H(c);return Promise.resolve()}function M(a){H(a);return Promise.resolve()}function H(a){var c=N[T],e=da[T];a.name=a.name?a.name:a.action;y().then(function(m){try{fetch(B+"?measurement_id="+c+"&api_secret="+e,{method:"POST",body:JSON.stringify({client_id:m,timestamp_micros:1E3*
(new Date).getTime(),events:[x(a)]})})}catch(g){console.error("Google Analytics request failed with an exception",g)}})}function E(a){if("10.0"===a)return"10";if("6.2"===a)return"8";if("6.1"===a)return"7";if("6.0"===a)return"Vista";if("5.1"===a)return"XP";if("5.0"===a)return"2000";a}function x(a){var c=a.name.replaceAll("-","_");if(!C){C={engagement_time_msec:100};C.session_id=ea;C.app_version=chrome.runtime.getManifest().version;C.user_language=g.locale;C.operating_system="LINUX"===g.name?"Linux":
"WINDOWS"===g.name?"Windows":"CROS"===g.name?"Chrome OS":"OSX"===g.name?"Macintosh":g.name;C.screen_resolution=window.screen.width+"x"+window.screen.height;C.viewport=window.innerWidth+"x"+window.innerHeight;var e=C,m,k=/\(([^)]+)\)/.exec(navigator.userAgent)[1];g.isCros&&-1!==k.indexOf("CrOS")?m=k.match(/CrOS.*\d+(?:\.\d+)+/)[0].replace("CrOS ",""):g.isLinux&&-1!==k.indexOf("Linux")?m=/[^ ]*$/.exec(k)[0]:g.isOsx&&-1!==k.indexOf("Mac OS X")?(m=k.match(/\d+[._]\d+(?:[._]\d+)?/)[0].replaceAll("_","."),
1<m.match(/\./g).length&&(m=m.match(/^(\d+\.\d+)/)[0])):g.isWindows&&-1!==k.indexOf("Windows")&&(m=k.match(/\d+(?:\.\d+)+/)[0],m=E(m));e.operating_system_version=m;C.app_name=Z}C.page_title=S;if(!a.parameters||"exception"!==a.name&&"page_view"!==a.name)C.event_category=a.category,a.label&&(C.event_label=a.label),a.value&&(C.value=a.value);else for(e=Object.keys(a.parameters),m=0;m<e.length;m++)C[e[m]]=a.parameters[e[m]];return{name:c,params:C}}function y(){X||(X=new Promise(function(a,c){chrome.storage.sync.get("clientId",
function(e){if(chrome.runtime.lastError)c(chrome.runtime.lastError);else if("undefined"===typeof e.clientId){var m=self.crypto.randomUUID();e={};e.clientId=m;chrome.storage.sync.set(e,function(){a(m)})}else a(e.clientId)})}));return X}var B="https://www.google-analytics.com/mp/collect",N={word:"G-2EHQ55R09Q",sheet:"G-429ETHTJYR",point:"G-5VSRBT2L9W",QO:"G-11BCJ4LWCJ"},da={word:"esgLzn1kRb6eHxjysYicgQ",sheet:"v9vcbIqZSe6pTYEryGsfUQ",point:"5uHsbBE-Q3-tHRTfVqEEXg",QO:"k2-sQUVpTZWoDAUgoGUwog"},Z="Quickoffice",
O,I,ea,T,S,C,X;return{setFileExt:function(a){},setSessionGroup:function(a){ea=a},setTracker:function(c){return a(u,c)},setGA4Tracker:function(a){T=a},sendState:function(c){return a(r,c)},sendException:function(c){return a(w,c)},sendEvent:function(c){return a(M,c)},reset:function(){S=T=I=O=void 0}}});
define("qowtRoot/utils/i18n",["qowtRoot/utils/typeUtils","utils/analytics/googleAnalytics"],function(e,c){var g={getMessage:function(a,c){var n="????";if(!chrome||!chrome.i18n)return a;e.isString(a)?(n=chrome.i18n.getMessage(a,c),n||(n=a,g.logError_("Missing translation",a))):g.logError_("Invalid string translation Id",a);return n},logError_:function(a,e){console.error(a+" "+e);c.sendException({msg:a,fatal:!1})}};return g});
define("qowtRoot/errors/localisedError",["qowtRoot/utils/typeUtils","qowtRoot/utils/i18n","third_party/lo-dash/lo-dash.min"],function(e,c){var g=function(a){a=a||"";this.name="LocalisedError";e.isObject(a)&&_.extend(this,a);this.message=(this.code?this.code+": ":"")+(this.message||JSON.stringify(a)||this.title||this.details||this.additionalInfo);a.localised||this instanceof QOWTSilentError||(this.title=c.getMessage(this.title),this.details=a.fileName?c.getMessage(this.details,a.fileName):c.getMessage(this.details),
this.linkData&&this.linkData.msg&&(this.linkData.msg=c.getMessage(this.linkData.msg)||this.linkData.msg));Error.captureStackTrace(this,g)};g.prototype=Object.create(Error.prototype);return g.prototype.constructor=g});define("qowtRoot/errors/qowtError",["qowtRoot/errors/localisedError"],function(e){var c=function(){e.apply(this,arguments);this.name="QOWTError";Error.captureStackTrace(this,c);this.fatal=!1};c.prototype=Object.create(e.prototype);c.prototype.constructor=c;return window.QOWTError=c});
define("qowtRoot/errors/qowtSilentError",["qowtRoot/errors/localisedError"],function(e){var c=function(){e.apply(this,arguments);this.name="QOWTSilentError";Error.captureStackTrace(this,c);this.fatal=!1;this.silent=!0};c.prototype=Object.create(e.prototype);c.prototype.constructor=c;return window.QOWTSilentError=c});
define("qowtRoot/errors/qowtException",["qowtRoot/errors/localisedError"],function(e){var c=function(){e.apply(this,arguments);this.name="QOWTException";Error.captureStackTrace(this,c);this.fatal=!0};c.prototype=Object.create(e.prototype);c.prototype.constructor=c;return window.QOWTException=c});
define("qowtRoot/errors/errorCatcher","qowtRoot/utils/typeUtils qowtRoot/messageBus/messageBus qowtRoot/pubsub/pubsub qowtRoot/errors/qowtError qowtRoot/errors/qowtSilentError qowtRoot/errors/qowtException".split(" "),function(e,c,g,a,k,n){function q(a){a.error?(console.error("%s caught js exception: %s",E,a.error.name||a.error.message?a.error.name+": "+a.error.message:a.error),console.error(a.error.stack),void 0===a.error.fatal&&(a.error.fatal=!0),l(a.error)):console.error(a)}function t(a,c){console.log("%s caught deprecated error",
E);console.log(c);c.isDeprecatedError=!0;l(c)}function l(g){if(g instanceof Error)void 0===g.fatal&&(g.fatal=!0);else{console.log("%s converting deprecated/bad error",E);switch(!0){case e.isObject(g)&&g.isDeprecatedError:var l={title:g.errorId?g.errorId+"_short_msg":void 0,details:g.errorId?g.errorId+"_msg":void 0,linkData:g.linkData,message:g.additionalInfo};g=g.fatal?new n(l):g.silent?new k(l):new a(l);break;case e.isNumber(g):g=new n({code:g});break;case e.isString(g):g=new n(g);break;default:g=
new n(g.toString())}g.stack=void 0}y.push(g);u(g);if(!g.isSynced){console.log("%s pushing error to msg bus",E);l=_.extend({},g);l.name=g.name;l.message=g.message;l.stack=g.stack;try{c.pushMessage({id:M,error:JSON.stringify(l)})}catch(q){}}}function u(a){console.log("%s dispatching error to observers",E);H.forEach(function(c){try{c.call(c,a)}catch(e){console.warn("Error observer %s threw an exception; ignored",c.name||""),console.warn(e.stack)}})}function r(a){if(a&&a.data&&a.data.error){console.log("%s receiving error from msg bus",
E);a=JSON.parse(a.data.error);var c={},c=["QOWTError","QOWTSilentError","QOWTException"];-1!=="Error EvalError RangeError ReferenceError SyntaxError TypeError URIError QOWTError QOWTSilentError QOWTException".split(" ").indexOf(a.name)?(console.log("cast to %s",a.name),-1!==c.indexOf(a.name)&&(a.localised=!0),c=new window[a.name](a)):(console.log("cast fallback to Error"),c=Error());_.extend(c,a);void 0===a.stack&&(c.stack=void 0);a=c;a.isSynced=!0;l(a)}}function w(a){return a&&a.data&&a.data.id===
M}var M="errorSync",H=[],E="sandbox"===window.name?"QOWT":"App",x,y=[];return{init:function(){x=g.subscribe("qowt:error",t);window.addEventListener("error",q);c.listen(r,w);Error.stackTraceLimit=Infinity},reset:function(){g.unsubscribe(x);window.removeEventListener("error",q);c.stopListening(r);H=[]},handleError:function(a){l(a)},addObserver:function(a){e.isFunction(a)?H.push(a):console.warn("Error observer must be a function")},observers:function(){return H},lastError:function(){return y[y.length-
1]}}});define("qowtRoot/errors/unique/fileDoesNotExistError",["qowtRoot/errors/qowtException"],function(e){var c=function(){this.title="file_does_not_exist_error_title";this.details="file_does_not_exist_error_details";this.gaState="FileDoesNotExistError";e.apply(this,arguments);this.name="FileDoesNotExistError";Error.captureStackTrace(this,c)};c.prototype=Object.create(e.prototype);return c.prototype.constructor=c});
define("qowtRoot/utils/tryUtils",["qowtRoot/utils/typeUtils"],function(e){var c=function(c){this.rethrowOnException=!1;this.optMsg=c};c.prototype={__proto__:Object.prototype,ignore:function(){return this.run.apply(this,arguments)},rethrow:function(){this.rethrowOnException=!0;return this.run.apply(this,arguments)},run:function(){var c=arguments[0],a=[].splice.call(arguments,1);try{return c.apply(null,a)}catch(k){this.optMsg&&(e.isString(this.optMsg)?console.warn(this.optMsg):console.dir(this.optMsg));
if(this.rethrowOnException){if(k instanceof Error)throw k;throw Error(k);}console.warn("Ignoring exception: ",k)}}};return{withWarning:function(e){return new c(e)},ignore:function(){if(!e.isFunction(arguments[0]))throw Error("ignore must be passed a function as first argument");var g=new c;return g.ignore.apply(g,arguments)},rethrow:function(){var e=new c;return e.rethrow.apply(e,arguments)}}});
define("controllers/appState",["qowtRoot/errors/errorCatcher","utils/analytics/googleAnalytics"],function(e,c){function g(c){a.updateState(c.gaState?c.gaState:c.fatal?"FatalCrash":"NonFatalError",{data_reason:c.message,data_fatal:c.fatal})}var a={init:function(){e.addObserver(g);a.updateState("Init")},setApp:function(a,e){c.setFileExt(e);c.setTracker(a)},updateState:function(a,e){k!==a&&(k=a,window.qowtState={state:k,context:e},c.sendState(k))}},k;return a});
define("utils/converter",[],function(){var e={app2Icon:function(c){return{word:"../img/doc.ico",sheet:"../img/xls.ico",point:"../img/ppt.ico"}[(c||"").toLowerCase()]},extension2Format:function(c){return{doc:"CBF",docx:"OOXML",docm:"OOXML",dot:"CBF",dotx:"OOXML",xls:"CBF",xlsx:"OOXML",xlsm:"OOXML",xlt:"CBF",xltx:"OOXML",csv:"CSV",ppt:"CBF",pptx:"OOXML",pptm:"OOXML",pot:"CBF",potx:"OOXML"}[(c||"").toLowerCase()]},extension2App:function(c){return{doc:"word",docx:"word",docm:"word",dot:"word",dotx:"word",
xls:"sheet",xlsx:"sheet",xlsm:"sheet",xlt:"sheet",xltx:"sheet",csv:"sheet",ppt:"point",pptx:"point",pptm:"point",pot:"point",potx:"point"}[(c||"").toLowerCase()]},extension2Mime:function(c){return{doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",docm:"application/vnd.ms-word.document.macroenabled.12",dot:"application/msword-template",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xls:"application/vnd.ms-excel",
xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlt:"application/vnd.ms-excel",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",csv:"text/csv",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",pptm:"application/vnd.ms-powerpoint.presentation.macroenabled.12",pot:"application/vnd.ms-powerpoint",potx:"application/vnd.openxmlformats-officedocument.presentationml.template"}[(c||
"").toLowerCase()]},app2FileName:function(c){return{word:"Document",point:"Presentation",sheet:"Spreadsheet"}[(c||"").toLowerCase()]},url2App:function(c){var a,e="";(c=(c||"").match(/.*\/([^\/?]*)/))&&(c=c[1].match(/.*\.([^\.]*)$/))&&(e=c[1]);switch(e.toLowerCase()){case "doc":case "docx":case "docm":a="word";break;case "xls":case "xlsx":case "xlsm":case "csv":a="sheet";break;case "ppt":case "pptx":case "pptm":a="point"}return a},mime2Extension:function(e){return c[(e||"").toLowerCase()]},mime2App:function(c){return e.extension2App(e.mime2Extension(c))},
mime2Icon:function(c){return e.app2Icon(e.mime2App(c))},mime2Format:function(c){return e.extension2Format(e.mime2Extension(c))},name2ext:function(c){var a="";(c=(c||"").match(/.*\.([^\.]*)$/))&&(a=c[1]);return a}},c={"application/msword":"doc","application/vnd.ms-word":"doc","application/vnd.msword":"doc","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","application/vnd.wordprocessing-openxml":"docx","application/vnd.ms-word.document.macroenabled.12":"docm","application/vnd.ms-word.document.12":"docm",
"application/vnd.openxmlformats":"docx","application/msword-template":"dot","application/vnd.openxmlformats-officedocument.wordprocessingml.template":"dotx","application/mspowerpoint":"ppt","application/vnd.ms-powerpoint":"ppt","application/vnd.openxmlformats-officedocument.presentationml.presentation":"pptx","application/vnd.presentation-openxml":"pptx","application/vnd.presentation-openxmlm":"pptx","application/vnd.ms-powerpoint.presentation.macroenabled.12":"pptm","application/vnd.openxmlformats-officedocument.presentationml.template":"potx",
"application/msexcel":"xls","application/vnd.ms-excel":"xls","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"xlsx","application/vnd.spreadsheet-openxml":"xlsx","application/vnd.ms-excel.sheet.macroenabled.12":"xlsm","application/vnd.openxmlformats-officedocument.spreadsheetml.template":"xltx","text/csv":"csv"};return e});
define("qowtRoot/errors/unique/httpErrorFileNotFound",["qowtRoot/errors/qowtException"],function(e){var c=function(){this.title="temporary_unable_to_open_error_short_msg";this.details="temporary_unable_to_open_error_msg";this.gaState="HTTPErrorFileNotFound";e.apply(this,arguments);this.name="HTTPErrorFileNotFound";this.message="HTTP ERROR: 404";Error.captureStackTrace(this,c)};c.prototype=Object.create(e.prototype);return c.prototype.constructor=c});
define("qowtRoot/errors/unique/httpErrorZero",["qowtRoot/errors/qowtException"],function(e){var c=function(){this.title="http_error_zero_short_msg";this.details="http_error_zero_msg";this.gaState="HTTPErrorZero";e.apply(this,arguments);this.name="HTTPErrorZero";this.message="HTTP ERROR: 0";Error.captureStackTrace(this,c)};c.prototype=Object.create(e.prototype);return c.prototype.constructor=c});
define("qowtRoot/errors/unique/timeoutError",["qowtRoot/errors/qowtException"],function(e){var c=function(){this.gaState="TimeoutError";e.apply(this,arguments);this.name="TimeoutError";Error.captureStackTrace(this,c)};c.prototype=Object.create(e.prototype);return c.prototype.constructor=c});
define("utils/retryHandler",[],function(){var e=function(){this.interval=1E3;this.maxInterval=6E4};e.prototype={__proto__:Object.prototype,maxedOut:function(){return this.interval>this.maxInterval},retry:function(c){setTimeout(c,this.interval);this.interval=this.nextInterval_()},reset:function(){this.interval=1E3},nextInterval_:function(){var c=2*this.interval+this.getRandomInt_(0,1E3);return Math.min(c,this.maxInterval)},getRandomInt_:function(c,e){return Math.floor(Math.random()*(e-c+1)+c)}};return e});
define("utils/xhr","qowtRoot/errors/qowtException qowtRoot/errors/unique/httpErrorFileNotFound qowtRoot/errors/unique/httpErrorZero qowtRoot/errors/unique/timeoutError qowtRoot/utils/typeUtils qowtRoot/third_party/when/when utils/retryHandler".split(" "),function(e,c,g,a,k,n,q){var t=function(a){this.method_=a.method||"GET";this.responseType_=a.responseType||"blob";this.url_=this.buildUrl_(a.baseUrl,a.params);this.authToken_=a.authToken;this.contentType_=a.contentType;this.deferred_=n.defer();this.kEstimatedDownloadChunks_=
20;this.timeoutLength_=6E5;this.remainingChunks_=this.kEstimatedDownloadChunks_;this.progress_=0;this.retryHandler_=new q;a.abortPromise&&(a.abortPromise=a.abortPromise.catch(function(){this.xhr_&&this.xhr_.abort&&this.xhr_.abort();this.deferred_.reject(Error("XHR canceled"))}))};t.prototype={__proto__:Object.prototype,send:function(a){this.xhr_=this.createXMLHttpRequest_();this.xhr_.send(a);this.startConnectionTimeout_();return this.deferred_.promise},createXMLHttpRequest_:function(){var a=new XMLHttpRequest;
"GET"===this.method_?a.onprogress=this.onProgress_.bind(this):a.upload.onprogress=this.onProgress_.bind(this);a.onload=this.onSuccess_.bind(this);a.onerror=this.onError_.bind(this);a.open(this.method_,this.url_,!0);a.responseType=this.responseType_;this.authToken_&&a.setRequestHeader("Authorization","Bearer "+this.authToken_);this.contentType_&&a.setRequestHeader("Content-Type",this.contentType_);return a},onSuccess_:function(a){this.clearConnectionTimeout_();if(4===a.target.readyState){var c=a.target.response||
a.target.responseText;if(200!==a.target.status&&0!==a.target.status||!c)if(0!==a.target.status&&200!==a.target.status||c)this.onError_(a);else this.deferred_.reject("HTTP ERROR: ABORTED");else{if("json"===a.target.responseType&&"string"===typeof c)try{c=JSON.parse(c)}catch(e){return this.deferred_.reject(Error("XHR response not valid JSON"))}this.deferred_.notify(1);this.deferred_.resolve(c)}}},onProgress_:function(a){this.resetConnectionTimeout_();a&&a.lengthComputable?this.progress_=(a.position||
a.loaded)/(a.totalSize||a.total):(a=this.remainingChunks_/this.kEstimatedDownloadChunks_,this.remainingChunks_-=a,this.progress_+=a/this.kEstimatedDownloadChunks_);this.deferred_.notify(this.progress_)},onError_:function(a){a.target.status&&(500<=a.target.status||429===a.target.status)?this.retry_(a):this.deferred_.reject(this.getErrorFromXhrStatus_(a.target.status))},retry_:function(a){this.retryHandler_.maxedOut()?this.deferred_.reject(this.getErrorFromXhrStatus_(a.target.status)):this.retryHandler_.retry(this.send.bind(this))},
getErrorFromXhrStatus_:function(a){return 0===a?new g:404===a?new c:new e("HTTP ERROR: "+a)},buildUrl_:function(a,c){var e=this.parseUrl_(a),g=this.buildQuery_(c);g&&(e+="?"+g);return e},buildQuery_:function(a){a=a||{};return Object.keys(a).map(function(c){return encodeURIComponent(c)+"="+encodeURIComponent(a[c])}).join("&")},parseUrl_:function(a){if(k.isString(a)){var c=a;c.match(/^http[s]?:\/\//)||c.match(/^blob:/)||c.match(new RegExp("^"+window.location.origin))||(a="http://"+a)}else throw Error("URL for XHR should be a string");
return a},startConnectionTimeout_:function(){this.timeout_=window.setTimeout(function(){var c=new a("XHR timed out");this.deferred_.reject(c)}.bind(this),this.timeoutLength_)},clearConnectionTimeout_:function(){window.clearTimeout(this.timeout_);delete this.timeout_},resetConnectionTimeout_:function(){this.clearConnectionTimeout_();this.startConnectionTimeout_()}};return t});
define("utils/fileEntry",[],function(){var e=function(c){this.writer=c};e.prototype={__proto__:Object.prototype,truncate:function(c){this.readyState=2;this.writer.truncate(c).then(this.onwrite,this.onerror)},write:function(c){var a=this;this.writer.write(c).then(function(){a.writer.close();a.onwrite()},this.onerror)}};var c=function(c,a){this.entry=c;this.uuid=a;this.isFile=!0};c.prototype={__proto__:Object.prototype,file:function(c){if(this.entry.file)this.entry.file(c);else if(this.entry.getFile)this.entry.getFile().then(c);
else throw Error("File not found.");},createWriter:function(c,a){if(this.entry.createWriter)this.entry.createWriter(c,a);else if(this.entry.createWritable)this.entry.createWritable().then(function(a){c(new e(a))},a);else throw Error("Writer not found.");}};return c});
define("utils/fileSystem",["utils/fileEntry"],function(e){var c={".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},g=function(){};g.prototype={__proto__:Object.prototype,chrome:{chooseEntry:function(a,c,e){console.log("FileSystem","chrome","chooseEntry");return window.chrome.fileSystem.chooseEntry({type:"saveFile",
suggestedName:a,accepts:[{extensions:c}]},function(a){return window.chrome.runtime.lastError&&"User cancelled"===window.chrome.runtime.lastError.message?e(Error(window.chrome.runtime.lastError.message)):e(null,a)})},getDisplayPath:function(a,c){console.log("FileSystem","chrome","getDisplayPath");return window.chrome.fileSystem.getDisplayPath(a,c)}},native:{chooseEntry:function(a,g,n){console.log("FileSystem","native","chooseEntry");try{var q={};q[c["."+g[0]]]=g;return window.showSaveFilePicker({suggestedName:a,
accept:q}).then(function(a){return n(null,new e(a))},function(a){return n(Error(a.message))})}catch(t){return console.warn(t),n("Something went wrong.")}},getDisplayPath:function(a,c){console.log("FileSystem","native","getDisplayPath");return a.file(function(a){return c(a.name)})}}};return new g});
define("utils/fileWriter",["qowtRoot/third_party/when/when","utils/analytics/googleAnalytics"],function(e,c){var g=function(a){this.entry=a;this.state=0};g.prototype={__proto__:Object.prototype,writeData:function(a){return this.createWriter_().then(this.truncateAndWrite_.bind(this,a)).then(function(){return this.entry}.bind(this))},createWriter_:function(){var a=e.defer();e(0===this.state).then(function(){this.entry.createWriter(a.resolve,a.reject)}.bind(this));return a.promise},writeOrResolve_:function(a,
e,g){if(2===e.readyState)switch(this.state){case 3:try{this.state=1,e.write(a)}catch(q){g.reject(Error(q))}break;case 1:this.state=0,g.resolve()}else c.sendException({msg:"Callback for write/ writeend called when FileWriter.readyState !== DONE",fatal:!1})},truncateAndWrite_:function(a,c){return e.promise(function(e,g){1===c.readyState&&g(Error("INVALID_STATE_ERR : Cannot write when the previous write is still in progress"));c.onwrite=this.writeOrResolve_.bind(this,a,c,{reject:g,resolve:e});c.onerror=
function(a){g(Error(a.currentTarget.error.message))};try{this.state=3,c.truncate(0)}catch(t){throw Error(t);}}.bind(this))}};return g});
define("utils/metrics",["qowtRoot/features/utils","qowtRoot/utils/typeUtils"],function(e,c){var g,a="doc docx docm xls xlsx xlsm ppt pptx pptm pps ppsx ppsm csv".split(" "),k="csvNonEmptyCellCount csvSheetCount csvFormattedCellCount docPageCount docSectionCount docParagraphCount docxPageCount docxSectionCount docxParagraphCount pptSlideCount pptMasterCount pptxSlideCount pptxMasterCount xlsNonEmptyCellCount xlsSheetCount xlsFormattedCellCount xlsxNonEmptyCellCount xlsxSheetCount xlsxFormattedCellCount".split(" ");return{recordFileType:function(c){if(c){var k=
g=c.toLowerCase();if(chrome&&chrome.metricsPrivate&&chrome.metricsPrivate.recordValue){var t;"Array"===a.constructor.name?(c=a.indexOf(k),t=a.length):(c=k,t=a);0>c||c>t?console.warn("Ignoring metrics record for unknown value: "+k):(k={metricName:"Quickoffice.FileFormat",type:"histogram-linear",min:1,max:t,buckets:t+1},e.isDebug()&&void 0===window.__umaMock?console.log("UMA not supported in debug mode"):chrome.metricsPrivate.recordValue(k,c))}}},recordCount:function(a){a=a||{};var q=g+(a.dataPoint||
"");a=a.value||0;if(c.isString(name)&&c.isNumber(a)&&c.isList(k)){var t,l;c.isList(k)?(l=k.indexOf(q),t=k.length):(l=q,t=k);if(!(0<=l&&l<=t))console.warn("Ignoring unknown metrics record "+q+" with value: "+a);else if(!e.isDebug()&&chrome&&chrome.metricsPrivate&&chrome.metricsPrivate)switch(t="Quickoffice."+q,q){case "docPageCount":case "docxPageCount":chrome.metricsPrivate.recordValue&&chrome.metricsPrivate.recordValue({metricName:t,type:"histogram-log",min:1,max:1E3,buckets:50},a);break;case "docParagraphCount":case "docxParagraphCount":chrome.metricsPrivate.recordMediumCount&&
chrome.metricsPrivate.recordMediumCount(t,a);break;case "csvSheetCount":case "docSectionCount":case "docxSectionCount":case "xlsSheetCount":case "xlsxSheetCount":case "pptSlideCount":case "pptxSlideCount":case "pptMasterCount":case "pptxMasterCount":chrome.metricsPrivate.recordSmallCount&&chrome.metricsPrivate.recordSmallCount(t,a);break;case "csvNonEmptyCellCount":case "xlsNonEmptyCellCount":case "xlsxNonEmptyCellCount":case "csvFormattedCellCount":case "xlsFormattedCellCount":case "xlsxFormattedCellCount":chrome.metricsPrivate.recordCount&&
chrome.metricsPrivate.recordCount(t,a);break;default:console.warn("Record count ignored unknown metric "+t)}}else console.warn("Metrics cannot record count - invalid parameters")}}});define("qowtRoot/utils/driveErrors",[],function(){return{OFFLINE:-1,AUTHENTICATION_TOKEN_NOT_ISSUED:400,INVALID_CREDENTIALS:401,FORBIDDEN:403,FILE_NOT_FOUND:404,CONVERT_FAILURE:413,INTERNAL_SERVER_ERROR:500,TIMEOUT:503}});
define("utils/gdrive/firstPartyAuth",["qowtRoot/third_party/when/when","qowtRoot/utils/driveErrors"],function(e,c){function g(){window[w]=void 0;window[t]=void 0;return e.resolve()}function a(){return k(q,u).then(function(){return k(q,l)}).then(function(){return k(q,r)}).then(function(){return Promise.reject({status:c.INVALID_CREDENTIALS})}).catch(function(a){return a?Promise.reject(a):Promise.resolve()})}function k(a,c){return new Promise(function(e,g){chrome.cookies.get({url:a,name:c},function(a){a&&
void 0!==a.value?(window[w]=a.value,g()):e()})})}function n(a,g,k,l){return e.promise(function(e,n){chrome.cookies.get({url:a,name:g},function(a){a&&void 0!==a.value?(window[k]=l?a.value:!!a.value,e()):n({status:c.INVALID_CREDENTIALS})})})}var q="https://*.google.com/",t="__OVERRIDE_SID",l="SAPISID",u="__Secure-1PAPISID",r="__Secure-3PAPISID",w="__SAPISID";return{setCookies:function(){return e.all([g(),a()])},setCookiesOlderWay:function(){return e.all([g(),n("http://*.google.com/","SID",t),n(q,l,
w,!0)])}}});define("utils/gdrive/driveUtils",[],function(){return{getErrorCode:function(e){return e&&e.result&&e.result.error&&e.result.error.code||e&&e.status},getErrorReason:function(e){return e&&e.result&&e.result.error&&e.result.error.errors&&e.result.error.errors[0]&&e.result.error.errors[0].reason},getErrorMessage:function(e){return e&&e.result&&e.result.error&&e.result.error.message||e&&e.statusText},isValidDriveId:function(e){return e&&/^[a-zA-Z0-9_-]+$/.test(e)}}});
define("utils/gdrive/authHeader",[],function(){function e(e,g,q){return c(e,g,q).then(function(c){return[a,c].join(" ")})}function c(a,c,e){var t=[],l=[],u=[];e.forEach(function(a){u.push(a.key);l.push(a.value)});var r=Math.floor((new Date).getTime()/1E3),t=0===l.length?[r,c,a]:[l.join(":"),r,c,a];return g(t.join(" ")).then(function(a){a=[r,a];0<u.length&&a.push(u.join(""));return a.join("_")})}function g(a){a=(new TextEncoder).encode(a);return crypto.subtle.digest("SHA-1",a).then(function(a){return Array.from(new Uint8Array(a)).map(function(a){return("00"+
a.toString(16)).slice(-2)}).join("").toLowerCase()})}var a="SAPISIDHASH";return{getAuthHeaderValueForFirstParty:function(a,c,g){var t=[];g&&t.push({key:"u",value:g});if(c)return e(a,c,t);throw Error("Invalid SessionCookie");}}});
define("utils/gdrive/gapiRequest",["utils/gdrive/authHeader"],function(e){function c(a){a.key=l;return Object.keys(a).map(function(c){return encodeURIComponent(c)+"="+encodeURIComponent(a[c])}).join("&")}function g(a,e){var g=c(e),g=/\?/.test(a)?g.length?"&"+g:"":g.length?"?"+g:"";return t+a+g}function a(a,c,g){a["x-clientdetails"]=k();"POST"===c&&(a["x-goog-authuser"]=0);a["x-goog-encode-response-if-executable"]="base64";"GET"===c&&(a["x-origin"]=u,a["x-referer"]=u);a["x-javascript-user-agent"]=
"google-api-javascript-client/1.1.0";a["x-requested-with"]="XMLHttpRequest";c=window.__SAPISID?e.getAuthHeaderValueForFirstParty(window.location.origin,window.__SAPISID,g):Promise.resolve();return c.then(function(c){c&&(a.authorization=c)})}function k(){return["appVersion","platform","userAgent"].map(function(a){var c=window.navigator[a];return encodeURIComponent(a)+"="+encodeURIComponent(c)}).join("&")}function n(a){r={headers:Object.fromEntries(a.headers.entries())||null,status:a.status||null,statusText:a.statusText||
null,ok:a.ok};return a.text()}function q(a){var c=[];a=a.replace(/(([\r\n]{0,2}[A-Za-z0-9+\/]){4,4}){0,1024}([\r\n]{0,2}[A-Za-z0-9+\/][\r\n]{0,2}[AQgw]([\r\n]{0,2}=){2,2}|([\r\n]{0,2}[A-Za-z0-9+\/]){2,2}[\r\n]{0,2}[AEIMQUYcgkosw048][\r\n]{0,2}=|([\r\n]{0,2}[A-Za-z0-9+\/]){4,4})[\r\n]{0,2}/g,function(a){c.push(window.atob(a));return""});return c.join("")}var t="https://clients6.google.com",l="AIzaSyD-qQA49y2Lv7b0KJCQghmHKe0iMHFnIts",u=chrome.runtime.getURL(""),r={},u=u.substring(0,u.lastIndexOf("/"));
return{sendGapiRequest:function(c,e){var k=c.path,l=Object.assign(c.params),t=c.headers?Object.assign(c.headers):{},u="GET"===c.method?!0:!1,B=g(k,l);return a(t,c.method,e).then(function(){var a={method:c.method,credentials:"include",headers:t};u||(a.body=c.body);return a}).then(function(a){return fetch(B,a)}).then(n).then(function(a){r.body=a;a=r;var c=a.headers;if(c&&"base64"===c["x-goog-safety-encoding"]){var e=q(a.body);c["Content-Type"]=c["x-goog-safety-content-type"];delete c["x-goog-safety-encoding"];
delete c["x-goog-safety-content-type"];a.body=e}a=r;if(c=204!==r.status)try{c=JSON.parse.call(JSON,r.body)}catch(g){c=!1}a.result=c;return r.ok?r:Promise.reject(r)})}}});
define("utils/gdrive/drive","qowtRoot/errors/errorCatcher qowtRoot/errors/qowtSilentError qowtRoot/utils/driveErrors utils/gdrive/firstPartyAuth utils/gdrive/driveUtils utils/gdrive/gapiRequest qowtRoot/third_party/when/when".split(" "),function(e,c,g,a,k,n,q){function t(){return N?q.resolve():a.setCookies().then(function(){N=!0})}function l(a,c){var e;da?e=q.resolve(da):(e={path:"/drive/v2/files/"+a,method:"GET",params:{updateViewedDate:!0,supportsTeamDrives:!0}},c&&(e.headers={"X-Goog-Drive-Resource-Keys":a+
"/"+c}),e=M(e,"Drive.getMetaData_").then(function(a){return da=a&&a.result}).catch(B));return e}function u(a,c){var e={path:"/drive/v2/files/"+a+"?alt=media",method:"GET",params:{supportsTeamDrives:!0}};c&&(e.headers={"X-Goog-Drive-Resource-Keys":a+"/"+c});return M(e,"Drive.download_").then(y).catch(B)}function r(a,c,e){a={path:"/drive/v2/files/"+a+"/copy",method:"POST",params:{convert:c,supportsTeamDrives:!0,alt:"json"},headers:{"content-type":"application/json"}};e.title&&(a.body=JSON.stringify({title:e.title}));
return M(a,"Drive.createFileFromDriveFile_")}function w(a,g,k){k&&k.mimeType||e.handleError(new c("Drive upload called with no mime type."));var l=q.defer(),n=new FileReader;n.readAsBinaryString(a);n.onload=function(){var a=k.mimeType,c=btoa(n.result),a="\r\n---------314159265358979323846\r\nContent-Type: application/json\r\n\r\n"+JSON.stringify(k)+"\r\n---------314159265358979323846\r\nContent-Type: "+a+"\r\nContent-Transfer-Encoding: base64\r\n\r\n"+c+"\r\n---------314159265358979323846--";g.headers=
g.headers?g.headers:{};g.headers["Content-Type"]='multipart/mixed; boundary="-------314159265358979323846"';g.body=a;M(g,"Drive.upload_").then(l.resolve,l.reject)};return l.promise}function M(c,e){var g=q.defer();n.sendGapiRequest(c,Z,e).then(g.resolve,function(c,k){E(k)?q.all([a.setCookies()]).done(function(){n.sendGapiRequest(c,Z,e).then(g.resolve,function(k){E(k)?q.all([a.setCookiesOlderWay()]).done(function(){n.sendGapiRequest(c,Z,e).then(g.resolve,x.bind(null,g,e))},function(a){g.reject(a)}):
x(g,e,k)})},function(a){g.reject(a)}):H(k)?n.sendGapiRequest(c,Z,e).then(g.resolve,x.bind(null,g,e)):x(g,e,k)}.bind(null,c));return g.promise}function H(a){var c=k.getErrorCode(a);a=k.getErrorReason(a);return c===g.INTERNAL_SERVER_ERROR||c===g.TIMEOUT||c===g.FORBIDDEN&&("rateLimitExceeded"===a||"userRateLimitExceeded"===a)}function E(a){a=k.getErrorCode(a);return a===g.INVALID_CREDENTIALS||a===g.AUTHENTICATION_TOKEN_NOT_ISSUED}function x(a,g,l){g+=" error:";var n=k.getErrorCode(l),q=k.getErrorMessage(l);
console.error([g,n,q].join(" "));e.handleError(new c([g,n].join(" ")));a.reject(l)}function y(a){a=a.body;for(var c=a.length,e=new ArrayBuffer(c),e=new Uint8Array(e),g=0;g<c;g++)e[g]=a.charCodeAt(g);return new Blob([e])}function B(a){throw a;}var N=!1,da,Z;return{getMetaData:function(a,c){return t().then(l.bind(null,a,c))},download:function(a,c){return t().then(u.bind(null,a,c))},upload:function(a,c,e,g){e={path:"/upload/drive/v2/files/"+a,method:"PUT",params:{newRevision:e?"true":"false",uploadType:"multipart",
alt:"json",supportsTeamDrives:!0}};g&&(e.headers={"X-Goog-Drive-Resource-Keys":a+"/"+g});return t().then(l.bind(null,a)).then(w.bind(null,c,e))},createFileFromDriveFile:function(a,c,e){return t().then(r.bind(null,a,c,e))},createFileFromNonDriveFile:function(a,c,e){c={path:"/upload/drive/v2/files/",method:"POST",params:{uploadType:"multipart",convert:c,supportsTeamDrives:!0}};"application/msword-template"===e.mimeType&&(e.mimeType="application/msword");return t().then(w.bind(null,a,c,e))},clearCachedMetaData:function(){da=
void 0},setUserId:function(a){Z=a}}});
define("ui/progressSpinner",["qowtRoot/features/utils"],function(e){function c(){u&&(u=!1,q.style.opacity="0")}function g(c,e){w[c].progress=1<e?1:0>e||void 0===e?0:e;var g=0,k=0,l=0,n;for(n in w)if(w.hasOwnProperty(n)&&void 0!==w[n].weight&&void 0!==w[n].progress){var q=w[n];"*"===q.weight?l=q.progress:(k+=q.weight,g+=q.progress*q.weight)}0<l&&(g+=l*(1-k));a(g)}function a(a){a=1<a?1:0>a||void 0===a?0:a;var e=parseInt(8*a,10);l&&l.getElementById("circular-progress").setAttribute("class",("editor"===
t?"dark":"light")+" p"+e);1===a&&setTimeout(c,100)}function k(){t=e.isEnabled("edit")?"editor":"viewer";q=document.createElement("div");q.style.display="none";q.classList.add(t);q.classList.add("progress-spinner-container");q.classList.add("fader");q.addEventListener("webkitTransitionEnd",function(){u||(a(0),q.style.display="none")},!1);n=document.createElement("embed");n.classList.add(t);n.classList.add("progress-spinner");n.src="../img/progressSpinner.svg";n.onload=function(){l=n.getSVGDocument()};
q.appendChild(n);var c=document.createElement("div");c.classList.add(t);c.classList.add("progress-spinner-label");c.textContent=chrome.i18n.getMessage("file_loading_spinner_label");q.appendChild(c);document.body.appendChild(q);M=!0}var n,q,t,l,u=!1,r=0,w={},M=!1;return{show:function(c){M||k();u||(u=!0,q.style.display="block",q.style.opacity="1");c&&a(c)},hide:function(){c()},setProgress:function(c){a(c)},addContributor:function(a){r++;var c="contrib"+r;w[c]={weight:a,progress:0};return g.bind(this,
c)},resetContributors:function(){w={};r=0}}});
define("qowtRoot/utils/pathUtils",["qowtRoot/utils/typeUtils"],function(e){return{create:function(c){return function(){var g={extension:function(){return k},dirName:function(){return q},baseName:function(){return n},fileName:function(){return a},smartBaseName:function(){var a=g.baseName();if(a)var c=/(-[0-9]+)$/g,e=a.match(c),a=e?a.replace(c,--e):a+"-1";return a}},a,k,n,q;(function(){if(c&&e.isString(c)){var g=c.lastIndexOf("/");q=-1!==g?c.substr(0,g+1):void 0;a=-1!==g?c.substr(g+1):c;g=a.lastIndexOf(".");
n=-1!==g?a.substr(0,g):a;var l=a.length;k=-1!==g?a.substr(g+1,l):void 0}})();return g}()}}});define("qowtRoot/errors/unique/scriptLoadingTimeout",["qowtRoot/errors/qowtException"],function(e){var c=function(){this.title="drive_open_timeout_error_short_msg";this.details="drive_open_timeout_error_msg";this.gaState="ScriptLoadingTimeout";e.apply(this,arguments);this.name="ScriptLoadingTimeout";Error.captureStackTrace(this,c)};c.prototype=Object.create(e.prototype);return c.prototype.constructor=c});
define("qowtRoot/utils/uuid",[],function(){return{generateUUID:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var g=(e+16*Math.random())%16|0;e=Math.floor(e/16);return("x"===c?g:g&7|8).toString(16)})}}});
define("qowtRoot/utils/localStorageManager",["qowtRoot/errors/qowtException"],function(e){return{setItem:function(c,g){try{window.localStorage.setItem(c,g)}catch(a){throw new e({title:"storage_quota_exceed_error_short_msg",details:"storage_quota_exceed_error_msg",message:a.message});}},getItem:function(c){return window.localStorage.getItem(c)}}});
define("controllers/fileManager","qowtRoot/third_party/when/when utils/converter utils/xhr utils/fileEntry utils/fileSystem utils/fileWriter utils/metrics utils/gdrive/drive utils/gdrive/driveUtils ui/progressSpinner controllers/appState qowtRoot/utils/i18n qowtRoot/utils/tryUtils qowtRoot/utils/pathUtils qowtRoot/errors/qowtException qowtRoot/errors/unique/httpErrorFileNotFound qowtRoot/errors/unique/httpErrorZero qowtRoot/errors/unique/timeoutError qowtRoot/errors/unique/scriptLoadingTimeout qowtRoot/utils/typeUtils qowtRoot/utils/driveErrors qowtRoot/utils/uuid qowtRoot/utils/localStorageManager utils/analytics/googleAnalytics third_party/lo-dash/lo-dash.min".split(" "),function(e,
c,g,a,k,n,q,t,l,u,r,w,M,H,E,x,y,B,N,da,Z,O,I,ea){var T,S={},C={},X=0,ma,jb=function(){};jb.prototype={__proto__:Object.prototype,sendMessageToWorker:function(a){var c=++X;a.msgId=c;return new Promise(function(e,g){S[c]=e;C[c]=g;T.postMessage(a)})},handleMessageFromWorker:function(a){a=a.data;if(6===a.type)_handleWASMMessage(a.message);else if(5===a.type)copyToPrivateFile();else if(3===a.type)S[a.msgId](a.fileContent);else if(a.error)C[a.msgId](a.error);else S[a.msgId]();delete S[a.msgId];delete C[a.msgId]},
init:function(a,c,g){this.config_=a;this.uuid_=c;this.srcFile_=g;this.isReady=!1;T=new Worker(chrome.runtime.getURL("scripts/controllers/wasmModuleUtilityWorker.js"));T.onerror=function(a){console.log(a)};T.onmessage=this.handleMessageFromWorker;return e.resolve().then(this.tryToRestoreOrDeleteFromCache_.bind(this)).catch(this.openOriginalFile_.bind(this)).then(this.whenDone_.bind(this))},getUUID:function(){return this.getCache().uuid},copyToPrivateFile:function(){var a=new n(this.config_.privateFile);
this.sendMessageToWorker({type:3,fileName:this.privateFilePath()}).then(function(c){a.writeData(new Blob([c]))})},updateConfigAndCache:function(a){a&&(this.config_.preferredFilename=this.config_.userFile.name,this.config_.userFile=void 0);this.config_.isDownloaded=!0;this.config_.isRenamed=a;this.cacheInfo_()},getCache:function(){var a=window.sessionStorage.getItem("__fileManagerCache");return M.ignore(JSON.parse.bind(JSON,a))||{}},getEntryPoint:function(){return ma},originalURL:function(){return _.get(this,
"config_.originalURL")},privateFilePath:function(){return this.returnFilePath_(_.get(this,"config_.privateFile",{}))},downloadFilePath:function(){return this.returnFilePath_(_.get(this,"config_.downloadFile",{}))},userFilePath:function(){return this.returnFilePath_(_.get(this,"config_.userFile",{}))},getWorker:function(){return T},mimeTypeFromFileName:function(a){return c.extension2Mime(c.name2ext(a))},mimeType:function(){var a=this.config_.mimeType;c.mime2App(a)||(a=this.userFilePath()||this.privateFilePath()||
this.originalURL(),a=H.create(a).extension()||this.config_.extension,a=c.extension2Mime(a));return a},displayName:function(){var a=_.get(this,"config_.preferredFilename",{});if(0<a.length)return a;var c;if(a=this.userFilePath()||this.originalURL()){a=H.create(a).fileName();try{c=window.decodeURIComponent(a)}catch(e){try{c=window.unescape(a)}catch(g){c=a}}}else c=this.config_.title;return c},driveDocId:function(){return _.get(this,"config_.driveDocId")},driveFileRole:function(){return _.get(this,"config_.driveFileRole")},
isNewDocument:function(){return _.get(this,"config_.newDocument")},isEmbedded:function(){return _.get(this,"config_.embedded")},createPrivateFile:function(a){this.config_.mimeType=c.extension2Mime(a);return this.createPrivateFile_(a).then(this.cacheInfo_.bind(this))},overwriteUserFile:function(c){if(this.config_.privateFile)if(this.config_.driveDocId||this.config_.userFile)if(this.config_.driveDocId)c=this.uploadDriveFile_(c);else{c=this.sendMessageToWorker({type:3,fileName:this.privateFilePath()}).then(function(a){return new File([a],
"temp")});var g=this;c=e.resolve(c).then(function(c){var e=g.srcFile_;g.config_.userFile instanceof a&&(e=g.config_.userFile);return g.copyFile_(c,e)})}else c=e.reject(Error("Cannot overwrite user file: No user or drive file"));else c=e.reject(Error("Cannot overwrite user file: private is file missing"));return c},newUserFile:function(a,c){function g(a){return t.createFileFromNonDriveFile(a,!1,l).catch(function(){return this.saveAsLocal_()}.bind(this))}var k,l;this.config_.privateFile?!this.config_.driveDocId||
c?k=this.saveAsLocal_(a):a?(l={title:this.nameForCopiedFile_()},k=t.createFileFromDriveFile(this.config_.driveDocId,!1,l)):(l={title:this.nameForSaveAsFile_(),mimeType:this.mimeType(),parents:[_.get(this,"config_.parents[0]")]},k=this.sendMessageToWorker({type:3,fileName:this.privateFilePath()}).then(function(a){return new Blob([a])}),k=e.resolve(k).then(g.bind(this))):k=e.reject(Error("Cannot create new user file: Private file missing"));return k},downloadToLocalFile:function(){this.getFileFromEntry_(this.config_.downloadFile).then(function(a){a=
new File([a],a.name,{type:this.mimeTypeFromFileName(a.name)});a=window.URL.createObjectURL(a);var c=this.tryAndGetDownloadFileName();chrome.downloads.download({url:a,filename:c,conflictAction:"uniquify",saveAs:!1})}.bind(this))},tryAndGetDownloadFileName:function(){var a=_.get(this,"config_.downloadFileName","downloadedFile"),e="."+(this.config_.extension?this.config_.extension:c.mime2Extension(this.mimeType()));try{a=a.replace(/[<>:"/\\|?*]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()}),
/(\.do[ct][xm]?|\.p[po]t[xm]?|\.xl[st][xm]?|\.csv)$/i.exec(a)||(a+=e)}catch(g){a="downloadedFile"+e}return a},convertToDocs:function(){var a={title:this.nameForConvertedFile_(),mimeType:this.mimeType()};return this.config_.driveDocId?t.createFileFromDriveFile(this.config_.driveDocId,!0,a):this.getFileFromEntry_(this.config_.privateFile).then(function(c){return t.createFileFromNonDriveFile(c,!0,a)})},cacheFileDetails:function(a){window.sessionStorage.setItem("__fileManagerCache",JSON.stringify(a))},
returnFilePath_:function(a){return a.fullPath||a.name},getFileType_:function(){var a;this.config_.driveDocId?a="driveDoc":this.config_.streamURL?a="stream":this.config_.userFile?a="userFile":this.config_.newDocument&&(a="newdocument");return a},getDriveDoc_:function(){return t.getMetaData(this.config_.driveDocId,this.config_.driveDocResourceKey).then(function(a){void 0===a.mimeType||void 0===a.title||void 0===a.id?a=void 0===c.mime2App(a.mimeType)?e.reject(Error("Drive mimeType not an MS Office mimeType")):
e.reject(Error("Drive document missing crucial information")):(this.config_.mimeType=a.mimeType,this.config_.extension=a.fileExtension,this.config_.title=a.title,this.config_.driveDocId=a.id,this.config_.parents=a.parents,this.config_.driveFileRole=_.get(a,"userPermission.role"),a=this.createPrivateFile_().then(this.updateInfoAndDownload_.bind(this,"DownloadingDriveDoc")));return a}.bind(this)).yield(!0)},getStream_:function(){return this.createPrivateFile_().then(this.updateInfoAndDownload_.bind(this,
"DownloadingStream")).yield(!0)},getUserFile_:function(){return this.createPrivateFile_().then(function(){this.updateAppStateAndCache_("LocalFile");return this.getFileFromEntry_(this.srcFile_||this.config_.userFile).then(function(a){return this.getArrayBuffer_(a)}.bind(this)).then(function(a){return this.sendMessageToWorker({type:2,fileName:this.privateFilePath(),fileContent:new Uint8Array(a)})}.bind(this)).then(function(){return this.copyFile_(this.srcFile_||this.config_.userFile,this.config_.privateFile)}.bind(this))}.bind(this))},
getArrayBuffer_:function(a){return a.arrayBuffer()},getNewDocument_:function(a){"word"===a?(this.config_.mimeType="application/vnd.openxmlformats-officedocument.wordprocessingml.document",this.config_.title="Untitled document.docx"):"point"===a?(this.config_.mimeType="application/vnd.openxmlformats-officedocument.presentationml.presentation",this.config_.title="Untitled presentation.pptx"):"sheet"===a&&(this.config_.mimeType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",this.config_.title=
"Untitled spreadsheet.xlsx");return this.createPrivateFile_().then(this.updateInfoAndLoadNewDocument_.bind(this,"LoadingNewDocument",a)).yield(!0)},updateInfoAndLoadNewDocument_:function(a,c){this.updateAppStateAndCache_(a);return this.loadNewDocument_(c)},getTemplateUrl_:function(a){if("word"===a)return"templates/blank.docx";if("point"===a)return"templates/blank.pptx";if("sheet"===a)return"templates/blank.xlsx"},loadNewDocument_:function(a){u.show();var c=u.addContributor(.9);a=this.getTemplateUrl_(a);
return(new g({baseUrl:chrome.runtime.getURL(a)})).send().then(function(a){(new n(this.config_.privateFile)).writeData(a);return a.arrayBuffer()}.bind(this)).then(function(a){return this.sendMessageToWorker({type:2,fileName:this.privateFilePath(),fileContent:new Uint8Array(a)})}.bind(this),void 0,c).then(function(){this.config_.isDownloaded=!0;this.cacheInfo_();c(1);u.hide()}.bind(this))},updateInfoAndDownload_:function(a){this.updateAppStateAndCache_(a);return this.download_()},updateAppStateAndCache_:function(a){this.initAppState_(a);
this.cacheInfo_()},restoreConfigFromCache_:function(a){this.config_.isDownloaded=a.isDownloaded;this.config_.isRenamed=a.isRenamed;this.config_.mimeType=a.mimeType||this.config_.mimeType;this.config_.extension=a.extension||this.config_.extension;this.config_.driveDocId=a.driveDocId||this.config_.driveDocId;this.config_.driveFileRole=a.driveFileRole||this.config_.driveFileRole;this.config_.newDocument=a.newDocument||this.config_.newDocument;this.config_.title=a.title||this.config_.title;this.config_.parents=
a.parents||this.config_.parents;this.config_.originalURL=a.originalURL||this.config_.originalURL},deleteFromCache_:function(a){return this.deletePrivateFile_(a).then(this.cacheFileDetails.bind(this,{}))},tryDeletingPrivateFile_:function(a){function c(){return e.reject(Error("IncompleteDownload"))}function g(){return e.reject(Error("CacheDeleteFailed"))}return a.privateFilePath?this.deleteFromCache_(a.privateFilePath).then(c,g):e.reject(Error("NoPrivateFile"))},tryToRestoreOrDeleteFromCache_:function(){var a;
(a=this.getCache())&&a.uuid===this.uuid_?a.isDownloaded?(ma="restore",this.restoreConfigFromCache_(a),a=this.tryToRestoreFiles_(a)):a=this.tryDeletingPrivateFile_(a):a=e.reject(Error("NoCache"));return a},saveFileEntryAndUpdateCache_:function(a){this.config_.userFile=a;this.cacheInfo_()},tryToRestoreFiles_:function(a){function g(){this.config_.downloadFileName=a.downloadFileName;this.updateAppStateAndCache_("BrowserRefresh");return a.userFileId?this.restoreFileById_(a.userFileId).then(this.saveFileEntryAndUpdateCache_.bind(this)).yield(!0):
!0}var k;a.privateFilePath?(k=c.mime2App(this.mimeType()),k=this.sendMessageToWorker({type:1,app:k,url:chrome.runtime.getURL("wasm/"+k+".js")}).then(this.restorePrivateFile_.bind(this,a.privateFilePath)).then(this.restoreDownloadFile_.bind(this,a.downloadFilePath)).then(this.restoreMEMFSFile_.bind(this)).then(g.bind(this))):k=e.reject(Error("There is no cached private file path"));return k},restoreMEMFSFile_:function(){return this.getFileFromEntry_(this.config_.privateFile).then(function(a){return a.arrayBuffer()}).then(function(a){return this.sendMessageToWorker({type:2,
fileName:this.privateFilePath(),fileContent:new Uint8Array(a)})}.bind(this))},nameForCopiedFile_:function(){return"Copy of "+this.displayName()},nameForSaveAsFile_:function(){return"Copy of "+H.create(this.displayName()).baseName()+"."+c.mime2Extension(this.mimeType())},nameForConvertedFile_:function(){return H.create(this.displayName()).baseName()},saveAsLocal_:function(a){var g=H.create(this.displayName()),k=this.config_.userFile&&!this.config_.isRenamed?g.smartBaseName():g.baseName(),l=c.mime2App(this.mimeType());
a=a?[g.extension()]:Cb[l];k+="."+(-1===a.indexOf(g.extension())?a[0]:g.extension());return this.selectFile_(k,a).then(function(a){this.config_.mimeType=void 0;this.config_.extension=void 0;this.config_.driveDocId=void 0;this.config_.driveFileRole=void 0;this.config_.preferredFilename=void 0;this.config_.newDocument=void 0;this.saveFileEntryAndUpdateCache_(a);return this.copyFile_(this.config_.privateFile,this.config_.userFile)}.bind(this),function(){return e.reject({userCancelled:!0})})},initAppState_:function(a){var e=
this.mimeType();if(e&&0!==e.length){var g=c.mime2App(e),k=window.navigator.onLine?"online":"offline",l="non-local-user-"+k;if(/^file:\/\/\//.test(this.originalURL())||this.userFilePath())l="local-user-"+k;this.sendCachableGAEvent_({category:"file-source",action:l,label:g});e=c.mime2Extension(e);q.recordFileType(e);r.setApp(g,e);r.updateState(a)}else throw Error("Unknown mimeType; unable to know which app to load");},sendCachableGAEvent_:function(a){if(window.navigator.onLine)ea.sendEvent(a);else{var c=
this.getGAPendingStore_();c.push(a);I.setItem("pending_ga",JSON.stringify(c))}},getGAPendingStore_:function(){var a;try{a=I.getItem("pending_ga"),a=JSON.parse(a),Array.isArray(a)||(a=[])}catch(c){a=[],console.warn("Failed to initialize file store so resetting it to be empty: "+c)}return a},whenDone_:function(){this.isReady=!0;return e.resolve(!0)},handleDriveError_:function(a){switch(l.getErrorCode(a)){case Z.FILE_NOT_FOUND:this.throwFileNotFoundException_();break;case Z.INTERNAL_SERVER_ERROR:case Z.OFFLINE:this.throwTemporaryUnableToOpenException_(a);
break;default:this.handleGenericFileError_(a)}},throwTemporaryUnableToOpenException_:function(a){throw new E({title:"temporary_unable_to_open_error_short_msg",details:"temporary_unable_to_open_error_msg",message:da.isString(a)&&a||a.message||l.getErrorCode(a)});},handleGenericFileError_:function(a){if("SecurityError"===a.name)this.throwSecurityException_();else if(a instanceof B)this.throwTimeoutException_(a);else{if(a instanceof y)throw a;if(a instanceof x)throw a;if(a instanceof N)throw a;this.throwFileOpenCrashException_(a)}},
throwEntryPointException_:function(){throw new E({title:"entry_point_error_short_msg",details:"entry_point_error_msg"});},throwSecurityException_:function(){throw new E({title:"file_opened_in_incognito_mode_error_title",details:"file_opened_in_incognito_mode_error_details"});},throwTimeoutException_:function(a){a.title=w.getMessage("download_file_timeout_error_short_msg");a.details=w.getMessage("download_file_timeout_error_msg");throw a;},throwFileNotFoundException_:function(){throw new E({title:"file_not_found_error_short_msg",
details:"file_not_found_error_msg"});},throwFileOpenCrashException_:function(a){var c=new E({title:"file_open_crash_error_short_msg",details:"file_open_crash_error_msg",message:da.isString(a)&&a||a.message||l.getErrorCode(a)});c.stack=a.stack;throw c;},cacheInfo_:function(){var a={originalURL:this.config_.originalURL,isDownloaded:this.config_.isDownloaded,streamURL:this.config_.streamURL,mimeType:this.config_.mimeType,extension:this.config_.extension,privateFilePath:this.privateFilePath(),downloadFilePath:this.downloadFilePath(),
downloadFileName:this.config_.downloadFileName,userFileId:this.config_.userFile&&window.RequestFileSystem&&k.chrome.retainEntry(this.config_.userFile),driveDocId:this.config_.driveDocId,newdocument:this.config_.newdocument,driveFileRole:this.config_.driveFileRole,title:this.config_.title,parents:this.config_.parents,isRenamed:this.config_.isRenamed,uuid:this.uuid_};this.cacheFileDetails(a)},restoreFileById_:function(a){return e.promise(function(c,e){window.RequestFileSystem?k.chrome.restoreEntry(a,
c):e(Error("NoAccessToFileSystem"))})},restorePrivateFile_:function(a){return this.getTempFs_().then(function(c){return a?this.openFileAndSaveEntry_(c,a,"privateFile"):this.createPrivateFile_()}.bind(this))},createDownloadableFile_:function(){return this.getTempFs_().then(function(a){return this.createDownloadableFileFromPrivateFile_(a)}.bind(this)).then(function(a){this.config_.downloadFile=a;this.config_.downloadFileName=this.displayName()}.bind(this))},restoreDownloadFile_:function(a){return this.getTempFs_().then(function(c){return a?
this.openFileAndSaveEntry_(c,a,"downloadFile"):this.createDownloadableFile_()}.bind(this))},download_:function(){u.show();var a=u.addContributor(.9);return(this.config_.driveDocId?t.download(this.config_.driveDocId,this.config_.driveDocResourceKey):void 0===this.config_.streamURL?e.reject(Error("FileManager needs URL to download")):(new g({baseUrl:this.config_.streamURL})).send()).then(function(a){return(new n(this.config_.privateFile)).writeData(a).then(function(){return a.arrayBuffer()})}.bind(this)).then(function(a){return this.sendMessageToWorker({type:2,
fileName:this.privateFilePath(),fileContent:new Uint8Array(a)})}.bind(this),void 0,a).then(function(){this.config_.isDownloaded=!0;this.cacheInfo_();a(1);u.hide()}.bind(this))},selectFile_:function(a,c){return e.promise(function(e,g){k.native.chooseEntry(a,c,function(a,c){a?g(a):k.native.getDisplayPath(c,function(a){c.localFilePath=a;c.fullPath=a;e(c)})}.bind(this))}.bind(this))},getTempFs_:function(){return e.promise(function(a,c){window.webkitRequestFileSystem(window.TEMPORARY,1048576,a,c)})},getFileFromFs_:function(a,
c,g){return e.promise(function(e,k){a.root.getFile(c,g,e,k)})},createFile_:function(a,c){return this.getFileFromFs_(a,c,{create:!0,exclusive:!1})},openFile_:function(a,c){return this.getFileFromFs_(a,c,{create:!1})},createDownloadableFileFromPrivateFile_:function(a){return e.promise(function(c,e){var g=this.config_.privateFile,k=g.name.split("."),k=[k[0],k[1]].join("_downloadable.");g.copyTo(a.root,k,c,e)}.bind(this))},deletePrivateFile_:function(a){return this.getTempFs_().then(function(c){return e.promise(function(e,
g){c.root.getFile(a,{create:!1},function(a){a.remove(e,g)})})})},createPrivateFile_:function(a){var e=a||c.mime2Extension(this.mimeType()),g=[O.generateUUID(),e].join(".");return this.getTempFs_().then(function(a,c,e){return this.createFile_(e,c)}.bind(this,a,g)).then(function(a,g){this.config_.privateFile=g;if(a)return Promise.resolve();var k=c.extension2App(e);return this.sendMessageToWorker({type:1,app:k,url:chrome.runtime.getURL("wasm/"+k+".js")})}.bind(this,a)).then(function(a,c){a&&this.sendMessageToWorker({type:2,
fileName:this.privateFilePath(),fileContent:new Uint8Array(0)});return this.config_.privateFile}.bind(this,a,g))},openFileAndSaveEntry_:function(a,c,e){return this.openFile_(a,c).then(function(a){return this.config_[e]=a}.bind(this))},copyFile_:function(a,c){function g(a,c){var k=new n(a);return"File"===c.constructor.name?k.writeData(c):e.reject("Cannot copy file: Source is not a File")}return void 0===c?e.reject(Error("Cannot copy file: Missing destination file")):c.isFile?void 0===a?e.reject(Error("Cannot copy file: Missing source file")):
a.file?this.getFileFromEntry_(a).then(g.bind(null,c)):g(c,a):e.reject("Cannot copy file: Destination is not a FileEntry/ a File")},uploadDriveFile_:function(a){var c=this.config_.driveDocId,e=this.config_.driveDocResourceKey;return this.sendMessageToWorker({type:3,fileName:this.privateFilePath()}).then(function(g){g=new Blob([g]);return t.upload(c,g,a,e)})},getFileFromEntry_:function(a){return e.promise(function(c,e){a.file?a.file(c):e(Error("Entry missing file function"))})},getPrivateFileFromEntry:function(){return this.getFileFromEntry_(this.config_.privateFile)},
openOriginalFile_:function(a){var c;switch(this.getFileType_()){case "driveDoc":l.isValidDriveId(this.config_.driveDocId_)?c=this.getDriveDoc_().catch(this.handleDriveError_.bind(this)):this.throwFileNotFoundException_();break;case "stream":c=this.getStream_().catch(this.handleGenericFileError_.bind(this));break;case "userFile":c=this.getUserFile_().catch(this.handleGenericFileError_.bind(this));break;case "newdocument":c=this.getNewDocument_(this.config_.newDocument).catch(this.handleGenericFileError_.bind(this));
break;default:this.throwEntryPointException_(a)}return c.then(this.createDownloadableFile_.bind(this)).then(this.cacheInfo_.bind(this))}};var Cb={word:["docx"],sheet:["xlsx"],point:["pptx"]};return new jb});
define("qowtRoot/utils/errorUtils",[],function(){return{stripStack:function(e){var c="";if(e=e.stack?e.stack.split("\n"):void 0)for(var c=c+(e[0]+";"),g=1;g<e.length;g++){var a=e[g].match(/\s*at\s*(\S*)\s*(\S*):(\d+):(\d+)\)/);if(a){a.shift();var k=a[1].lastIndexOf("/");a[1]=-1!==k?a[1].substr(k+1):a[1];c+=a.join(":")+";"}}return c},errorInfo:function(e){var c;e&&(c=e.e,e.e_info&&e.e_info.category&&(c+="; Category: "+e.e_info.category));return c},errorCode:function(e){return e&&e.split(";",1)[0]},
category:function(e){a:{e=e.split(";");for(var c=1;c<e.length;c++){var g=e[c].split(":");if("Category"===g[0].trim()){e=g[1].trim();break a}}e=""}return e}}});
define("errorObservers/gaExceptionLogger",["qowtRoot/pubsub/pubsub","qowtRoot/utils/errorUtils","utils/analytics/googleAnalytics"],function(e,c,g){var a="idle";e.subscribe("qowt:init",function(){a="idle"});return function(e){if("idle"===a){var n={msg:c.stripStack(e)||e.message||e.name||"unknown error",fatal:e.fatal};console.log("GA logging as:",n);g.sendException(n);a=e.fatal?"fatal exception logged":a}}});define("errorObservers/hideUI",["ui/progressSpinner"],function(e){return function(){e.hide()}});
define("errorObservers/showQOWT",[],function(){return function(e){e.silent||(document.getElementById("sandbox").style.display="block")}});
define("utils/analytics/performanceMetrics",["utils/analytics/googleAnalytics"],function(e){function c(a){var c=0,g=function(){c<a.length&&(e.sendEvent(a[c]),c++,g())};g()}function g(){var c=[],e=a.state.FF;a.actions.forEach(function(g){var t=a.logs.find(function(a){return a.action===g});t&&c.push({id:"recordEvent",category:"performance-metrics",action:t.action,label:e,value:t.value})});return c}var a={logs:[],state:{DCPSize:0,FF:""},lastLog:{CR:null,CC:null},actions:["CR","CC"]};return{log:function(e){a.logs.push(e);
a.lastLog.hasOwnProperty(e.action)&&(a.lastLog[e.action]=e);Object.keys(e.label).forEach(function(c){a.state[c]+=e.label[c]});if("CC"===e.action){var n=g();c(n)}}}});
define("utils/fileHandleStore",[],function(){var e=null,c={addFile:function(c,e){return new Promise(function(g,t){var l={uuid:c,fileHandle:e,timestamp:Date.now()},l=a("readwrite").add(l);l.onsuccess=function(a){console.log("addFile","File added successfully.");g()};l.onerror=function(a){console.error("addFile","Error adding file: "+a.target.error);t()}})},queryPromiseResults:function(a,c,e){a&&(a.onsuccess=function(a){(a=a.target.result)?c(a):c()},a.onerror=function(a){e()})},getFile:function(k){return new Promise(function(n,
q){var t=a("readonly"),l;t?(l=t.index("uuidIndex").get(k),c.queryPromiseResults(l,n,q)):e||g().then(function(g){g?(e=g,t=a("readonly"),l=t.index("uuidIndex").get(k),c.queryPromiseResults(l,n,q)):n()})})},editFile:function(c){return new Promise(function(e,g){var t=a("readwrite"),l=t.index("uuidIndex").get(c);l.onsuccess=function(a){(a=a.target.result)?(a.timestamp=Date.now(),a=t.put(a),a.onsuccess=function(a){console.log("editFile","Data updated successfully:",a.target.result);e()},a.onerror=function(a){console.error("editFile",
"Error updating data:",a.target.error);g()}):(console.log("editFile","Data not found."),e())};l.onerror=function(a){console.error("editFile","Error querying data:",a.target.error);g()}})},cleanUp:function(){var c=a("readwrite"),e=Date.now();c.openCursor().onsuccess=function(a){if(a=a.target.result)console.log("cleanUp",a.value),a.value.timestamp<e-1E4&&(console.log("cleanUp","Data cleaned up"),a.delete()),a.continue()}}},g=function(){return new Promise(function(a,c){var e=indexedDB.open("qoDB",1);
e.onerror=function(a){console.log("createDB","onerror");console.error("Database error: "+a.target.errorCode);c()};e.onsuccess=function(c){console.log("createDB","onsuccess");a(c.target.result)};e.onupgradeneeded=function(a){console.log("createDB","onupgradeneeded");a.target.result.createObjectStore("fileHandleStore",{keyPath:"id",autoIncrement:!0}).createIndex("uuidIndex","uuid",{unique:!0})}})},a=function(a){if(e)var c=e.transaction(["fileHandleStore"],a).objectStore("fileHandleStore");return c};
g().then(function(a){e=a});return c});define("utils/sendUserFeedback",["qowtRoot/errors/errorCatcher","qowtRoot/utils/errorUtils"],function(e,c){var g=[];e.addObserver(function(a){var e=a.fatal?"FATAL: ":"NonFatal: ",e=e+(c.stripStack(a)||a.message||a.name||"unknown error");g.push(e)});return{openFeedbackUI:function(){chrome.feedbackPrivate&&chrome.feedbackPrivate.openFeedback(chrome.feedbackPrivate.FeedbackSource.QUICKOFFICE)}}});
define("utils/urlUtils",["qowtRoot/utils/typeUtils"],function(e){return{parseURL:function(c){if(!e.isString(c))throw Error("Invalid URI");var g=c.split("?");c=g[0];var g=1<g.length?g[1]:"",a=this.parseQueryString(g);return{baseURL:c,queryString:g,queryObject:a}},parseQueryString:function(c){if(!e.isString(c))throw Error("Invalid QueryString");var g;if(c){g={};c=c.split(/[&;]/g);for(var a=0;a<c.length;a++)if(c[a]){var k=c[a].split("="),n=decodeURIComponent(k[0]).toLowerCase(),k=1<k.length?decodeURIComponent(k[1]):
void 0;g[n]=k}}return g},stripQueryString:function(){var c=this.parseURL(window.location.href);window.history.replaceState({},"",c.baseURL)}}});
define("qowtRoot/utils/chromeStorageManager",["qowtRoot/utils/localStorageManager"],function(e){return{setItem:function(c,e){return new Promise(function(a,k){var n={};n[c]=e;chrome.storage.local.set(n,function(){chrome.runtime.lastError?k(chrome.runtime.lastError):a()})})},getItem:function(c){return new Promise(function(g,a){chrome.storage.local.get(c,function(k){if(chrome.runtime.lastError)a(chrome.runtime.lastError);else if("undefined"===typeof k[c]){k=e.getItem(c);if("undefined"!==typeof k){var n=
{};n[c]=k;chrome.storage.local.set(n,function(){})}g(k)}else g(k[c])})})},isOfficeEditingModeSet:function(){return new Promise(function(c,e){this.getItem("always_use_office_editing_mode").then(function(a){c(a?!0:!1)}).catch(function(a){console.warn(a);c(!1)})}.bind(this))},setOfficeEditingModeSetting:function(c){this.setItem("always_use_office_editing_mode",c)}}});
!function(e,c){function g(g,r,u){var O=[];r=1==r?{entropy:!0}:r||{};g=q(n(r.entropy?[g,l(e)]:null==g?t():g,3),O);var I=new a(O),O=function(){for(var a=I.g(M),c=E,e=0;a<x;)a=(a+e)*w,c*=w,e=I.g(1);for(;a>=y;)a/=2,c/=2,e>>>=1;return(a+e)/c};return O.int32=function(){return 0|I.g(4)},O.quick=function(){return I.g(4)/4294967296},O.double=O,q(l(I.S),e),(r.pass||u||function(a,e,g,l){return l&&(l.S&&k(l,I),a.state=function(){return k(I,{})}),g?(c[H]=a,e):a})(O,g,"global"in r?r.global:this==c,r.state)}function a(a){var c,
e=a.length,g=this,k=0,l=g.i=g.j=0,n=g.S=[];for(e||(a=[e++]);k<w;)n[k]=k++;for(k=0;k<w;k++)n[k]=n[l=B&l+a[k%e]+(c=n[k])],n[l]=c;(g.g=function(a){for(var c,e=0,k=g.i,l=g.j,n=g.S;a--;)c=n[k=B&k+1],e=e*w+n[B&(n[k]=n[l=B&l+c])+(n[l]=c)];return g.i=k,g.j=l,e})(w)}function k(a,c){return c.i=a.i,c.j=a.j,c.S=a.S.slice(),c}function n(a,c){var e,g=[],k=typeof a;if(c&&"object"==k)for(e in a)try{g.push(n(a[e],c-1))}catch(l){}return g.length?g:"string"==k?a:a+"\x00"}function q(a,c){for(var e,g=a+"",k=0;k<g.length;)c[B&
k]=B&(e^=19*c[B&k])+g.charCodeAt(k++);return l(c)}function t(){try{var a;return u&&(a=u.randomBytes)?a=a(w):(a=new Uint8Array(w),(r.crypto||r.msCrypto).getRandomValues(a)),l(a)}catch(c){return a=r.navigator,[+new Date,r,a&&a.plugins,r.screen,l(e)]}}function l(a){return String.fromCharCode.apply(0,a)}var u,r=this,w=256,M=6,H="random",E=c.pow(w,M),x=c.pow(2,52),y=2*x,B=w-1;if(c["seed"+H]=g,q(c.random(),e),"object"==typeof module&&module.exports){module.exports=g;try{u=require("crypto")}catch(N){}}else"function"==
typeof define&&define.amd&&define("third_party/seedrandom/seedrandom.min",[],function(){return g})}([],Math);define("utils/timeUtils",[],function(){return{DAY_IN_MS:864E5,WEEK_IN_MS:6048E5,weekSinceEpoch:function(){var e=Date.now()/this.WEEK_IN_MS;return Math.ceil(e)}}});
define("common/elements/google-consumer-survey/google-consumer-survey",["qowtRoot/utils/localStorageManager","qowtRoot/utils/uuid","third_party/seedrandom/seedrandom.min","utils/timeUtils"],function(e,c,g,a){var k=90*a.DAY_IN_MS;window.GoogleConsumerSurvey=Polymer({is:"google-consumer-survey",properties:{siteId:{reflect:!1,value:""},targetPercentage:{reflect:!1,value:void 0},bucketing:{reflect:!1,value:void 0}},created:function(){this.UUID=e.getItem("__GCS_uuid")||c.generateUUID();e.setItem("__GCS_uuid",
this.UUID);window._402=window._402||{};window._402.promptHandlerUrl="https://www.google.com/insights/consumersurveys/gk/prompt"},attached:function(){this.shouldLaunchSurvey_()&&this.launchSurvey_()},shouldLaunchSurvey_:function(){var c=!1;this.targetPercentage||this.bucketing?this.surveyResultsStale_(a.WEEK_IN_MS)&&(c=this.sampleUser_()):c=this.surveyResultsStale_(k);return c},sampleUser_:function(){var c=!1,e=parseInt(this.UUID.split("-")[1],16),k=this.bucketing?65535/this.bucketing:65535,l=a.weekSinceEpoch(),
u=l%(this.bucketing||1)*k;e>=u&&e<u+k&&(this.fire("user-considered-for-sampling"),g(e*l)()<(void 0===this.targetPercentage?1:this.targetPercentage/100)&&(this.fire("user-sampled-for-survey"),c=!0));return c},surveyResultsStale_:function(a){var c=!0,g=e.getItem("__GCS_site_"+this.siteId);g&&(c=Date.now()-g>a);return c},launchSurvey_:function(){this.siteId&&0!==this.siteId.length&&this.parentNode?(this.scriptTag=document.createElement("script"),this.scriptTag.src="https://www.google.com/insights/consumersurveys/async_survey?force_http=1&site="+
this.siteId,this.appendChild(this.scriptTag),this.userSurveyed=!0,e.setItem("__GCS_site_"+this.siteId,Date.now())):console.warn("<google-consumer-survey>: missing siteId!")}});return{}});
define("monkeyLoader",["qowtRoot/features/utils"],function(e){function c(a,c,e){c([a],function(a){g++;e(a)},function(c){0===g?(console.warn("Failed to load "+a+". The monkey server is likely not running."),e()):(console.error("Monkey _is_ running, but we failed to laod module "+a+"."),console.error(c),console.error(c.stack))})}var g=0;return{load:function(a,g,n){g=g||"";e.isDebug()?(console.log("Loading "+a),c.apply(this,arguments)):n()}}});
define("controllers/application","qowtRoot/errors/errorCatcher qowtRoot/errors/qowtException qowtRoot/errors/unique/fileDoesNotExistError qowtRoot/utils/typeUtils qowtRoot/utils/tryUtils qowtRoot/utils/promiseUtils qowtRoot/utils/platform qowtRoot/messageBus/messageBus qowtRoot/features/utils controllers/appState controllers/fileManager errorObservers/gaExceptionLogger errorObservers/hideUI errorObservers/showQOWT utils/analytics/performanceMetrics utils/analytics/googleAnalytics utils/converter utils/fileEntry utils/fileHandleStore utils/metrics utils/sendUserFeedback utils/gdrive/driveUtils utils/urlUtils qowtRoot/third_party/when/when utils/gdrive/drive qowtRoot/utils/uuid qowtRoot/pubsub/pubsub qowtRoot/utils/localStorageManager qowtRoot/utils/chromeStorageManager common/elements/google-consumer-survey/google-consumer-survey".split(" "),function(e,
c,g,a,k,n,q,t,l,u,r,w,M,H,E,x,y,B,N,da,Z,O,I,ea,T,S,C,X,ma){function jb(){L.app=y.mime2App(r.mimeType());var a=y.mime2Extension(r.mimeType()),c=!("docm"!==a&&"pptm"!==a&&"xlsm"!==a);r.getPrivateFileFromEntry().then(function(e){t.pushMessage({id:"openFile",displayName:r.displayName(),originalURL:r.originalURL(),userFileType:Fa(),entryPoint:r.getEntryPoint(),driveFileReadOnly:"reader"===r.driveFileRole(),format:y.mime2Format(r.mimeType()),isRenamed:r.getCache().isRenamed,environment:L,isMacroEnabledFile:c,
newDocument:r.isNewDocument(),embedded:r.isEmbedded(),isIncognito:ya,extension:a,fileSize:e.size})})}function Cb(c){if(!a.isString(c)&&!a.isObject(c))throw Error("Invlid content from Core");if(a.isString(c))c=k.withWarning("JSON Syntax error in content from Core").rethrow(JSON.parse.bind(JSON,c)),"NaClCrash"===c.name&&(Va=!0);else if(Va){var e=c;console.error("reporting minidump to local server");var g=new FormData;g.append("prod","Quickoffice");g.append("ver",chrome.runtime.getManifest().version);
g.append("upload_file_minidump",new Blob([e]));e=new XMLHttpRequest;e.open("POST",chrome.runtime.getManifest().crash_dump_server,!0);e.send(g);C.publish("app:naclCrash")}Va||t.pushMessage({id:"dcp",content:c})}function m(a){if(a.keyCode&&(a.metaKey||a.ctrlKey))switch(a.keyCode){case 80:a.preventDefault();t.pushMessage({id:"print"});break;case 83:a.preventDefault()}}function la(){kb(W);za({category:"network-status",action:window.navigator.onLine?"online":"offline"});return ea.promise(function(a){chrome.identity.getProfileUserInfo(function(c){c=
""!==c.email;var e=window.navigator.onLine;za({category:"account-status",action:c?"signed-in":"signed-out"});za({category:"account-network",action:c?e?"signedin-online":"signedin-offline":e?"signedout-online":"signedout-offline"});a()}.bind(this))}.bind(this)).timeout(3E3,"Timed-out waiting for identity info").catch(function(){})}function za(a){window.navigator.onLine?x.sendEvent(a):"file-open"===a.category?Aa(Ga,a):Aa(W,a)}function Aa(a,c){var e=Wa(a);e.push(c);X.setItem(a,JSON.stringify(e))}function kb(a){if(window.navigator.onLine){var c=
Wa(a);if(0<c.length)for(var e=0;e<c.length;e++)c[e]&&"object"===typeof c[e]&&x.sendEvent({category:c[e].category,action:c[e].action,label:c[e].label});X.setItem(a,JSON.stringify([]))}}function Wa(a){var c;try{c=X.getItem(a),c=JSON.parse(c),Array.isArray(c)||(c=[])}catch(e){c=[],console.warn("Failed to initialize file store so resetting it to be empty: "+e)}return c}function Ha(){window.navigator.connection.onchange=function(a){window.navigator.onLine&&0<Wa(Ga).length&&"opening"!==qowtState&&kb(Ga)}}
function lb(){return new Promise(function(a,c){chrome&&chrome.tabs&&chrome.tabs.get?chrome.tabs.get(Ma,function(e){e?(ya=e.incognito,a()):c(Error("Missing tab for tabId "+Ma))}):c(Error("Missing chrome.tabs API"))})}function Za(){var a=ea.defer();Db().then(function(c){Ma=c.tabId;a.resolve()},function(){chrome&&chrome.tabs&&chrome.tabs.getCurrent?chrome.tabs.getCurrent(function(c){c&&c.id?(Ma=c.id,a.resolve()):a.reject(Error("Missing tab id"))}):a.reject(Error("Missing chrome.tabs API"))});return Promise.race([a.promise,
n.delayThenReject(3E4,Error("Requesting current tab id timed out"))])}function nc(){t.listen(id,Pb);t.listen(Xc,kc);return Promise.resolve()}function Db(){null===ra&&(ra=new Promise(function(a,c){chrome.mimeHandlerPrivate.getStreamInfo(function(e){chrome.runtime.lastError?c(chrome.runtime.lastError):a(e)})}));return ra}function p(a,e){return Yc().then(function(g){return g?a(g):e(new c("File not found."))},function(a){return e(new c("File not found."))})}function wb(){return new Promise(function(a,
c){return qd().then(function(e){e&&N&&N.getFile(e).then(function(c){if(c)qa=new B(c.fileHandle,e),c.fileHandle.getFile().then(function(c){return a(e)},function(g){chrome.runtime.sendMessage({type:"getFileDetails",uuid:e},function(a){var c;a.driveDocId?c="double-tap":a.streamURL?c="stream":a.userFile?c="drag-n-drop":a.newDocument&&(c="new-document");x.sendEvent({category:"file-reopen",action:c})});var k=document.getElementById("reloadBlock");k&&(k.style.display="block",document.getElementById("reload-button").onclick=
function(){var g={};c.fileHandle&&(g.mode="readwrite");c.fileHandle.requestPermission(g).then(function(c){if("granted"===c)return k.style.display="none",a(e);window.close()},function(a){return!1})})});else return a(e)});if(!e)return p(a,c)},function(e){return p(a,c)})})}function Yc(){return bd().then(function(){if(qa&&qa.uuid)return r.cacheFileDetails({uuid:qa.uuid}),qa.uuid})}function qd(){return Promise.all([Db()]).then(function(a){var c=r.getCache(),e=a[0];if(c&&c.originalURL===e.originalUrl)throw chrome.mimeHandlerPrivate.abortStream(),
Error("Load from cache");return new Promise(function(c,e){chrome.runtime.sendMessage({type:"registerMimeHandlerStream",streamInfo:JSON.stringify(a[0])},function(a){a&&a.uuid?c(a.uuid):e()})})}).catch(function(){var a=I.parseURL(window.location.href);a.queryObject?(r.cacheFileDetails(a.queryObject),I.stripQueryString()):a.queryObject=r.getCache();if(a.queryObject.state)return rd(a.queryObject.state);if(a.queryObject.uuid)return a.queryObject.uuid})}function rd(a){return new Promise(function(e,g){var f=
JSON.parse(a);chrome.runtime.sendMessage({type:"handleDriveDoc",docIds:f.ids,resourceKeys:f.resourceKeys},function(a){try{T.setUserId(f.userId),e(a.uuid)}catch(k){g(new c({title:"something_not_right",details:"file_not_found_error_msg"}))}})})}function sd(e){return new Promise(function(g,k){Ja=e[1];a.isString(Ja)||k(Error("Failed to get a valid UUID"));chrome.runtime.sendMessage({type:"getFileDetails",uuid:Ja},function(a){a||k(new c("Missing FileDetails object"));a=Object.create(a);window.copyToPrivateFile=
r.copyToPrivateFile.bind(r);r.init(a,Ja,qa).then($c).then(function(){g()}).catch(function(a){k(a)})})})}function Pb(a){var c=!1;a&&a.data&&"dcpRequest"===a.data.id&&(c=!0);return c}function kc(a){return!Pb(a)}function vd(){ma.getItem("onboardingComplete").then(function(a){var c=chrome.i18n.getMessage("@@ui_locale");a&&c.match(/en[-_]us/i)&&!l.isDebug()&&l.isEnabled("hats")&&window.setTimeout(function(){var a={word:{siteId:"wtkwz5qvgh3olklj43wihw3lhi",rate:3},sheet:{siteId:"renjicjirwkihjol6bv5k5q7hm",
rate:8},point:{siteId:"4jgyc2mhqmpdwpatxatmggghiq",rate:4}},c=y.mime2App(r.mimeType());if(a[c]){var e=md();e.siteId=a[c].siteId;e.targetPercentage=a[c].rate;e.bucketing=12;document.body.appendChild(e)}},3E3)}).catch(function(a){console.warn("Error occurred while fetching the item `onboardingComplete` from the Chrome storage"+a)})}function md(){var a=document.createElement("google-consumer-survey");a.addEventListener("user-considered-for-sampling",function(){x.sendEvent({category:"user-survey",action:"sampling",
label:"user-consired"})});a.addEventListener("user-sampled-for-survey",function(){x.sendEvent({category:"user-survey",action:"sampling",label:"user-sampled"})});return a}function id(a){if(a&&a.data&&a.data.content)if(a=a.data.content,-1!=="writeToExisting writeToNew writeToExistingDriveFile convertToDocs makeACopy download".split(" ").indexOf(a.name))Lc(a);else{var c=Wc;switch(a.name){case "oPT":case "oDC":case "owb":a.pa=r.privateFilePath();c(a);break;case "sDC":"OOXML"===y.mime2Format(r.mimeType())?
c(a):r.createPrivateFile("docx").done(jd.bind(ha,a,c));break;case "saveWkbk":"OOXML"===y.mime2Format(r.mimeType())?ib(a,c):r.createPrivateFile("xlsx").done(ib.bind(ha,a,c));break;case "sPT":"OOXML"===y.mime2Format(r.mimeType())?ib(a,c):r.createPrivateFile("pptx").done(ib.bind(ha,a,c));break;default:c(a)}}else throw Error("DCP Requests must have content");}function jd(a,c){a.name="saveAs";a.dst=r.privateFilePath();c(a)}function ib(a,c){a.dst=r.privateFilePath();c(a)}function Lc(a){switch(a.name){case "writeToExisting":r.overwriteUserFile().then(lc.bind(ha,
a.name,r.userFilePath()),Ka.bind(ha,a.name));break;case "writeToNew":r.newUserFile(!1,a.context&&a.context.toLocal).then(lc.bind(ha,a.name,r.userFilePath()),Nb.bind(ha,a.name)).done(function(){},Ka.bind(ha,a.name));break;case "makeACopy":Ka(a.name);r.newUserFile(!0).done(ec.bind(ha,r.userFilePath()),nd);break;case "writeToExistingDriveFile":Ka(a.name);r.overwriteUserFile(a.newRevision).finally(ud.bind(ha,a.token),td.bind(ha,a.token));break;case "convertToDocs":Ka(a.name);r.convertToDocs().done(Nc,
od);break;case "download":yb&&(chrome.downloads.onDeterminingFilename.addListener(function R(a,c){c({filename:r.tryAndGetDownloadFileName(),conflictAction:"uniquify"});chrome.downloads.onDeterminingFilename.removeListener(R);yb=!0}),yb=!1,r.downloadToLocalFile());Ka(a.name);break;default:console.log("#!#! Unexpected processAppRequest "+a.name)}}function fc(a){return ea.promise(function(c){Na(xb(a),c)})}function Mc(a){return ea.promise(function(c){var e=xb(a);chrome&&chrome.tabs&&e&&chrome.tabs.update(Ma,
{url:e},c)})}function xb(a){var c,e=a.result?a.result.alternateLink:void 0,f=y.extension2Format(a.result?a.result.fileExtension:void 0);if(e&&!e.match(/.*\/file\/.*/)&&!f)c=e,c=(a=c.match(/(.*)\?(.*)/))?a[2]&&0<a[2].length?c+"&nativeconvert=1":c+"nativeconvert=1":c+"?nativeconvert=1";else if(!e||e.match(/.*\/file\/.*/)||f)c="chrome-extension://"+chrome.runtime.id+'/views/app.html?state={"ids":["'+a.result.id+'"],"action":"open"}';return c}function lc(a,c,e){r.userFilePath()!==c&&ia();"writeToNew"===
a&&"drive"===Fa()?Mc(e).then(Ka.bind(ha,a)):Ka(a);t.pushMessage({id:"userFileNotification",context:{type:"saveSuccess",format:y.mime2Format(r.mimeType()),userFileType:Fa(),isRenamed:void 0,localFilePath:"local"===Fa()?e.localFilePath:"",driveFileReadOnly:"reader"===r.driveFileRole()}})}function Nb(a){t.pushMessage({id:"dcp",content:{name:a,userCancelled:!0,format:y.mime2Format(r.mimeType()),userFileType:Fa(),driveFileReadOnly:"reader"===r.driveFileRole()}});t.pushMessage({id:"userFileNotification",
context:{type:"saveCancel"}})}function ud(a){t.pushMessage({id:"driveFileNotification",context:{type:"saveSuccess",saveToken:a}})}function td(a,c){t.pushMessage({id:"driveFileNotification",context:{type:"saveFailure",saveToken:a,errorCode:O.getErrorCode(c)}})}function Nc(a){var c=ka;t.pushMessage({id:"driveFileNotification",context:{type:"convertSuccess"}});ka=!1;if(!c)return fc(a)}function od(a){var c=ka;ka=!1;c||t.pushMessage({id:"recordEvent",category:"menu",action:"convertToDocsFailed"});t.pushMessage({id:"driveFileNotification",
context:{type:"convertFailure",errorCode:O.getErrorCode(a)}})}function ec(a,c){"drive"===Fa()?fc(c):(document.title=r.displayName(),r.userFilePath()!==a&&ia(),t.pushMessage({id:"localFileNotification",context:{type:"copySuccess",displayName:r.displayName(),format:y.mime2Format(r.mimeType()),userFileType:Fa(),driveFileReadOnly:!1}}))}function nd(a){"drive"===Fa()&&(t.pushMessage({id:"recordEvent",category:"menu",action:"makeCopyFailed"}),t.pushMessage({id:"driveFileNotification",context:{type:"copyFailure",
errorCode:O.getErrorCode(a)}}))}function Ka(a,c){document.title=r.displayName();t.pushMessage({id:"dcp",content:{name:a,displayName:r.displayName(),format:y.mime2Format(r.mimeType()),userFileType:Fa(),driveFileReadOnly:"reader"===r.driveFileRole(),e:c&&c.message||c}})}function Wc(a){Ua=a.name;a=a instanceof ArrayBuffer?a:k.withWarning("Msg to Core must be JSON").rethrow(JSON.stringify.bind(JSON,a));r.getWorker().postMessage({type:4,buffer:a,command:Ua})}function Fa(){var a;r.userFilePath()?a="local":
r.driveDocId()&&(a="drive");return a}function Xc(a){if(a&&a.data)switch(a.data.id){case "closeApp":window.close();break;case "reportAnIssue":Z.openFeedbackUI();break;case "showHelp":case "signIntoDrive":Na(a.data.link);break;case "recordCount":da.recordCount(a.data.context);break;case "stateChange":a=a.data.data;u.updateState(a.state,a.context);break;case "recordEvent":x.sendEvent(a.data);break;case "recordCachableEvent":za(a.data);break;case "createNewTab":Na(a.data.link);break;case "conversionCancelled":ka=
!0;break;case "reloadTab":if(Ma&&chrome&&chrome.tabs){chrome.tabs.reload(Ma);break}window.location.reload();break;case "setBlockUnload":chrome.mimeHandlerPrivate&&chrome.mimeHandlerPrivate.setShowBeforeUnloadDialog&&chrome.mimeHandlerPrivate.setShowBeforeUnloadDialog(!!a.data.blockUnload);break;case "fileNotFound":r.updateConfigAndCache(!0);break;case "fileSaveSuccess":r.updateConfigAndCache();t.pushMessage({id:"updateFileInfo"});break;case "performanceMetrics":E.log(a.data)}}function Na(a,c){chrome&&
chrome.tabs&&a&&a.match(/^https?:\/\/|^file:\/\/|^mailto:/i)&&chrome.tabs.create({url:a},c)}function $c(){pd();ad();ia();mb();dd();lb().then(function(){ha.openFile()}).catch(function(){ya=!1;ha.openFile()})}function Bb(a){var c={"2K3":"doc ppt xls dot pot xlt".split(" "),"2K7":"docx pptx xlsx dotx potx xltx docm pptm xlsm".split(" "),CSV:["csv"]},e;Object.keys(c).every(function(f){return c[f].includes(a)?(e=f,!1):!0});return e}function pd(){r.getPrivateFileFromEntry().then(function(a){var c=y.mime2Extension(r.mimeType());
E.log({category:"PERF_LOG",action:"SC",label:{FF:Bb(c)},value:window.performance.now()});x.sendEvent({id:"recordEvent",category:"raw-data",action:"ViewingFullContent",label:"fileSize_bytes",value:a.size});x.sendEvent({id:"recordEvent",category:"raw-data",action:"file-ready",label:c})})}function ad(){return new Promise(function(a){chrome.runtime.sendMessage({type:"cacheTabId",uuid:Ja,tabId:Ma},function(){a()})})}function ia(){return new Promise(function(a){chrome.runtime.sendMessage({type:"cachePrivateFilePath",
uuid:Ja,privatePath:r.privateFilePath()},function(){a()})})}function mb(){return new Promise(function(a){chrome.runtime.sendMessage({type:"cacheDownloadFile",uuid:Ja,downloadFilePath:r.downloadFilePath()},function(){a()})})}function dd(){return new Promise(function(a){chrome.runtime.sendMessage({type:"cacheTimestamp",uuid:Ja},function(){a()})})}function cd(a){var c={csv:["text/csv"],doc:["application/msword","application/vnd.ms-word","application/vnd.msword","application/vnd.ces-quickword"],docm:["application/vnd.ms-word.document.macroenabled.12",
"application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.document.12"],docx:["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.wordprocessing-openxml"],dot:["application/msword","application/msword-template"],dotm:["application/vnd.ms-word.template.macroenabled.12"],dotx:["application/vnd.openxmlformats-officedocument.wordprocessingml.template"],pot:["application/mspowerpoint","application/mspowerpoint-template"],potm:["application/vnd.ms-powerpoint.template.macroenabled.12"],
potx:["application/vnd.openxmlformats-officedocument.presentationml.template"],ppt:["application/mspowerpoint","application/vnd.ms-powerpoint","application/vnd.ces-quickpoint"],pptm:["application/vnd.ms-powerpoint.presentation.macroenabled.12","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],pptx:["application/vnd.presentation-openxml","application/vnd.presentation-openxmlm","application/vnd.openxmlformats-officedocument.presentationml.presentation"],xls:["application/msexcel","application/vnd.ms-excel",
"application/vnd.ces-quicksheet"],xlsm:["application/vnd.ms-excel.sheet.macroenabled.12","application/vnd.ms-excel.sheet.macroEnabled.12"],xlsx:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.spreadsheet-openxml"],xlt:["application/msexcel","application/msexcel-template"],xltm:["application/vnd.ms-excel.template.macroenabled.12"],xltx:["application/vnd.openxmlformats-officedocument.spreadsheetml.template"]};a=a.split(".")[1].toLowerCase();if(c[a]&&c[a].length)return c[a][0];
throw Error("ext not supported");}function bd(){return new Promise(function(a,c){var e=!1;if("launchQueue"in window){var f=window.performance.now();launchQueue.setConsumer(function(g){e=!0;var k=window.performance.now()-f;if(g.files.length){var l=g.files[0];return l.getFile().then(function(c){x.sendEvent({category:"setConsumer-callback",action:"setConsumer-success",label:k+"ms",value:k});c=[{entry:{name:c.name,fullPath:null,isDirectory:!1,isFile:!0,filesystem:null},type:c.type?c.type:cd(c.name)}];
return chrome.runtime.sendMessage({type:"fileHandler",fileEntries:JSON.stringify(c)},function(c){N.addFile(c.uuid,l);qa=new B(l,c.uuid);return a()})})}console.error("application","files not available in launchParams");x.sendEvent({category:"setConsumer-callback",action:"setConsumer-reject",label:k+"ms",value:k});return c("File not found")})}else return e=!0,a();setTimeout(function(){e||x.sendEvent({category:"timeout-error",action:"fileNotFoundAfter10Seconds"})},1E4);setTimeout(function(){e||x.sendEvent({category:"timeout-error",
action:"fileNotFoundAfter60Seconds"})},6E4)})}var ha={openFile:function(){if(!r.isReady)throw Error("Error: app not ready to open file yet");u.updateState("Opening");if(q.isCros){var a=window.navigator.onLine,c=a?"online":"offline",e=y.mime2Extension(r.mimeType()),f=Wa(Ga);a&&0<f.length&&kb(Ga);za({category:"file-open",action:c,label:e})}document.title=r.displayName();if(a=y.mime2Icon(r.mimeType()))c=document.createElement("link"),c.type="image/x-icon",c.rel="shortcut icon",c.href=a,document.getElementsByTagName("head")[0].appendChild(c);
aa&&t.pushMessage({id:Xa,overrides:aa});jb()}},P,L,Va,aa,Xa="featureOverrides",W="pending_ga",Ga="pending_app_ga",Ma,Ja,ya=!1,ka=!1,yb=!0,Ua="Invalid";new Worker("../scripts/controllers/fileReaperWorker.js");var qa,ra=null;(function(){chrome.runtime.onMessage.addListener(function(a,c,e){"reaperCheck"===a&&e({uuid:r.getUUID()})})})();(function(){try{aa={};var c=window.sessionStorage.getItem(Xa),e=X.getItem(Xa);e||(e='{"edit":true,"pointEdit":true}');a.extend(aa,JSON.parse(c));a.extend(aa,JSON.parse(e));
0<Object.keys(aa).length&&l.setOverrides(aa)}catch(g){}})();require(["monkeyLoader!monkeyAppClient"],function(){C.publish("qowt:doAction","START_PERFORMANCE_TEST");document.title="";P=document.getElementById("sandbox");window.connectFromAppToQowt=new Date;t.connect(P.contentWindow);window._handleWASMMessage=Cb;var a=S.generateUUID();x.setSessionGroup(a);Ha();u.init();L={locale:chrome.i18n.getMessage("@@ui_locale"),defaultLocale:"en"};window.addEventListener("keydown",m);e.addObserver(w);e.addObserver(M);
e.addObserver(H);e.init();ea.all([la(),wb(),Za(),nc()]).then(sd).then(vd).done()});return ha});require(["third_party/domready/domReady!"],function(){require(["controllers/application"])});define("mainApp",function(){});
